[0m09:27:49.773163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb6e34ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb7e56840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb60dd9a0>]}


============================== 09:27:49.777023 | a38b70ae-4366-4176-8391-3d5d2ef97d6b ==============================
[0m09:27:49.777023 [info ] [MainThread]: Running with dbt=1.11.5
[0m09:27:49.777461 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': '/home/suraj/.dbt', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'version_check': 'True', 'no_print': 'None', 'empty': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/home/suraj/frontier_analytics/logs', 'introspect': 'True', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'quiet': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m09:27:49.795709 [info ] [MainThread]: dbt version: 1.11.5
[0m09:27:49.796078 [info ] [MainThread]: python version: 3.12.3
[0m09:27:49.796451 [info ] [MainThread]: python path: /home/suraj/.dbt-env/bin/python3
[0m09:27:49.797054 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m09:27:49.868042 [info ] [MainThread]: Using profiles dir at /home/suraj/.dbt
[0m09:27:49.868513 [info ] [MainThread]: Using profiles.yml file at /home/suraj/.dbt/profiles.yml
[0m09:27:49.868786 [info ] [MainThread]: Using dbt_project.yml file at /home/suraj/frontier_analytics/dbt_project.yml
[0m09:27:49.869755 [info ] [MainThread]: adapter type: postgres
[0m09:27:49.870070 [info ] [MainThread]: adapter version: 1.10.0
[0m09:27:49.953261 [info ] [MainThread]: Configuration:
[0m09:27:49.953678 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:27:49.953982 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:27:49.954223 [info ] [MainThread]: Required dependencies:
[0m09:27:49.954980 [debug] [MainThread]: Executing "git --help"
[0m09:27:49.968853 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:27:49.969266 [debug] [MainThread]: STDERR: "b''"
[0m09:27:49.969487 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:27:49.969753 [info ] [MainThread]: Connection:
[0m09:27:49.970006 [info ] [MainThread]:   host: 10.0.9.25
[0m09:27:49.970210 [info ] [MainThread]:   port: 5432
[0m09:27:49.970425 [info ] [MainThread]:   user: postgres
[0m09:27:49.970630 [info ] [MainThread]:   database: FBS_DB
[0m09:27:49.970851 [info ] [MainThread]:   schema: dbt_dev
[0m09:27:49.971040 [info ] [MainThread]:   connect_timeout: 10
[0m09:27:49.971242 [info ] [MainThread]:   role: None
[0m09:27:49.971449 [info ] [MainThread]:   search_path: None
[0m09:27:49.971637 [info ] [MainThread]:   keepalives_idle: 0
[0m09:27:49.971826 [info ] [MainThread]:   sslmode: None
[0m09:27:49.972015 [info ] [MainThread]:   sslcert: None
[0m09:27:49.972268 [info ] [MainThread]:   sslkey: None
[0m09:27:49.972479 [info ] [MainThread]:   sslrootcert: None
[0m09:27:49.972676 [info ] [MainThread]:   application_name: dbt
[0m09:27:49.972880 [info ] [MainThread]:   retries: 1
[0m09:27:49.973209 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:27:50.014143 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:27:50.038995 [debug] [MainThread]: Using postgres connection "debug"
[0m09:27:50.039341 [debug] [MainThread]: On debug: select 1 as id
[0m09:27:50.039544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:27:50.113925 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "10.0.9.25", port 5432 failed: FATAL:  no pg_hba.conf entry for host "10.0.8.158", user "postgres", database "FBS_DB", no encryption

[0m09:27:50.182777 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m09:27:50.183357 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m09:27:50.183704 [debug] [MainThread]: On debug: No close available on handle
[0m09:27:50.184146 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m09:27:50.184471 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:27:50.184842 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "10.0.9.25", port 5432 failed: FATAL:  no pg_hba.conf entry for host "10.0.8.158", user "postgres", database "FBS_DB", no encryption
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m09:27:50.190266 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.46790233, "process_in_blocks": "71352", "process_kernel_time": 0.203933, "process_mem_max_rss": "112064", "process_out_blocks": "16", "process_user_time": 1.152667}
[0m09:27:50.190670 [debug] [MainThread]: Command `dbt debug` failed at 09:27:50.190588 after 0.47 seconds
[0m09:27:50.190922 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:27:50.191123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb6e34ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb60dd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb50e1f70>]}
[0m09:27:50.191373 [debug] [MainThread]: Flushing usage events
[0m09:27:51.317214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:33.587643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0ea9a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0e0370b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0dce5460>]}


============================== 09:28:33.590337 | 06644310-b4f9-4650-90cb-e07f61419977 ==============================
[0m09:28:33.590337 [info ] [MainThread]: Running with dbt=1.11.5
[0m09:28:33.590774 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/home/suraj/.dbt', 'static_parser': 'True', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'None', 'log_path': '/home/suraj/frontier_analytics/logs', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False'}
[0m09:28:33.599615 [info ] [MainThread]: dbt version: 1.11.5
[0m09:28:33.599998 [info ] [MainThread]: python version: 3.12.3
[0m09:28:33.600329 [info ] [MainThread]: python path: /home/suraj/.dbt-env/bin/python3
[0m09:28:33.601068 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m09:28:33.637853 [info ] [MainThread]: Using profiles dir at /home/suraj/.dbt
[0m09:28:33.638289 [info ] [MainThread]: Using profiles.yml file at /home/suraj/.dbt/profiles.yml
[0m09:28:33.638691 [info ] [MainThread]: Using dbt_project.yml file at /home/suraj/frontier_analytics/dbt_project.yml
[0m09:28:33.639488 [info ] [MainThread]: adapter type: postgres
[0m09:28:33.639761 [info ] [MainThread]: adapter version: 1.10.0
[0m09:28:33.723135 [info ] [MainThread]: Configuration:
[0m09:28:33.723611 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:28:33.723900 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:28:33.724124 [info ] [MainThread]: Required dependencies:
[0m09:28:33.724377 [debug] [MainThread]: Executing "git --help"
[0m09:28:33.726271 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:28:33.726721 [debug] [MainThread]: STDERR: "b''"
[0m09:28:33.726935 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:28:33.727195 [info ] [MainThread]: Connection:
[0m09:28:33.727587 [info ] [MainThread]:   host: 10.0.9.25
[0m09:28:33.727816 [info ] [MainThread]:   port: 5432
[0m09:28:33.728035 [info ] [MainThread]:   user: postgres
[0m09:28:33.728237 [info ] [MainThread]:   database: FBS_DB
[0m09:28:33.728441 [info ] [MainThread]:   schema: dbt_dev
[0m09:28:33.728649 [info ] [MainThread]:   connect_timeout: 10
[0m09:28:33.728843 [info ] [MainThread]:   role: None
[0m09:28:33.729030 [info ] [MainThread]:   search_path: None
[0m09:28:33.729240 [info ] [MainThread]:   keepalives_idle: 0
[0m09:28:33.729441 [info ] [MainThread]:   sslmode: None
[0m09:28:33.729628 [info ] [MainThread]:   sslcert: None
[0m09:28:33.729817 [info ] [MainThread]:   sslkey: None
[0m09:28:33.730002 [info ] [MainThread]:   sslrootcert: None
[0m09:28:33.730187 [info ] [MainThread]:   application_name: dbt
[0m09:28:33.730369 [info ] [MainThread]:   retries: 1
[0m09:28:33.730687 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:28:33.766128 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:28:33.782837 [debug] [MainThread]: Using postgres connection "debug"
[0m09:28:33.783244 [debug] [MainThread]: On debug: select 1 as id
[0m09:28:33.783442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:33.852060 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "10.0.9.25", port 5432 failed: FATAL:  no pg_hba.conf entry for host "10.0.8.158", user "postgres", database "FBS_DB", no encryption

[0m09:28:33.918050 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m09:28:33.918429 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m09:28:33.918658 [debug] [MainThread]: On debug: No close available on handle
[0m09:28:33.918877 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m09:28:33.919150 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:28:33.919364 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "10.0.9.25", port 5432 failed: FATAL:  no pg_hba.conf entry for host "10.0.8.158", user "postgres", database "FBS_DB", no encryption
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m09:28:33.920144 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.37850812, "process_in_blocks": "0", "process_kernel_time": 0.201109, "process_mem_max_rss": "112340", "process_out_blocks": "16", "process_user_time": 1.005545}
[0m09:28:33.920515 [debug] [MainThread]: Command `dbt debug` failed at 09:28:33.920435 after 0.38 seconds
[0m09:28:33.920747 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:28:33.920937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0ea9a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0dff08c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0dce6db0>]}
[0m09:28:33.921195 [debug] [MainThread]: Flushing usage events
[0m09:28:34.996070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:44.889898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb9180830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb877a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb9182db0>]}


============================== 09:28:44.893239 | 38fb6ba7-5c39-47c9-91a8-7ac11c1299fc ==============================
[0m09:28:44.893239 [info ] [MainThread]: Running with dbt=1.11.5
[0m09:28:44.893687 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'invocation_command': 'dbt debug', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/home/suraj/.dbt', 'use_colors': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'None', 'fail_fast': 'False', 'write_json': 'True', 'log_path': '/home/suraj/frontier_analytics/logs'}
[0m09:28:44.900709 [info ] [MainThread]: dbt version: 1.11.5
[0m09:28:44.901087 [info ] [MainThread]: python version: 3.12.3
[0m09:28:44.901473 [info ] [MainThread]: python path: /home/suraj/.dbt-env/bin/python3
[0m09:28:44.901746 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m09:28:44.937580 [info ] [MainThread]: Using profiles dir at /home/suraj/.dbt
[0m09:28:44.938020 [info ] [MainThread]: Using profiles.yml file at /home/suraj/.dbt/profiles.yml
[0m09:28:44.938258 [info ] [MainThread]: Using dbt_project.yml file at /home/suraj/frontier_analytics/dbt_project.yml
[0m09:28:44.939171 [info ] [MainThread]: adapter type: postgres
[0m09:28:44.939486 [info ] [MainThread]: adapter version: 1.10.0
[0m09:28:45.027673 [info ] [MainThread]: Configuration:
[0m09:28:45.028105 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:28:45.028367 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:28:45.028638 [info ] [MainThread]: Required dependencies:
[0m09:28:45.029067 [debug] [MainThread]: Executing "git --help"
[0m09:28:45.030717 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:28:45.031181 [debug] [MainThread]: STDERR: "b''"
[0m09:28:45.031480 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:28:45.031709 [info ] [MainThread]: Connection:
[0m09:28:45.031946 [info ] [MainThread]:   host: 10.0.9.25
[0m09:28:45.032166 [info ] [MainThread]:   port: 5432
[0m09:28:45.032375 [info ] [MainThread]:   user: postgres
[0m09:28:45.032590 [info ] [MainThread]:   database: FBS_DB
[0m09:28:45.032871 [info ] [MainThread]:   schema: dbt_dev
[0m09:28:45.033100 [info ] [MainThread]:   connect_timeout: 10
[0m09:28:45.033301 [info ] [MainThread]:   role: None
[0m09:28:45.033524 [info ] [MainThread]:   search_path: None
[0m09:28:45.033737 [info ] [MainThread]:   keepalives_idle: 0
[0m09:28:45.033937 [info ] [MainThread]:   sslmode: None
[0m09:28:45.034146 [info ] [MainThread]:   sslcert: None
[0m09:28:45.034431 [info ] [MainThread]:   sslkey: None
[0m09:28:45.034794 [info ] [MainThread]:   sslrootcert: None
[0m09:28:45.035060 [info ] [MainThread]:   application_name: dbt
[0m09:28:45.035387 [info ] [MainThread]:   retries: 1
[0m09:28:45.035889 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:28:45.068836 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:28:45.084919 [debug] [MainThread]: Using postgres connection "debug"
[0m09:28:45.085251 [debug] [MainThread]: On debug: select 1 as id
[0m09:28:45.085437 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:45.278255 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "10.0.9.25", port 5432 failed: FATAL:  password authentication failed for user "postgres"

[0m09:28:45.453681 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m09:28:45.453994 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m09:28:45.454211 [debug] [MainThread]: On debug: No close available on handle
[0m09:28:45.454405 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m09:28:45.454644 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:28:45.454843 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "10.0.9.25", port 5432 failed: FATAL:  password authentication failed for user "postgres"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m09:28:45.455547 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6106263, "process_in_blocks": "4904", "process_kernel_time": 0.100273, "process_mem_max_rss": "114824", "process_out_blocks": "24", "process_user_time": 1.084782}
[0m09:28:45.455902 [debug] [MainThread]: Command `dbt debug` failed at 09:28:45.455827 after 0.61 seconds
[0m09:28:45.456142 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:28:45.456364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb88792b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb89d30e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fb89d14f0>]}
[0m09:28:45.456663 [debug] [MainThread]: Flushing usage events
[0m09:28:46.574213 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:30:32.930259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee2daed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee2c4c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee1e2c740>]}


============================== 09:30:32.932615 | 759438c8-c723-4583-9853-c78a23f56621 ==============================
[0m09:30:32.932615 [info ] [MainThread]: Running with dbt=1.11.5
[0m09:30:32.933118 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'empty': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/home/suraj/frontier_analytics/logs', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/suraj/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:30:32.940446 [info ] [MainThread]: dbt version: 1.11.5
[0m09:30:32.940783 [info ] [MainThread]: python version: 3.12.3
[0m09:30:32.941040 [info ] [MainThread]: python path: /home/suraj/.dbt-env/bin/python3
[0m09:30:32.941251 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m09:30:32.984361 [info ] [MainThread]: Using profiles dir at /home/suraj/.dbt
[0m09:30:32.984814 [info ] [MainThread]: Using profiles.yml file at /home/suraj/.dbt/profiles.yml
[0m09:30:32.985107 [info ] [MainThread]: Using dbt_project.yml file at /home/suraj/frontier_analytics/dbt_project.yml
[0m09:30:32.985538 [info ] [MainThread]: adapter type: postgres
[0m09:30:32.985799 [info ] [MainThread]: adapter version: 1.10.0
[0m09:30:33.076880 [info ] [MainThread]: Configuration:
[0m09:30:33.077735 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:30:33.078244 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:30:33.078542 [info ] [MainThread]: Required dependencies:
[0m09:30:33.078790 [debug] [MainThread]: Executing "git --help"
[0m09:30:33.080811 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:30:33.081200 [debug] [MainThread]: STDERR: "b''"
[0m09:30:33.081398 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:30:33.081637 [info ] [MainThread]: Connection:
[0m09:30:33.082477 [info ] [MainThread]:   host: 10.0.9.25
[0m09:30:33.082873 [info ] [MainThread]:   port: 5432
[0m09:30:33.083346 [info ] [MainThread]:   user: postgres
[0m09:30:33.083784 [info ] [MainThread]:   database: FBS_DB
[0m09:30:33.084022 [info ] [MainThread]:   schema: dbt_dev
[0m09:30:33.084243 [info ] [MainThread]:   connect_timeout: 10
[0m09:30:33.084455 [info ] [MainThread]:   role: None
[0m09:30:33.084645 [info ] [MainThread]:   search_path: None
[0m09:30:33.084843 [info ] [MainThread]:   keepalives_idle: 0
[0m09:30:33.085027 [info ] [MainThread]:   sslmode: None
[0m09:30:33.085208 [info ] [MainThread]:   sslcert: None
[0m09:30:33.085402 [info ] [MainThread]:   sslkey: None
[0m09:30:33.085610 [info ] [MainThread]:   sslrootcert: None
[0m09:30:33.085863 [info ] [MainThread]:   application_name: dbt
[0m09:30:33.086086 [info ] [MainThread]:   retries: 1
[0m09:30:33.086453 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:30:33.121831 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:30:33.138564 [debug] [MainThread]: Using postgres connection "debug"
[0m09:30:33.138903 [debug] [MainThread]: On debug: select 1 as id
[0m09:30:33.139087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:30:33.236772 [debug] [MainThread]: SQL status: SELECT 1 in 0.098 seconds
[0m09:30:33.237886 [debug] [MainThread]: On debug: Close
[0m09:30:33.238212 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:30:33.238528 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:30:33.239325 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.35474148, "process_in_blocks": "0", "process_kernel_time": 0.091591, "process_mem_max_rss": "115116", "process_out_blocks": "16", "process_user_time": 1.117418}
[0m09:30:33.239714 [debug] [MainThread]: Command `dbt debug` succeeded at 09:30:33.239634 after 0.36 seconds
[0m09:30:33.239938 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:30:33.240165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee2320e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee0d56810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee1de4e90>]}
[0m09:30:33.240453 [debug] [MainThread]: Flushing usage events
[0m09:30:34.291018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:47:30.100910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb7c65790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb7c66960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb8bc3020>]}


============================== 09:47:30.162628 | 4f413e98-c677-41e6-b743-b5a45b6cf1cf ==============================
[0m09:47:30.162628 [info ] [MainThread]: Running with dbt=1.11.5
[0m09:47:30.183319 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'fail_fast': 'False', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/suraj/.dbt', 'introspect': 'True', 'invocation_command': 'dbt parse', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'log_path': '/home/suraj/frontier_analytics/logs', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80'}
[0m09:47:34.536944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f413e98-c677-41e6-b743-b5a45b6cf1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb6b3c710>]}
[0m09:47:36.098223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f413e98-c677-41e6-b743-b5a45b6cf1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb79d1370>]}
[0m09:47:36.105666 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:47:37.857421 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m09:47:37.867727 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:47:37.881729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f413e98-c677-41e6-b743-b5a45b6cf1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb7b4b620>]}
[0m09:47:55.843381 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.frontier_analytics.marts
- models.frontier_analytics.intermediate
- models.frontier_analytics.staging
[0m09:47:55.994029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f413e98-c677-41e6-b743-b5a45b6cf1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb5b71100>]}
[0m09:47:56.057445 [info ] [MainThread]: Performance info: /home/suraj/frontier_analytics/target/perf_info.json
[0m09:47:57.510513 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m09:47:57.545175 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m09:47:57.559777 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 31.962755, "process_in_blocks": "3640", "process_kernel_time": 3.845107, "process_mem_max_rss": "113088", "process_out_blocks": "1880", "process_user_time": 46.86352}
[0m09:47:57.566183 [debug] [MainThread]: Command `dbt parse` succeeded at 09:47:57.564709 after 31.98 seconds
[0m09:47:57.571116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb84c7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb8a1e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb8a1ddf0>]}
[0m09:47:57.580573 [debug] [MainThread]: Flushing usage events
[0m09:47:59.389960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:56:11.649792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d201d63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d22252420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d2056fad0>]}


============================== 09:56:11.652452 | fda74490-fccc-4635-aa8f-218ba12e7bcc ==============================
[0m09:56:11.652452 [info ] [MainThread]: Running with dbt=1.11.5
[0m09:56:11.652868 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt parse', 'fail_fast': 'False', 'profiles_dir': '/home/suraj/.dbt', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'log_path': '/home/suraj/frontier_analytics/logs', 'printer_width': '80', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'write_json': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True'}
[0m09:56:11.775617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fda74490-fccc-4635-aa8f-218ba12e7bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d2200f3e0>]}
[0m09:56:11.828509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fda74490-fccc-4635-aa8f-218ba12e7bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d1f57b950>]}
[0m09:56:11.829193 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:56:11.871697 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m09:56:11.923687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:56:11.924124 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/staging/sap/stg_sap__orders.sql
[0m09:56:12.150910 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.frontier_analytics.marts
- models.frontier_analytics.intermediate
[0m09:56:12.163137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fda74490-fccc-4635-aa8f-218ba12e7bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d1d5f93a0>]}
[0m09:56:12.166005 [info ] [MainThread]: Performance info: /home/suraj/frontier_analytics/target/perf_info.json
[0m09:56:12.219344 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m09:56:12.220761 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m09:56:12.221465 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.6158013, "process_in_blocks": "384", "process_kernel_time": 0.127598, "process_mem_max_rss": "120556", "process_out_blocks": "1872", "process_user_time": 1.449153}
[0m09:56:12.221831 [debug] [MainThread]: Command `dbt parse` succeeded at 09:56:12.221751 after 0.62 seconds
[0m09:56:12.222103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d1f752360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d1f9c2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d1d117c20>]}
[0m09:56:12.222355 [debug] [MainThread]: Flushing usage events
[0m09:56:13.393537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:05.192354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1daaa120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1bd6be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1bd6be00>]}


============================== 09:57:05.195278 | 4f523835-e190-49ac-a8b8-de89cbbd5a01 ==============================
[0m09:57:05.195278 [info ] [MainThread]: Running with dbt=1.11.5
[0m09:57:05.195714 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'empty': 'False', 'printer_width': '80', 'debug': 'False', 'log_path': '/home/suraj/frontier_analytics/logs', 'profiles_dir': '/home/suraj/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select stg_sap__orders', 'introspect': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False'}
[0m09:57:05.312632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f523835-e190-49ac-a8b8-de89cbbd5a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1a3d4b90>]}
[0m09:57:05.365576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f523835-e190-49ac-a8b8-de89cbbd5a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1b017d40>]}
[0m09:57:05.366234 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:57:05.406996 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m09:57:05.472502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:05.472818 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:57:05.473023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:05.476664 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.frontier_analytics.marts
- models.frontier_analytics.intermediate
[0m09:57:05.500961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f523835-e190-49ac-a8b8-de89cbbd5a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1b024c50>]}
[0m09:57:05.552444 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m09:57:05.553849 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m09:57:05.568044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f523835-e190-49ac-a8b8-de89cbbd5a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a193b2150>]}
[0m09:57:05.568481 [info ] [MainThread]: Found 1 model, 16 sources, 464 macros
[0m09:57:05.568801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f523835-e190-49ac-a8b8-de89cbbd5a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1a3fb2c0>]}
[0m09:57:05.570064 [info ] [MainThread]: 
[0m09:57:05.570432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:57:05.570703 [info ] [MainThread]: 
[0m09:57:05.571527 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:05.573661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m09:57:05.598682 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m09:57:05.599035 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m09:57:05.599255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:05.700615 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.101 seconds
[0m09:57:05.702206 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m09:57:05.703268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now create_FBS_DB_dbt_dev_staging)
[0m09:57:05.703999 [debug] [ThreadPool]: Creating schema "database: "FBS_DB"
schema: "dbt_dev_staging"
"
[0m09:57:05.711525 [debug] [ThreadPool]: Using postgres connection "create_FBS_DB_dbt_dev_staging"
[0m09:57:05.711932 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "create_FBS_DB_dbt_dev_staging"} */
create schema if not exists "dbt_dev_staging"
[0m09:57:05.712142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:05.813564 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.101 seconds
[0m09:57:05.815684 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_staging: COMMIT
[0m09:57:05.817056 [debug] [ThreadPool]: Using postgres connection "create_FBS_DB_dbt_dev_staging"
[0m09:57:05.817691 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_staging: COMMIT
[0m09:57:05.823729 [debug] [ThreadPool]: SQL status: COMMIT in 0.006 seconds
[0m09:57:05.824032 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_staging: Close
[0m09:57:05.825219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_FBS_DB_dbt_dev_staging, now list_FBS_DB_dbt_dev_staging)
[0m09:57:05.829197 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m09:57:05.829500 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m09:57:05.829745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:05.911066 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.081 seconds
[0m09:57:05.912018 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m09:57:05.915656 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m09:57:05.920124 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:05.920421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:57:05.920676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:06.116864 [debug] [MainThread]: SQL status: SELECT 69 in 0.196 seconds
[0m09:57:06.118860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f523835-e190-49ac-a8b8-de89cbbd5a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a17e1f440>]}
[0m09:57:06.119219 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:06.121620 [debug] [MainThread]: On master: COMMIT
[0m09:57:06.121863 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:06.122026 [debug] [MainThread]: On master: COMMIT
[0m09:57:06.126534 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:57:06.126887 [debug] [MainThread]: On master: Close
[0m09:57:06.135890 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_sap__orders
[0m09:57:06.136457 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_staging.stg_sap__orders .................... [RUN]
[0m09:57:06.136878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.stg_sap__orders)
[0m09:57:06.137158 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_sap__orders
[0m09:57:06.142810 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__orders"
[0m09:57:06.144537 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_sap__orders
[0m09:57:06.173118 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__orders"
[0m09:57:06.174181 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m09:57:06.174479 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP".""ORDR""

),

renamed as (

    select
        "DocEntry"          as order_id,
        "DocNum"            as order_number,
        "DocDate"           as order_date,
        "CardName"          as customer_name,
        "CANCELED"          as is_cancelled,
        "U_Marginpl"::numeric as margin,
        "U_SBU"             as sbu_code,
        "U_Ordertype"       as order_type,
        "U_AVA_MARGINTYPE"  as margin_type,
        "U_SalesExecutive"  as sales_executive_code,
        "U_AVA_Block"       as block_code,
        "U_Cgroup"          as customer_group_code,
        "U_Ldcst"           as ld_cost,
        "Comments"          as comments,
        "U_AVA_MARGINTYPE"  as margin_sharing_type

    from source

)

select * from renamed
  );
[0m09:57:06.174698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:06.359240 [debug] [Thread-1 (]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 9:     select * from "FBS_DB"."SAP".""ORDR""
                                         ^

[0m09:57:06.359956 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: ROLLBACK
[0m09:57:06.362496 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: Close
[0m09:57:06.371828 [debug] [Thread-1 (]: Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  zero-length delimited identifier at or near """"
  LINE 9:     select * from "FBS_DB"."SAP".""ORDR""
                                           ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m09:57:06.373671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f523835-e190-49ac-a8b8-de89cbbd5a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a17e33590>]}
[0m09:57:06.374368 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dev_staging.stg_sap__orders ........... [[31mERROR[0m in 0.24s]
[0m09:57:06.374886 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_sap__orders
[0m09:57:06.376002 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.stg_sap__orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  zero-length delimited identifier at or near """"
  LINE 9:     select * from "FBS_DB"."SAP".""ORDR""
                                           ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql.
[0m09:57:06.379078 [debug] [MainThread]: On master: COMMIT
[0m09:57:06.379446 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:06.379659 [debug] [MainThread]: On master: COMMIT
[0m09:57:06.379835 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:06.559065 [debug] [MainThread]: SQL status: COMMIT in 0.179 seconds
[0m09:57:06.559540 [debug] [MainThread]: On master: Close
[0m09:57:06.559969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:06.560160 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__orders' was properly closed.
[0m09:57:06.560379 [info ] [MainThread]: 
[0m09:57:06.560656 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m09:57:06.561894 [debug] [MainThread]: Command end result
[0m09:57:06.575973 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m09:57:06.577738 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m09:57:06.582136 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m09:57:06.582373 [info ] [MainThread]: 
[0m09:57:06.582765 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:57:06.583031 [info ] [MainThread]: 
[0m09:57:06.583584 [error] [MainThread]: [31mFailure in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)[0m
[0m09:57:06.584181 [error] [MainThread]:   Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  zero-length delimited identifier at or near """"
  LINE 9:     select * from "FBS_DB"."SAP".""ORDR""
                                           ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m09:57:06.584579 [info ] [MainThread]: 
[0m09:57:06.584930 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m09:57:06.585186 [info ] [MainThread]: 
[0m09:57:06.585484 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:57:06.587111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4429076, "process_in_blocks": "832", "process_kernel_time": 0.162163, "process_mem_max_rss": "123848", "process_out_blocks": "1960", "process_user_time": 1.387397}
[0m09:57:06.587651 [debug] [MainThread]: Command `dbt run` failed at 09:57:06.587515 after 1.44 seconds
[0m09:57:06.588139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1b0247d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1da6e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a1b651580>]}
[0m09:57:06.588666 [debug] [MainThread]: Flushing usage events
[0m09:57:07.619944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:09:12.415598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52552c39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5256fa6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5254c99af0>]}


============================== 10:09:12.421122 | 60ec291a-fe8c-45d0-a46c-1c8c21eff5b2 ==============================
[0m10:09:12.421122 [info ] [MainThread]: Running with dbt=1.11.5
[0m10:09:12.421804 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_sap__orders', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/suraj/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/home/suraj/frontier_analytics/logs', 'warn_error': 'None', 'empty': 'False', 'target_path': 'None', 'introspect': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager'}
[0m10:09:12.597838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60ec291a-fe8c-45d0-a46c-1c8c21eff5b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5253763650>]}
[0m10:09:12.660774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60ec291a-fe8c-45d0-a46c-1c8c21eff5b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525426bef0>]}
[0m10:09:12.661881 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:09:12.710740 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m10:09:12.815341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:09:12.815996 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/sap/schema.yml
[0m10:09:12.816344 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/excel_data/schema.yml
[0m10:09:12.816669 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/crm/schema.yml
[0m10:09:12.816896 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/sap/stg_sap__orders.sql
[0m10:09:13.095834 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.frontier_analytics.stg_sap__orders' (models/staging/sap/stg_sap__orders.sql) depends on a source named 'sap.ORDR' which was not found
[0m10:09:13.098596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7349922, "process_in_blocks": "68472", "process_kernel_time": 0.269588, "process_mem_max_rss": "120244", "process_out_blocks": "16", "process_user_time": 1.518682}
[0m10:09:13.099282 [debug] [MainThread]: Command `dbt run` failed at 10:09:13.099171 after 0.74 seconds
[0m10:09:13.099632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5254c99f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52553a8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5251fced50>]}
[0m10:09:13.099945 [debug] [MainThread]: Flushing usage events
[0m10:09:14.619508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:15.673791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f770691b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77060cd430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f770691ae10>]}


============================== 10:12:15.679406 | f302ce2c-a9f9-4b6b-b499-79bdb863216a ==============================
[0m10:12:15.679406 [info ] [MainThread]: Running with dbt=1.11.5
[0m10:12:15.679988 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_path': '/home/suraj/frontier_analytics/logs', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select stg_sap__orders', 'quiet': 'False', 'introspect': 'True', 'printer_width': '80', 'debug': 'False', 'version_check': 'True', 'profiles_dir': '/home/suraj/.dbt', 'indirect_selection': 'eager', 'empty': 'False'}
[0m10:12:15.850033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f302ce2c-a9f9-4b6b-b499-79bdb863216a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77067ac920>]}
[0m10:12:15.905401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f302ce2c-a9f9-4b6b-b499-79bdb863216a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77062e5e80>]}
[0m10:12:15.906631 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:12:15.956577 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m10:12:16.067551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:12:16.068196 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/sap/schema.yml
[0m10:12:16.068546 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/excel_data/schema.yml
[0m10:12:16.068878 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/crm/schema.yml
[0m10:12:16.069107 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/sap/stg_sap__orders.sql
[0m10:12:16.328704 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "sap_ORDR".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("sap", "ORDR").
  
  To fix this, change the name of one of these resources:
  - source.frontier_analytics.sap.ORDR (models/staging/excel_data/schema.yml)
  - source.frontier_analytics.sap.ORDR (models/staging/sap/schema.yml)
[0m10:12:16.331954 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.71074736, "process_in_blocks": "82752", "process_kernel_time": 0.202853, "process_mem_max_rss": "118100", "process_out_blocks": "16", "process_user_time": 1.580565}
[0m10:12:16.332449 [debug] [MainThread]: Command `dbt run` failed at 10:12:16.332362 after 0.71 seconds
[0m10:12:16.332773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77061549b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f770333ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f770338b500>]}
[0m10:12:16.333093 [debug] [MainThread]: Flushing usage events
[0m10:12:17.407353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:00.318943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dd13b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dce15490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dcef7890>]}


============================== 10:44:00.323589 | 56922cf1-2aeb-49c5-89ab-048deb9fdb08 ==============================
[0m10:44:00.323589 [info ] [MainThread]: Running with dbt=1.11.5
[0m10:44:00.324358 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'profiles_dir': '/home/suraj/.dbt', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'empty': 'False', 'use_colors': 'True', 'log_path': '/home/suraj/frontier_analytics/logs', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_sap__orders', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m10:44:00.499379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56922cf1-2aeb-49c5-89ab-048deb9fdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dbf9bfb0>]}
[0m10:44:00.558097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56922cf1-2aeb-49c5-89ab-048deb9fdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4de05a210>]}
[0m10:44:00.559476 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:44:00.611789 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m10:44:00.729883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:44:00.730770 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/sap/schema.yml
[0m10:44:00.731309 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/excel_data/schema.yml
[0m10:44:00.731741 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/crm/schema.yml
[0m10:44:00.732078 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/sap/stg_sap__orders.sql
[0m10:44:01.052123 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.frontier_analytics.marts
- models.frontier_analytics.intermediate
[0m10:44:01.059626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56922cf1-2aeb-49c5-89ab-048deb9fdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4d9f75b80>]}
[0m10:44:01.108623 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m10:44:01.110404 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m10:44:01.131049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56922cf1-2aeb-49c5-89ab-048deb9fdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4d9b12450>]}
[0m10:44:01.131607 [info ] [MainThread]: Found 1 model, 16 sources, 464 macros
[0m10:44:01.131971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56922cf1-2aeb-49c5-89ab-048deb9fdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4db367c80>]}
[0m10:44:01.133486 [info ] [MainThread]: 
[0m10:44:01.134097 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:01.134404 [info ] [MainThread]: 
[0m10:44:01.134905 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:44:01.135965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m10:44:01.170200 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m10:44:01.170676 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m10:44:01.170936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:01.267281 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.096 seconds
[0m10:44:01.268569 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m10:44:01.269908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m10:44:01.274543 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m10:44:01.274891 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m10:44:01.275134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:01.356115 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.081 seconds
[0m10:44:01.357497 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m10:44:01.359956 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m10:44:01.364520 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:01.364875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:44:01.365249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:01.573447 [debug] [MainThread]: SQL status: SELECT 69 in 0.208 seconds
[0m10:44:01.575338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56922cf1-2aeb-49c5-89ab-048deb9fdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4da3712e0>]}
[0m10:44:01.575767 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:01.578162 [debug] [MainThread]: On master: COMMIT
[0m10:44:01.578515 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:01.578765 [debug] [MainThread]: On master: COMMIT
[0m10:44:01.583018 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:44:01.583369 [debug] [MainThread]: On master: Close
[0m10:44:01.588025 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_sap__orders
[0m10:44:01.644948 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_staging.stg_sap__orders .................... [RUN]
[0m10:44:01.645743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.stg_sap__orders)
[0m10:44:01.646668 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_sap__orders
[0m10:44:01.653342 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__orders"
[0m10:44:01.654174 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_sap__orders
[0m10:44:01.681021 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__orders"
[0m10:44:01.682820 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m10:44:01.683318 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_tmp"
    
    
  as (
    with source as (

    select * from FBS_DB."SAP"."ORDR"

),

renamed as (

    select
        "DocEntry"          as order_id,
        "DocNum"            as order_number,
        "DocDate"           as order_date,
        "CardName"          as customer_name,
        "CANCELED"          as is_cancelled,
        "U_Marginpl"::numeric as margin,
        "U_SBU"             as sbu_code,
        "U_Ordertype"       as order_type,
        "U_AVA_MARGINTYPE"  as margin_type,
        "U_SalesExecutive"  as sales_executive_code,
        "U_AVA_Block"       as block_code,
        "U_Cgroup"          as customer_group_code,
        "U_Ldcst"           as ld_cost,
        "Comments"          as comments,
        "U_AVA_MARGINTYPE"  as margin_sharing_type

    from source

)

select * from renamed
  );
[0m10:44:01.683793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:01.760860 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "fbs_db.SAP.ORDR"
LINE 9:     select * from FBS_DB."SAP"."ORDR"
                          ^

[0m10:44:01.761579 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: ROLLBACK
[0m10:44:01.765504 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: Close
[0m10:44:01.774095 [debug] [Thread-1 (]: Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.SAP.ORDR"
  LINE 9:     select * from FBS_DB."SAP"."ORDR"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:44:01.776407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56922cf1-2aeb-49c5-89ab-048deb9fdb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dcf68fb0>]}
[0m10:44:01.777215 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dev_staging.stg_sap__orders ........... [[31mERROR[0m in 0.13s]
[0m10:44:01.777796 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_sap__orders
[0m10:44:01.778558 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.stg_sap__orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.SAP.ORDR"
  LINE 9:     select * from FBS_DB."SAP"."ORDR"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql.
[0m10:44:01.781225 [debug] [MainThread]: On master: COMMIT
[0m10:44:01.781568 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:01.781827 [debug] [MainThread]: On master: COMMIT
[0m10:44:01.782041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:01.851543 [debug] [MainThread]: SQL status: COMMIT in 0.069 seconds
[0m10:44:01.852006 [debug] [MainThread]: On master: Close
[0m10:44:01.852415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:01.852648 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__orders' was properly closed.
[0m10:44:01.852932 [info ] [MainThread]: 
[0m10:44:01.853234 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m10:44:01.853777 [debug] [MainThread]: Command end result
[0m10:44:01.870991 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m10:44:01.872524 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m10:44:01.876709 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m10:44:01.876969 [info ] [MainThread]: 
[0m10:44:01.877299 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:44:01.877579 [info ] [MainThread]: 
[0m10:44:01.877887 [error] [MainThread]: [31mFailure in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)[0m
[0m10:44:01.878174 [error] [MainThread]:   Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.SAP.ORDR"
  LINE 9:     select * from FBS_DB."SAP"."ORDR"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:44:01.878422 [info ] [MainThread]: 
[0m10:44:01.878696 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:44:01.878918 [info ] [MainThread]: 
[0m10:44:01.879164 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:44:01.880699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6114513, "process_in_blocks": "85712", "process_kernel_time": 0.188843, "process_mem_max_rss": "131404", "process_out_blocks": "2872", "process_user_time": 1.924407}
[0m10:44:01.881075 [debug] [MainThread]: Command `dbt run` failed at 10:44:01.880993 after 1.61 seconds
[0m10:44:01.881360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4dab27800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4de81abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4da7a0cb0>]}
[0m10:44:01.881700 [debug] [MainThread]: Flushing usage events
[0m10:44:02.955237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:53.656874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74243f6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74245e67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7424ab23c0>]}


============================== 10:44:53.660346 | da8a8da0-9bbd-4650-b62b-092cb3bbdd2e ==============================
[0m10:44:53.660346 [info ] [MainThread]: Running with dbt=1.11.5
[0m10:44:53.660911 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/home/suraj/.dbt', 'printer_width': '80', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': '/home/suraj/frontier_analytics/logs', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sap__orders', 'write_json': 'True', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m10:44:53.787182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da8a8da0-9bbd-4650-b62b-092cb3bbdd2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7426597b30>]}
[0m10:44:53.854171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da8a8da0-9bbd-4650-b62b-092cb3bbdd2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74244beb10>]}
[0m10:44:53.854895 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:44:53.900208 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m10:44:53.972626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m10:44:53.973487 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/sap/schema.yml
[0m10:44:53.974339 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/excel_data/schema.yml
[0m10:44:53.975829 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/crm/schema.yml
[0m10:44:54.290672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.frontier_analytics.intermediate
- models.frontier_analytics.marts
[0m10:44:54.298092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da8a8da0-9bbd-4650-b62b-092cb3bbdd2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7420140fe0>]}
[0m10:44:54.350271 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m10:44:54.351703 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m10:44:54.362270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da8a8da0-9bbd-4650-b62b-092cb3bbdd2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74217852e0>]}
[0m10:44:54.362783 [info ] [MainThread]: Found 1 model, 16 sources, 464 macros
[0m10:44:54.363109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da8a8da0-9bbd-4650-b62b-092cb3bbdd2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74201108f0>]}
[0m10:44:54.364537 [info ] [MainThread]: 
[0m10:44:54.364901 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:54.365157 [info ] [MainThread]: 
[0m10:44:54.365674 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:44:54.366702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m10:44:54.390504 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m10:44:54.391113 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m10:44:54.391396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:54.475016 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.084 seconds
[0m10:44:54.476269 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m10:44:54.477607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m10:44:54.481601 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m10:44:54.481905 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m10:44:54.482212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:54.695854 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.214 seconds
[0m10:44:54.696995 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m10:44:54.699858 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m10:44:54.704564 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:54.705010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:44:54.705323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:54.787340 [debug] [MainThread]: SQL status: SELECT 69 in 0.082 seconds
[0m10:44:54.789207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da8a8da0-9bbd-4650-b62b-092cb3bbdd2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7407131670>]}
[0m10:44:54.789604 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:54.792102 [debug] [MainThread]: On master: COMMIT
[0m10:44:54.792390 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:54.792630 [debug] [MainThread]: On master: COMMIT
[0m10:44:54.796691 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:44:54.797127 [debug] [MainThread]: On master: Close
[0m10:44:54.801145 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_sap__orders
[0m10:44:54.862278 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_staging.stg_sap__orders .................... [RUN]
[0m10:44:54.862975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.stg_sap__orders)
[0m10:44:54.863409 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_sap__orders
[0m10:44:54.869162 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__orders"
[0m10:44:54.870166 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_sap__orders
[0m10:44:54.897177 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__orders"
[0m10:44:54.898338 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m10:44:54.898733 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_tmp"
    
    
  as (
    with source as (

    select * from FBS_DB."SAP"."ORDR"

),

renamed as (

    select
        "DocEntry"          as order_id,
        "DocNum"            as order_number,
        "DocDate"           as order_date,
        "CardName"          as customer_name,
        "CANCELED"          as is_cancelled,
        "U_Marginpl"::numeric as margin,
        "U_SBU"             as sbu_code,
        "U_Ordertype"       as order_type,
        "U_AVA_MARGINTYPE"  as margin_type,
        "U_SalesExecutive"  as sales_executive_code,
        "U_AVA_Block"       as block_code,
        "U_Cgroup"          as customer_group_code,
        "U_Ldcst"           as ld_cost,
        "Comments"          as comments,
        "U_AVA_MARGINTYPE"  as margin_sharing_type

    from source

)

select * from renamed
  );
[0m10:44:54.899038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:54.971910 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "fbs_db.SAP.ORDR"
LINE 9:     select * from FBS_DB."SAP"."ORDR"
                          ^

[0m10:44:54.972353 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: ROLLBACK
[0m10:44:54.974945 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: Close
[0m10:44:54.977303 [debug] [Thread-1 (]: Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.SAP.ORDR"
  LINE 9:     select * from FBS_DB."SAP"."ORDR"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:44:54.978685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da8a8da0-9bbd-4650-b62b-092cb3bbdd2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74217473e0>]}
[0m10:44:54.979336 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dev_staging.stg_sap__orders ........... [[31mERROR[0m in 0.12s]
[0m10:44:54.979840 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_sap__orders
[0m10:44:54.980508 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.stg_sap__orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.SAP.ORDR"
  LINE 9:     select * from FBS_DB."SAP"."ORDR"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql.
[0m10:44:54.983223 [debug] [MainThread]: On master: COMMIT
[0m10:44:54.983587 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:54.983836 [debug] [MainThread]: On master: COMMIT
[0m10:44:54.984045 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:55.056388 [debug] [MainThread]: SQL status: COMMIT in 0.072 seconds
[0m10:44:55.056850 [debug] [MainThread]: On master: Close
[0m10:44:55.057270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:55.057485 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__orders' was properly closed.
[0m10:44:55.057721 [info ] [MainThread]: 
[0m10:44:55.057990 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m10:44:55.058516 [debug] [MainThread]: Command end result
[0m10:44:55.076332 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m10:44:55.077910 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m10:44:55.082076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m10:44:55.082341 [info ] [MainThread]: 
[0m10:44:55.082651 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:44:55.082904 [info ] [MainThread]: 
[0m10:44:55.083194 [error] [MainThread]: [31mFailure in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)[0m
[0m10:44:55.083478 [error] [MainThread]:   Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.SAP.ORDR"
  LINE 9:     select * from FBS_DB."SAP"."ORDR"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:44:55.083706 [info ] [MainThread]: 
[0m10:44:55.083963 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:44:55.084168 [info ] [MainThread]: 
[0m10:44:55.084400 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:44:55.085107 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4728996, "process_in_blocks": "0", "process_kernel_time": 0.100219, "process_mem_max_rss": "135440", "process_out_blocks": "2872", "process_user_time": 1.785733}
[0m10:44:55.085497 [debug] [MainThread]: Command `dbt run` failed at 10:44:55.085418 after 1.47 seconds
[0m10:44:55.085800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74242388c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7424238860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7421fc87d0>]}
[0m10:44:55.086081 [debug] [MainThread]: Flushing usage events
[0m10:44:56.124290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:45:58.224748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11403b6ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1140a41730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11405d3860>]}


============================== 10:45:58.229783 | be9a4b1e-07eb-4ca1-bc7e-50d75d208a6e ==============================
[0m10:45:58.229783 [info ] [MainThread]: Running with dbt=1.11.5
[0m10:45:58.230472 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select stg_sap__orders', 'log_path': '/home/suraj/frontier_analytics/logs', 'empty': 'False', 'profiles_dir': '/home/suraj/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'debug': 'False'}
[0m10:45:58.399627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be9a4b1e-07eb-4ca1-bc7e-50d75d208a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113f1db560>]}
[0m10:45:58.451885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be9a4b1e-07eb-4ca1-bc7e-50d75d208a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113fe834d0>]}
[0m10:45:58.453166 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:45:58.503154 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m10:45:58.565609 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:45:58.566083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be9a4b1e-07eb-4ca1-bc7e-50d75d208a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113e5dc050>]}
[0m10:45:59.479562 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.frontier_analytics.intermediate
- models.frontier_analytics.marts
[0m10:45:59.487215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be9a4b1e-07eb-4ca1-bc7e-50d75d208a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113e1b3560>]}
[0m10:45:59.538888 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m10:45:59.541795 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m10:45:59.583459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be9a4b1e-07eb-4ca1-bc7e-50d75d208a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113c0fd220>]}
[0m10:45:59.584855 [info ] [MainThread]: Found 1 model, 16 sources, 464 macros
[0m10:45:59.585971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be9a4b1e-07eb-4ca1-bc7e-50d75d208a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113f1f8860>]}
[0m10:45:59.590493 [info ] [MainThread]: 
[0m10:45:59.592026 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:45:59.592662 [info ] [MainThread]: 
[0m10:45:59.593968 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:45:59.596126 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m10:45:59.647581 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m10:45:59.648142 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m10:45:59.648486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:59.761937 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.113 seconds
[0m10:45:59.763199 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m10:45:59.764980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m10:45:59.769532 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m10:45:59.770005 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m10:45:59.770307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:45:59.866362 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.096 seconds
[0m10:45:59.867388 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m10:45:59.870666 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m10:45:59.874047 [debug] [MainThread]: Using postgres connection "master"
[0m10:45:59.874390 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:45:59.874666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:45:59.971964 [debug] [MainThread]: SQL status: SELECT 69 in 0.097 seconds
[0m10:45:59.973952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be9a4b1e-07eb-4ca1-bc7e-50d75d208a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113fe94680>]}
[0m10:45:59.974551 [debug] [MainThread]: On master: ROLLBACK
[0m10:45:59.977405 [debug] [MainThread]: On master: COMMIT
[0m10:45:59.977758 [debug] [MainThread]: Using postgres connection "master"
[0m10:45:59.978005 [debug] [MainThread]: On master: COMMIT
[0m10:45:59.982520 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:45:59.982824 [debug] [MainThread]: On master: Close
[0m10:45:59.989229 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_sap__orders
[0m10:45:59.989846 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_staging.stg_sap__orders .................... [RUN]
[0m10:45:59.990343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.stg_sap__orders)
[0m10:45:59.990667 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_sap__orders
[0m10:45:59.996562 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__orders"
[0m10:45:59.997276 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_sap__orders
[0m10:46:00.025897 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__orders"
[0m10:46:00.026678 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m10:46:00.027113 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */

  create view FBS_DB."dbt_dev_staging"."stg_sap__orders__dbt_tmp"
    
    
  as (
    with source as (

    select * from FBS_DB."SAP"."ORDR"

),

renamed as (

    select
        "DocEntry"          as order_id,
        "DocNum"            as order_number,
        "DocDate"           as order_date,
        "CardName"          as customer_name,
        "CANCELED"          as is_cancelled,
        "U_Marginpl"::numeric as margin,
        "U_SBU"             as sbu_code,
        "U_Ordertype"       as order_type,
        "U_AVA_MARGINTYPE"  as margin_type,
        "U_SalesExecutive"  as sales_executive_code,
        "U_AVA_Block"       as block_code,
        "U_Cgroup"          as customer_group_code,
        "U_Ldcst"           as ld_cost,
        "Comments"          as comments,
        "U_AVA_MARGINTYPE"  as margin_sharing_type

    from source

)

select * from renamed
  );
[0m10:46:00.027949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:46:00.199052 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "fbs_db.SAP.ORDR"
LINE 9:     select * from FBS_DB."SAP"."ORDR"
                          ^

[0m10:46:00.199531 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: ROLLBACK
[0m10:46:00.202249 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: Close
[0m10:46:00.213236 [debug] [Thread-1 (]: Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.SAP.ORDR"
  LINE 9:     select * from FBS_DB."SAP"."ORDR"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:46:00.218717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be9a4b1e-07eb-4ca1-bc7e-50d75d208a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ebf02150>]}
[0m10:46:00.220534 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dev_staging.stg_sap__orders ........... [[31mERROR[0m in 0.22s]
[0m10:46:00.221101 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_sap__orders
[0m10:46:00.221655 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.stg_sap__orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.SAP.ORDR"
  LINE 9:     select * from FBS_DB."SAP"."ORDR"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql.
[0m10:46:00.224129 [debug] [MainThread]: On master: COMMIT
[0m10:46:00.224648 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:00.224960 [debug] [MainThread]: On master: COMMIT
[0m10:46:00.225180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:46:00.424703 [debug] [MainThread]: SQL status: COMMIT in 0.199 seconds
[0m10:46:00.425401 [debug] [MainThread]: On master: Close
[0m10:46:00.425880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:00.426120 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__orders' was properly closed.
[0m10:46:00.426403 [info ] [MainThread]: 
[0m10:46:00.426885 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m10:46:00.427812 [debug] [MainThread]: Command end result
[0m10:46:00.444943 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m10:46:00.446770 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m10:46:00.453925 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m10:46:00.454333 [info ] [MainThread]: 
[0m10:46:00.454711 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:46:00.455047 [info ] [MainThread]: 
[0m10:46:00.455398 [error] [MainThread]: [31mFailure in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)[0m
[0m10:46:00.455770 [error] [MainThread]:   Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.SAP.ORDR"
  LINE 9:     select * from FBS_DB."SAP"."ORDR"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:46:00.456037 [info ] [MainThread]: 
[0m10:46:00.456312 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:46:00.456553 [info ] [MainThread]: 
[0m10:46:00.456867 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:46:00.458517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2860584, "process_in_blocks": "92328", "process_kernel_time": 0.258298, "process_mem_max_rss": "131100", "process_out_blocks": "2872", "process_user_time": 2.343134}
[0m10:46:00.458946 [debug] [MainThread]: Command `dbt run` failed at 10:46:00.458856 after 2.29 seconds
[0m10:46:00.459284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11403b6ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11428daf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113e1a65d0>]}
[0m10:46:00.459620 [debug] [MainThread]: Flushing usage events
[0m10:46:01.548320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:48:20.646879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57b489cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57d796990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57b24c2c0>]}


============================== 10:48:20.652374 | 70cf761a-74ab-482a-a71e-c80ab91b44f3 ==============================
[0m10:48:20.652374 [info ] [MainThread]: Running with dbt=1.11.5
[0m10:48:20.653862 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'write_json': 'True', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'log_path': '/home/suraj/frontier_analytics/logs', 'invocation_command': 'dbt run --select stg_sap__orders', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'empty': 'False', 'profiles_dir': '/home/suraj/.dbt', 'introspect': 'True', 'partial_parse': 'True'}
[0m10:48:20.828959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70cf761a-74ab-482a-a71e-c80ab91b44f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57aadcda0>]}
[0m10:48:20.884626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70cf761a-74ab-482a-a71e-c80ab91b44f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57b24d430>]}
[0m10:48:20.885835 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:48:20.939064 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m10:48:21.001368 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:48:21.001839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70cf761a-74ab-482a-a71e-c80ab91b44f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57b384530>]}
[0m10:48:21.887806 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.frontier_analytics.marts
- models.frontier_analytics.intermediate
[0m10:48:21.895747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70cf761a-74ab-482a-a71e-c80ab91b44f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe579797440>]}
[0m10:48:21.943372 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m10:48:21.945311 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m10:48:21.966477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70cf761a-74ab-482a-a71e-c80ab91b44f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe576afbc20>]}
[0m10:48:21.966960 [info ] [MainThread]: Found 1 model, 16 sources, 464 macros
[0m10:48:21.967326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70cf761a-74ab-482a-a71e-c80ab91b44f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57ab14560>]}
[0m10:48:21.968721 [info ] [MainThread]: 
[0m10:48:21.969143 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:48:21.969475 [info ] [MainThread]: 
[0m10:48:21.970032 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:48:21.971105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m10:48:22.005144 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m10:48:22.005565 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m10:48:22.005830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:22.232979 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.227 seconds
[0m10:48:22.234778 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m10:48:22.236405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m10:48:22.241394 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m10:48:22.241915 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m10:48:22.242198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:22.322799 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.080 seconds
[0m10:48:22.324340 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m10:48:22.327377 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m10:48:22.331103 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:22.331501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:48:22.331809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:48:22.544979 [debug] [MainThread]: SQL status: SELECT 69 in 0.213 seconds
[0m10:48:22.547531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70cf761a-74ab-482a-a71e-c80ab91b44f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57ab16cc0>]}
[0m10:48:22.548119 [debug] [MainThread]: On master: ROLLBACK
[0m10:48:22.551850 [debug] [MainThread]: On master: COMMIT
[0m10:48:22.552170 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:22.552432 [debug] [MainThread]: On master: COMMIT
[0m10:48:22.557902 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m10:48:22.558279 [debug] [MainThread]: On master: Close
[0m10:48:22.566946 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_sap__orders
[0m10:48:22.567513 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_staging.stg_sap__orders .................... [RUN]
[0m10:48:22.568076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.stg_sap__orders)
[0m10:48:22.568411 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_sap__orders
[0m10:48:22.574427 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__orders"
[0m10:48:22.575129 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_sap__orders
[0m10:48:22.605269 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__orders"
[0m10:48:22.606016 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m10:48:22.606425 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */

  create view FBS_DB."dbt_dev_staging"."stg_sap__orders__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."ORDR"

),

renamed as (

    select
        "DocEntry"          as order_id,
        "DocNum"            as order_number,
        "DocDate"           as order_date,
        "CardName"          as customer_name,
        "CANCELED"          as is_cancelled,
        "U_Marginpl"::numeric as margin,
        "U_SBU"             as sbu_code,
        "U_Ordertype"       as order_type,
        "U_AVA_MARGINTYPE"  as margin_type,
        "U_SalesExecutive"  as sales_executive_code,
        "U_AVA_Block"       as block_code,
        "U_Cgroup"          as customer_group_code,
        "U_Ldcst"           as ld_cost,
        "Comments"          as comments,
        "U_AVA_MARGINTYPE"  as margin_sharing_type

    from source

)

select * from renamed
  );
[0m10:48:22.606761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:22.681359 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "fbs_db.dbt_dev_staging.stg_sap__orders__dbt_tmp"

[0m10:48:22.681787 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: ROLLBACK
[0m10:48:22.684809 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: Close
[0m10:48:22.694230 [debug] [Thread-1 (]: Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.dbt_dev_staging.stg_sap__orders__dbt_tmp"
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:48:22.696087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70cf761a-74ab-482a-a71e-c80ab91b44f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe579b7a000>]}
[0m10:48:22.696708 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dev_staging.stg_sap__orders ........... [[31mERROR[0m in 0.13s]
[0m10:48:22.697228 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_sap__orders
[0m10:48:22.697978 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.stg_sap__orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.dbt_dev_staging.stg_sap__orders__dbt_tmp"
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql.
[0m10:48:22.700412 [debug] [MainThread]: On master: COMMIT
[0m10:48:22.700755 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:22.700989 [debug] [MainThread]: On master: COMMIT
[0m10:48:22.701191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:22.771565 [debug] [MainThread]: SQL status: COMMIT in 0.070 seconds
[0m10:48:22.771995 [debug] [MainThread]: On master: Close
[0m10:48:22.772414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:22.772711 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__orders' was properly closed.
[0m10:48:22.773017 [info ] [MainThread]: 
[0m10:48:22.773311 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m10:48:22.773894 [debug] [MainThread]: Command end result
[0m10:48:22.791718 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m10:48:22.793326 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m10:48:22.797880 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m10:48:22.798270 [info ] [MainThread]: 
[0m10:48:22.799129 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:48:22.799813 [info ] [MainThread]: 
[0m10:48:22.800175 [error] [MainThread]: [31mFailure in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)[0m
[0m10:48:22.800477 [error] [MainThread]:   Database Error in model stg_sap__orders (models/staging/sap/stg_sap__orders.sql)
  cross-database references are not implemented: "fbs_db.dbt_dev_staging.stg_sap__orders__dbt_tmp"
  compiled code at target/run/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:48:22.800729 [info ] [MainThread]: 
[0m10:48:22.801029 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/staging/sap/stg_sap__orders.sql
[0m10:48:22.801405 [info ] [MainThread]: 
[0m10:48:22.801704 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:48:22.803404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.203708, "process_in_blocks": "90392", "process_kernel_time": 0.196954, "process_mem_max_rss": "129928", "process_out_blocks": "2872", "process_user_time": 2.273923}
[0m10:48:22.803818 [debug] [MainThread]: Command `dbt run` failed at 10:48:22.803732 after 2.20 seconds
[0m10:48:22.804131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57b0d43e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57ba82840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57876a270>]}
[0m10:48:22.804410 [debug] [MainThread]: Flushing usage events
[0m10:48:23.982028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:06.631831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99018192b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ffde58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9900056cf0>]}


============================== 10:49:06.636601 | 813e382f-0700-41e7-8cf6-6b1f3bf3b9c6 ==============================
[0m10:49:06.636601 [info ] [MainThread]: Running with dbt=1.11.5
[0m10:49:06.637156 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'profiles_dir': '/home/suraj/.dbt', 'debug': 'False', 'no_print': 'None', 'fail_fast': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_path': '/home/suraj/frontier_analytics/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_sap__orders', 'warn_error': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True'}
[0m10:49:06.811789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '813e382f-0700-41e7-8cf6-6b1f3bf3b9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fe7cb8f0>]}
[0m10:49:06.866268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '813e382f-0700-41e7-8cf6-6b1f3bf3b9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fe76dac0>]}
[0m10:49:06.867670 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:49:06.925966 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m10:49:06.991756 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:49:06.992303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '813e382f-0700-41e7-8cf6-6b1f3bf3b9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ff30fdd0>]}
[0m10:49:07.846657 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.frontier_analytics.intermediate
- models.frontier_analytics.marts
[0m10:49:07.855585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '813e382f-0700-41e7-8cf6-6b1f3bf3b9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fe358e60>]}
[0m10:49:07.905169 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m10:49:07.908435 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m10:49:07.934144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '813e382f-0700-41e7-8cf6-6b1f3bf3b9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fcfab590>]}
[0m10:49:07.934699 [info ] [MainThread]: Found 1 model, 16 sources, 466 macros
[0m10:49:07.935341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813e382f-0700-41e7-8cf6-6b1f3bf3b9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fcf18b90>]}
[0m10:49:07.937468 [info ] [MainThread]: 
[0m10:49:07.938012 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:49:07.938352 [info ] [MainThread]: 
[0m10:49:07.938960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:49:07.940094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m10:49:07.972330 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m10:49:07.972742 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m10:49:07.973018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:08.086848 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.114 seconds
[0m10:49:08.088304 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m10:49:08.089951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m10:49:08.095360 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m10:49:08.095975 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m10:49:08.096305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:08.183948 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.088 seconds
[0m10:49:08.185257 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m10:49:08.188723 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m10:49:08.192342 [debug] [MainThread]: Using postgres connection "master"
[0m10:49:08.192732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:49:08.193041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:49:08.284609 [debug] [MainThread]: SQL status: SELECT 69 in 0.091 seconds
[0m10:49:08.286425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813e382f-0700-41e7-8cf6-6b1f3bf3b9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fe355ca0>]}
[0m10:49:08.286968 [debug] [MainThread]: On master: ROLLBACK
[0m10:49:08.289022 [debug] [MainThread]: On master: COMMIT
[0m10:49:08.289325 [debug] [MainThread]: Using postgres connection "master"
[0m10:49:08.289553 [debug] [MainThread]: On master: COMMIT
[0m10:49:08.294191 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:49:08.294653 [debug] [MainThread]: On master: Close
[0m10:49:08.300996 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_sap__orders
[0m10:49:08.301907 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_staging.stg_sap__orders .................... [RUN]
[0m10:49:08.302380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.stg_sap__orders)
[0m10:49:08.302671 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_sap__orders
[0m10:49:08.308252 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__orders"
[0m10:49:08.309520 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_sap__orders
[0m10:49:08.338769 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__orders"
[0m10:49:08.339430 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m10:49:08.339859 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."ORDR"

),

renamed as (

    select
        "DocEntry"          as order_id,
        "DocNum"            as order_number,
        "DocDate"           as order_date,
        "CardName"          as customer_name,
        "CANCELED"          as is_cancelled,
        "U_Marginpl"::numeric as margin,
        "U_SBU"             as sbu_code,
        "U_Ordertype"       as order_type,
        "U_AVA_MARGINTYPE"  as margin_type,
        "U_SalesExecutive"  as sales_executive_code,
        "U_AVA_Block"       as block_code,
        "U_Cgroup"          as customer_group_code,
        "U_Ldcst"           as ld_cost,
        "Comments"          as comments,
        "U_AVA_MARGINTYPE"  as margin_sharing_type

    from source

)

select * from renamed
  );
[0m10:49:08.340228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:08.732230 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.392 seconds
[0m10:49:08.737704 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m10:49:08.738180 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_tmp" rename to "stg_sap__orders"
[0m10:49:08.756505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m10:49:08.766053 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: COMMIT
[0m10:49:08.766507 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m10:49:08.766787 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: COMMIT
[0m10:49:08.773279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:49:08.778671 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_backup"
[0m10:49:08.782122 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m10:49:08.782426 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_backup" cascade
[0m10:49:08.786172 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:49:08.787970 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: Close
[0m10:49:08.790179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813e382f-0700-41e7-8cf6-6b1f3bf3b9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ec61de80>]}
[0m10:49:08.790695 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dev_staging.stg_sap__orders ............... [[32mCREATE VIEW[0m in 0.49s]
[0m10:49:08.791145 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_sap__orders
[0m10:49:08.793998 [debug] [MainThread]: On master: COMMIT
[0m10:49:08.794364 [debug] [MainThread]: Using postgres connection "master"
[0m10:49:08.794648 [debug] [MainThread]: On master: COMMIT
[0m10:49:08.794844 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:49:08.869236 [debug] [MainThread]: SQL status: COMMIT in 0.074 seconds
[0m10:49:08.869709 [debug] [MainThread]: On master: Close
[0m10:49:08.870120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:08.870364 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__orders' was properly closed.
[0m10:49:08.870627 [info ] [MainThread]: 
[0m10:49:08.870900 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m10:49:08.871440 [debug] [MainThread]: Command end result
[0m10:49:08.886936 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m10:49:08.888894 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m10:49:08.895529 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m10:49:08.896890 [info ] [MainThread]: 
[0m10:49:08.899515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:08.901270 [info ] [MainThread]: 
[0m10:49:08.902087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:49:08.906641 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3319407, "process_in_blocks": "91600", "process_kernel_time": 0.213519, "process_mem_max_rss": "132368", "process_out_blocks": "2880", "process_user_time": 2.302296}
[0m10:49:08.907829 [debug] [MainThread]: Command `dbt run` succeeded at 10:49:08.907574 after 2.33 seconds
[0m10:49:08.908412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fd7a2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9900123c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ee773d40>]}
[0m10:49:08.908921 [debug] [MainThread]: Flushing usage events
[0m10:49:09.952158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:05:24.968766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34afcb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34a90df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34cd62a50>]}


============================== 11:05:24.976487 | e2ed4f37-ece5-4bac-832a-fcda71c712ba ==============================
[0m11:05:24.976487 [info ] [MainThread]: Running with dbt=1.11.5
[0m11:05:24.977049 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'log_path': '/home/suraj/frontier_analytics/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'introspect': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'debug': 'False', 'profiles_dir': '/home/suraj/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m11:05:25.148091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34cb23620>]}
[0m11:05:25.202283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34ae6b1a0>]}
[0m11:05:25.204010 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:05:25.254556 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m11:05:25.366448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 7 files added, 0 files changed.
[0m11:05:25.366977 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/staging/sap/stg_sap__profit_centres.sql
[0m11:05:25.367279 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/staging/crm/stg_crm__users.sql
[0m11:05:25.367534 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/staging/crm/stg_crm__companies.sql
[0m11:05:25.367765 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/staging/sap/stg_sap__margin_sharing.sql
[0m11:05:25.367985 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/staging/crm/stg_crm__custom_captions.sql
[0m11:05:25.368197 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/staging/sap/stg_sap__order_lines.sql
[0m11:05:25.368435 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/staging/crm/stg_crm__opportunities.sql
[0m11:05:25.584346 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.frontier_analytics.intermediate
- models.frontier_analytics.marts
[0m11:05:25.594514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc348350980>]}
[0m11:05:25.648944 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:05:25.651053 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:05:25.693497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34b34a5d0>]}
[0m11:05:25.693982 [info ] [MainThread]: Found 8 models, 16 sources, 466 macros
[0m11:05:25.694316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34977eae0>]}
[0m11:05:25.696010 [info ] [MainThread]: 
[0m11:05:25.696436 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:05:25.696756 [info ] [MainThread]: 
[0m11:05:25.697317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:05:25.700921 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m11:05:25.739813 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m11:05:25.740236 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m11:05:25.740829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:25.838108 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.097 seconds
[0m11:05:25.839567 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m11:05:25.841932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m11:05:25.846878 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m11:05:25.847235 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m11:05:25.847536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:05:25.932714 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.085 seconds
[0m11:05:25.934132 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m11:05:25.936652 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m11:05:25.940196 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:25.940521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:05:25.940810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:05:26.024231 [debug] [MainThread]: SQL status: SELECT 70 in 0.083 seconds
[0m11:05:26.025966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34830f170>]}
[0m11:05:26.026400 [debug] [MainThread]: On master: ROLLBACK
[0m11:05:26.029091 [debug] [MainThread]: On master: COMMIT
[0m11:05:26.029382 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:26.029619 [debug] [MainThread]: On master: COMMIT
[0m11:05:26.033593 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m11:05:26.033878 [debug] [MainThread]: On master: Close
[0m11:05:26.042000 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_crm__companies
[0m11:05:26.042666 [debug] [Thread-2 (]: Began running node model.frontier_analytics.stg_crm__custom_captions
[0m11:05:26.043179 [info ] [Thread-1 (]: 1 of 8 START sql view model dbt_dev_staging.stg_crm__companies ................. [RUN]
[0m11:05:26.044152 [debug] [Thread-3 (]: Began running node model.frontier_analytics.stg_crm__opportunities
[0m11:05:26.044687 [debug] [Thread-4 (]: Began running node model.frontier_analytics.stg_crm__users
[0m11:05:26.043744 [info ] [Thread-2 (]: 2 of 8 START sql view model dbt_dev_staging.stg_crm__custom_captions ........... [RUN]
[0m11:05:26.045186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.stg_crm__companies)
[0m11:05:26.045653 [info ] [Thread-3 (]: 3 of 8 START sql view model dbt_dev_staging.stg_crm__opportunities ............. [RUN]
[0m11:05:26.046123 [info ] [Thread-4 (]: 4 of 8 START sql view model dbt_dev_staging.stg_crm__users ..................... [RUN]
[0m11:05:26.046630 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.frontier_analytics.stg_crm__custom_captions'
[0m11:05:26.046969 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_crm__companies
[0m11:05:26.047393 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.frontier_analytics.stg_crm__opportunities'
[0m11:05:26.047827 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.frontier_analytics.stg_crm__users'
[0m11:05:26.048141 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.stg_crm__custom_captions
[0m11:05:26.053452 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__companies"
[0m11:05:26.053857 [debug] [Thread-3 (]: Began compiling node model.frontier_analytics.stg_crm__opportunities
[0m11:05:26.054246 [debug] [Thread-4 (]: Began compiling node model.frontier_analytics.stg_crm__users
[0m11:05:26.056220 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__custom_captions"
[0m11:05:26.060448 [debug] [Thread-3 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__opportunities"
[0m11:05:26.063400 [debug] [Thread-4 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__users"
[0m11:05:26.064229 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_crm__companies
[0m11:05:26.064951 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.stg_crm__custom_captions
[0m11:05:26.077296 [debug] [Thread-3 (]: Began executing node model.frontier_analytics.stg_crm__opportunities
[0m11:05:26.084959 [debug] [Thread-4 (]: Began executing node model.frontier_analytics.stg_crm__users
[0m11:05:26.101640 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__companies"
[0m11:05:26.103729 [debug] [Thread-3 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__opportunities"
[0m11:05:26.105821 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__custom_captions"
[0m11:05:26.159254 [debug] [Thread-4 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__users"
[0m11:05:26.161334 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_crm__opportunities"
[0m11:05:26.162358 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_crm__users"
[0m11:05:26.163082 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_crm__companies"
[0m11:05:26.163578 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__opportunities"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities__dbt_tmp"
    
    
  as (
    with source as (

    select * from FBS_DB."CRM"."Opportunity"

),

renamed as (

    select
        "Oppo_OpportunityId"    as opportunity_id,
        "Oppo_PrimaryCompanyId" as company_id,
        "Oppo_AssignedUserId"   as assigned_user_id,
        "Oppo_CreatedBy"        as created_by_user_id,
        "Oppo_Opened"           as opened_at,
        "Oppo_TargetClose"      as target_close_date,
        "Oppo_UpdatedDate"      as updated_at,
        "Oppo_Stage"            as stage,
        "Oppo_Certainty"        as certainty,
        "Oppo_Forecast"         as forecast_topline,
        "Oppo_ChannelId"        as channel_id,
        "oppo_segment"          as segment,
        "oppo_qty"              as quantity,
        "oppo_oppotype"         as opportunity_type,
        "oppo_principle"        as oem_principle,
        "oppo_OEM1"             as oem_1,
        "oppo_OEM2"             as oem_2,
        "oppo_oem3"             as oem_3,
        "oppo_sbu1"             as sbu_1_id,
        "oppo_SBU2"             as sbu_2_id,
        "oppo_sbu3"             as sbu_3_id,

        "oppo_SA"               as solution_architect_code,
        "oppo_CRIMOFF"          as services_subcategory,
        "oppo_Mustwin"          as is_mustwin,
        "oppo_VPvisit"          as is_vp_visit,
        "oppo_VPVISITREMARK"    as vp_visit_remark,
        "oppo_bforecast"        as forecast_bottomline,
        "oppo_topline1"         as topline_1,
        "oppo_topline2"         as topline_2,
        "oppo_topline3"         as topline_3,
        "oppo_botline1"         as bottomline_1,
        "oppo_botline2"         as bottomline_2,
        "oppo_botline3"         as bottomline_3
    from source

)

select * from renamed
  );
[0m11:05:26.164172 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_crm__custom_captions"
[0m11:05:26.164590 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__users"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__users__dbt_tmp"
    
    
  as (
    with source as (

    select * from FBS_DB."CRM"."Users"

),

renamed as (

    select
        "User_UserId"       as user_id,
        "User_FirstName"    as first_name,
        "User_LastName"     as last_name,
        "User_Logon"        as logon_id,
        concat("User_FirstName", ' ', "User_LastName") as full_name,
        regexp_replace("User_Logon"::text, '[^0-9]', '', 'g') as employee_id
    from source

)

select * from renamed
  );
[0m11:05:26.164949 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__companies"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__companies__dbt_tmp"
    
    
  as (
    with source as (

    select * from FBS_DB."CRM"."Company"

),

renamed as (

    select
        "Comp_CompanyId"    as company_id,
        "Comp_Name"         as company_name,
        "Comp_Sector"       as sector_code,
        "Comp_PrimaryUserId" as primary_user_id,
        "comp_blocks"       as block_code
    from source

)

select * from renamed
  );
[0m11:05:26.165367 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:05:26.165703 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__custom_captions"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions__dbt_tmp"
    
    
  as (
    with source as (

    select * from FBS_DB."CRM"."Custom_Captions"

),

renamed as (

    select
        "Capt_Code"     as caption_code,
        "Capt_Family"   as caption_family,
        "Capt_US"       as caption_value
    from source

)

select * from renamed
  );
[0m11:05:26.166099 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:05:26.166445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:26.166935 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:05:26.250122 [debug] [Thread-4 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "fbs_db.CRM.Users"
LINE 9:     select * from FBS_DB."CRM"."Users"
                          ^

[0m11:05:26.250675 [debug] [Thread-3 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "fbs_db.CRM.Opportunity"
LINE 9:     select * from FBS_DB."CRM"."Opportunity"
                          ^

[0m11:05:26.251323 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: ROLLBACK
[0m11:05:26.251725 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: ROLLBACK
[0m11:05:26.253907 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "fbs_db.CRM.Company"
LINE 9:     select * from FBS_DB."CRM"."Company"
                          ^

[0m11:05:26.254228 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: ROLLBACK
[0m11:05:26.254707 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: Close
[0m11:05:26.255158 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: Close
[0m11:05:26.257508 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "fbs_db.CRM.Custom_Captions"
LINE 9:     select * from FBS_DB."CRM"."Custom_Captions"
                          ^

[0m11:05:26.258160 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: ROLLBACK
[0m11:05:26.259171 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: Close
[0m11:05:26.261824 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: Close
[0m11:05:26.272435 [debug] [Thread-2 (]: Database Error in model stg_crm__custom_captions (models/staging/crm/stg_crm__custom_captions.sql)
  cross-database references are not implemented: "fbs_db.CRM.Custom_Captions"
  LINE 9:     select * from FBS_DB."CRM"."Custom_Captions"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__custom_captions.sql
[0m11:05:26.273498 [debug] [Thread-1 (]: Database Error in model stg_crm__companies (models/staging/crm/stg_crm__companies.sql)
  cross-database references are not implemented: "fbs_db.CRM.Company"
  LINE 9:     select * from FBS_DB."CRM"."Company"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__companies.sql
[0m11:05:26.275850 [debug] [Thread-4 (]: Database Error in model stg_crm__users (models/staging/crm/stg_crm__users.sql)
  cross-database references are not implemented: "fbs_db.CRM.Users"
  LINE 9:     select * from FBS_DB."CRM"."Users"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__users.sql
[0m11:05:26.276973 [debug] [Thread-3 (]: Database Error in model stg_crm__opportunities (models/staging/crm/stg_crm__opportunities.sql)
  cross-database references are not implemented: "fbs_db.CRM.Opportunity"
  LINE 9:     select * from FBS_DB."CRM"."Opportunity"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__opportunities.sql
[0m11:05:26.278015 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34cb23230>]}
[0m11:05:26.278366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34873a5d0>]}
[0m11:05:26.278780 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc345575490>]}
[0m11:05:26.279192 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3455c7ec0>]}
[0m11:05:26.279959 [error] [Thread-2 (]: 2 of 8 ERROR creating sql view model dbt_dev_staging.stg_crm__custom_captions .. [[31mERROR[0m in 0.23s]
[0m11:05:26.280660 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model dbt_dev_staging.stg_crm__companies ........ [[31mERROR[0m in 0.23s]
[0m11:05:26.281411 [error] [Thread-4 (]: 4 of 8 ERROR creating sql view model dbt_dev_staging.stg_crm__users ............ [[31mERROR[0m in 0.23s]
[0m11:05:26.282028 [error] [Thread-3 (]: 3 of 8 ERROR creating sql view model dbt_dev_staging.stg_crm__opportunities .... [[31mERROR[0m in 0.23s]
[0m11:05:26.282583 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.stg_crm__custom_captions
[0m11:05:26.283028 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_crm__companies
[0m11:05:26.283446 [debug] [Thread-4 (]: Finished running node model.frontier_analytics.stg_crm__users
[0m11:05:26.283876 [debug] [Thread-3 (]: Finished running node model.frontier_analytics.stg_crm__opportunities
[0m11:05:26.284241 [debug] [Thread-2 (]: Began running node model.frontier_analytics.stg_sap__margin_sharing
[0m11:05:26.284668 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.stg_crm__custom_captions' to be skipped because of status 'error'.  Reason: Database Error in model stg_crm__custom_captions (models/staging/crm/stg_crm__custom_captions.sql)
  cross-database references are not implemented: "fbs_db.CRM.Custom_Captions"
  LINE 9:     select * from FBS_DB."CRM"."Custom_Captions"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__custom_captions.sql.
[0m11:05:26.284983 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_sap__order_lines
[0m11:05:26.285350 [debug] [Thread-4 (]: Began running node model.frontier_analytics.stg_sap__orders
[0m11:05:26.285683 [debug] [Thread-3 (]: Began running node model.frontier_analytics.stg_sap__profit_centres
[0m11:05:26.286068 [info ] [Thread-2 (]: 5 of 8 START sql view model dbt_dev_staging.stg_sap__margin_sharing ............ [RUN]
[0m11:05:26.287033 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.stg_crm__companies' to be skipped because of status 'error'.  Reason: Database Error in model stg_crm__companies (models/staging/crm/stg_crm__companies.sql)
  cross-database references are not implemented: "fbs_db.CRM.Company"
  LINE 9:     select * from FBS_DB."CRM"."Company"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__companies.sql.
[0m11:05:26.287514 [info ] [Thread-1 (]: 6 of 8 START sql view model dbt_dev_staging.stg_sap__order_lines ............... [RUN]
[0m11:05:26.287921 [info ] [Thread-4 (]: 7 of 8 START sql view model dbt_dev_staging.stg_sap__orders .................... [RUN]
[0m11:05:26.288542 [info ] [Thread-3 (]: 8 of 8 START sql view model dbt_dev_staging.stg_sap__profit_centres ............ [RUN]
[0m11:05:26.289099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__custom_captions, now model.frontier_analytics.stg_sap__margin_sharing)
[0m11:05:26.289710 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.stg_crm__users' to be skipped because of status 'error'.  Reason: Database Error in model stg_crm__users (models/staging/crm/stg_crm__users.sql)
  cross-database references are not implemented: "fbs_db.CRM.Users"
  LINE 9:     select * from FBS_DB."CRM"."Users"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__users.sql.
[0m11:05:26.290043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__companies, now model.frontier_analytics.stg_sap__order_lines)
[0m11:05:26.290380 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__users, now model.frontier_analytics.stg_sap__orders)
[0m11:05:26.290710 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__opportunities, now model.frontier_analytics.stg_sap__profit_centres)
[0m11:05:26.291020 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.stg_sap__margin_sharing
[0m11:05:26.291422 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.stg_crm__opportunities' to be skipped because of status 'error'.  Reason: Database Error in model stg_crm__opportunities (models/staging/crm/stg_crm__opportunities.sql)
  cross-database references are not implemented: "fbs_db.CRM.Opportunity"
  LINE 9:     select * from FBS_DB."CRM"."Opportunity"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__opportunities.sql.
[0m11:05:26.291756 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_sap__order_lines
[0m11:05:26.292065 [debug] [Thread-4 (]: Began compiling node model.frontier_analytics.stg_sap__orders
[0m11:05:26.292356 [debug] [Thread-3 (]: Began compiling node model.frontier_analytics.stg_sap__profit_centres
[0m11:05:26.295065 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:05:26.298605 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__order_lines"
[0m11:05:26.301637 [debug] [Thread-4 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__orders"
[0m11:05:26.303629 [debug] [Thread-3 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__profit_centres"
[0m11:05:26.304753 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.stg_sap__margin_sharing
[0m11:05:26.307148 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:05:26.307629 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_sap__order_lines
[0m11:05:26.308045 [debug] [Thread-3 (]: Began executing node model.frontier_analytics.stg_sap__profit_centres
[0m11:05:26.310001 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__order_lines"
[0m11:05:26.310371 [debug] [Thread-4 (]: Began executing node model.frontier_analytics.stg_sap__orders
[0m11:05:26.312363 [debug] [Thread-3 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__profit_centres"
[0m11:05:26.313028 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:05:26.316701 [debug] [Thread-4 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__orders"
[0m11:05:26.317383 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m11:05:26.317957 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__margin_sharing"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."@F_MARGINSHARING"

),

renamed as (

    select
        "Code"                  as code,
        "U_AVA_DocEntry"::integer as order_id,
        "U_AVA_DocNum"          as order_number,
        "U_AVA_EMPID"           as employee_id_code,
        "U_AVA_SUB"             as sbu_code,
        "U_AVA_SUBCATEGORY"     as subcategory,
        "U_AVA_BLOCK"           as block_code,
        "U_AVA_MARGIN"          as margin_raw,
        "U_AVA_FMargin"         as margin_final,
        "U_S_Orn"               as source_reference
    from source

)

select * from renamed
  );
[0m11:05:26.318714 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m11:05:26.319105 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__order_lines: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__order_lines"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."RDR1"

),

renamed as (

    select
        "DocEntry"      as order_id,
        "LineNum"       as line_number,
        "ItemCode"      as item_code,
        "Dscription"    as item_description,
        "U_SSC"         as subcategory,
        "LineTotal"     as line_total,
        "Quantity"      as quantity
    from source

)

select * from renamed
  );
[0m11:05:26.319498 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:05:26.319839 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m11:05:26.320217 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__profit_centres"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."OPRC"

),

renamed as (

    select
        "PrcCode"   as profit_centre_code,
        "PrcName"   as profit_centre_name
    from source

)

select * from renamed
  );
[0m11:05:26.320533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:26.321002 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."ORDR"

),

renamed as (

    select
        "DocEntry"          as order_id,
        "DocNum"            as order_number,
        "DocDate"           as order_date,
        "CardName"          as customer_name,
        "CANCELED"          as is_cancelled,
        "U_Marginpl"::numeric as margin,
        "U_SBU"             as sbu_code,
        "U_Ordertype"       as order_type,
        "U_AVA_MARGINTYPE"  as margin_type,
        "U_SalesExecutive"  as sales_executive_code,
        "U_AVA_Block"       as block_code,
        "U_Cgroup"          as customer_group_code,
        "U_Ldcst"           as ld_cost,
        "Comments"          as comments,
        "U_AVA_MARGINTYPE"  as margin_sharing_type

    from source

)

select * from renamed
  );
[0m11:05:26.321388 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:05:26.321838 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:05:26.480895 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m11:05:26.487522 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m11:05:26.487923 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__profit_centres"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_tmp" rename to "stg_sap__profit_centres"
[0m11:05:26.488806 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.169 seconds
[0m11:05:26.490828 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:05:26.491133 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__margin_sharing"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_tmp" rename to "stg_sap__margin_sharing"
[0m11:05:26.492086 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:05:26.502551 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: COMMIT
[0m11:05:26.503149 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m11:05:26.503539 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.182 seconds
[0m11:05:26.503927 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.183 seconds
[0m11:05:26.504385 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m11:05:26.505405 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: COMMIT
[0m11:05:26.507454 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m11:05:26.509453 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m11:05:26.509946 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: COMMIT
[0m11:05:26.510393 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:05:26.510808 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__orders" rename to "stg_sap__orders__dbt_backup"
[0m11:05:26.511242 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__order_lines: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__order_lines"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_tmp" rename to "stg_sap__order_lines"
[0m11:05:26.512027 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: COMMIT
[0m11:05:26.516643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:05:26.517765 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__order_lines: COMMIT
[0m11:05:26.518113 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m11:05:26.518388 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__order_lines: COMMIT
[0m11:05:26.519073 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m11:05:26.519398 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m11:05:26.519723 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m11:05:26.524657 [debug] [Thread-2 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_backup"
[0m11:05:26.526160 [debug] [Thread-3 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_backup"
[0m11:05:26.526605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m11:05:26.528489 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m11:05:26.532883 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:05:26.533474 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m11:05:26.535219 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_backup"
[0m11:05:26.535620 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_tmp" rename to "stg_sap__orders"
[0m11:05:26.536075 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__margin_sharing"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_backup" cascade
[0m11:05:26.536482 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__profit_centres"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_backup" cascade
[0m11:05:26.536973 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m11:05:26.538124 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__order_lines: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__order_lines"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_backup" cascade
[0m11:05:26.541812 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m11:05:26.544099 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: Close
[0m11:05:26.544857 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34cb22960>]}
[0m11:05:26.545261 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m11:05:26.546257 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m11:05:26.546735 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m11:05:26.545892 [info ] [Thread-2 (]: 5 of 8 OK created sql view model dbt_dev_staging.stg_sap__margin_sharing ....... [[32mCREATE VIEW[0m in 0.26s]
[0m11:05:26.548215 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: Close
[0m11:05:26.549493 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__order_lines: Close
[0m11:05:26.552890 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: COMMIT
[0m11:05:26.554100 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.stg_sap__margin_sharing
[0m11:05:26.554844 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3455c62a0>]}
[0m11:05:26.555470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3456ae420>]}
[0m11:05:26.555931 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m11:05:26.556862 [info ] [Thread-3 (]: 8 of 8 OK created sql view model dbt_dev_staging.stg_sap__profit_centres ....... [[32mCREATE VIEW[0m in 0.26s]
[0m11:05:26.557555 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dbt_dev_staging.stg_sap__order_lines .......... [[32mCREATE VIEW[0m in 0.27s]
[0m11:05:26.558019 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: COMMIT
[0m11:05:26.558546 [debug] [Thread-3 (]: Finished running node model.frontier_analytics.stg_sap__profit_centres
[0m11:05:26.559059 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_sap__order_lines
[0m11:05:26.562607 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m11:05:26.564350 [debug] [Thread-4 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_backup"
[0m11:05:26.564816 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m11:05:26.565094 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_backup" cascade
[0m11:05:26.574047 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.009 seconds
[0m11:05:26.575412 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: Close
[0m11:05:26.575964 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ed4f37-ece5-4bac-832a-fcda71c712ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34878f800>]}
[0m11:05:26.576515 [info ] [Thread-4 (]: 7 of 8 OK created sql view model dbt_dev_staging.stg_sap__orders ............... [[32mCREATE VIEW[0m in 0.29s]
[0m11:05:26.576986 [debug] [Thread-4 (]: Finished running node model.frontier_analytics.stg_sap__orders
[0m11:05:26.578925 [debug] [MainThread]: On master: COMMIT
[0m11:05:26.579221 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:26.579447 [debug] [MainThread]: On master: COMMIT
[0m11:05:26.579649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:05:26.650840 [debug] [MainThread]: SQL status: COMMIT in 0.071 seconds
[0m11:05:26.651260 [debug] [MainThread]: On master: Close
[0m11:05:26.651649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:26.651901 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__order_lines' was properly closed.
[0m11:05:26.652110 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__margin_sharing' was properly closed.
[0m11:05:26.652291 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__profit_centres' was properly closed.
[0m11:05:26.652485 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__orders' was properly closed.
[0m11:05:26.652787 [info ] [MainThread]: 
[0m11:05:26.653077 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m11:05:26.654173 [debug] [MainThread]: Command end result
[0m11:05:26.672507 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:05:26.674133 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:05:26.678733 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m11:05:26.679090 [info ] [MainThread]: 
[0m11:05:26.679593 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m11:05:26.679925 [info ] [MainThread]: 
[0m11:05:26.680281 [error] [MainThread]: [31mFailure in model stg_crm__custom_captions (models/staging/crm/stg_crm__custom_captions.sql)[0m
[0m11:05:26.680776 [error] [MainThread]:   Database Error in model stg_crm__custom_captions (models/staging/crm/stg_crm__custom_captions.sql)
  cross-database references are not implemented: "fbs_db.CRM.Custom_Captions"
  LINE 9:     select * from FBS_DB."CRM"."Custom_Captions"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__custom_captions.sql
[0m11:05:26.681299 [info ] [MainThread]: 
[0m11:05:26.681891 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/staging/crm/stg_crm__custom_captions.sql
[0m11:05:26.682576 [info ] [MainThread]: 
[0m11:05:26.683104 [error] [MainThread]: [31mFailure in model stg_crm__companies (models/staging/crm/stg_crm__companies.sql)[0m
[0m11:05:26.683416 [error] [MainThread]:   Database Error in model stg_crm__companies (models/staging/crm/stg_crm__companies.sql)
  cross-database references are not implemented: "fbs_db.CRM.Company"
  LINE 9:     select * from FBS_DB."CRM"."Company"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__companies.sql
[0m11:05:26.683807 [info ] [MainThread]: 
[0m11:05:26.684158 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/staging/crm/stg_crm__companies.sql
[0m11:05:26.684547 [info ] [MainThread]: 
[0m11:05:26.684882 [error] [MainThread]: [31mFailure in model stg_crm__users (models/staging/crm/stg_crm__users.sql)[0m
[0m11:05:26.685243 [error] [MainThread]:   Database Error in model stg_crm__users (models/staging/crm/stg_crm__users.sql)
  cross-database references are not implemented: "fbs_db.CRM.Users"
  LINE 9:     select * from FBS_DB."CRM"."Users"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__users.sql
[0m11:05:26.685478 [info ] [MainThread]: 
[0m11:05:26.685934 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/staging/crm/stg_crm__users.sql
[0m11:05:26.686163 [info ] [MainThread]: 
[0m11:05:26.686585 [error] [MainThread]: [31mFailure in model stg_crm__opportunities (models/staging/crm/stg_crm__opportunities.sql)[0m
[0m11:05:26.686996 [error] [MainThread]:   Database Error in model stg_crm__opportunities (models/staging/crm/stg_crm__opportunities.sql)
  cross-database references are not implemented: "fbs_db.CRM.Opportunity"
  LINE 9:     select * from FBS_DB."CRM"."Opportunity"
                            ^
  compiled code at target/run/frontier_analytics/models/staging/crm/stg_crm__opportunities.sql
[0m11:05:26.687304 [info ] [MainThread]: 
[0m11:05:26.687775 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/staging/crm/stg_crm__opportunities.sql
[0m11:05:26.688023 [info ] [MainThread]: 
[0m11:05:26.688403 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=8
[0m11:05:26.689902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7740793, "process_in_blocks": "77480", "process_kernel_time": 0.219009, "process_mem_max_rss": "131516", "process_out_blocks": "3232", "process_user_time": 1.989332}
[0m11:05:26.690290 [debug] [MainThread]: Command `dbt run` failed at 11:05:26.690205 after 1.77 seconds
[0m11:05:26.690584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34acf5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34cc2ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34830f170>]}
[0m11:05:26.690876 [debug] [MainThread]: Flushing usage events
[0m11:05:28.010848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:12.044168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f76968e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f769027b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74a74080>]}


============================== 11:07:12.048413 | 774b042c-7503-43da-8d49-9aa50d34e8b7 ==============================
[0m11:07:12.048413 [info ] [MainThread]: Running with dbt=1.11.5
[0m11:07:12.049787 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'warn_error': 'None', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'debug': 'False', 'profiles_dir': '/home/suraj/.dbt', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_path': '/home/suraj/frontier_analytics/logs', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m11:07:12.228368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f732fcda0>]}
[0m11:07:12.285921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7678eb10>]}
[0m11:07:12.287032 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:07:12.338643 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m11:07:12.481307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:07:12.481924 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/excel_data/schema.yml
[0m11:07:12.482514 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/staging/crm/schema.yml
[0m11:07:12.796890 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.frontier_analytics.marts
- models.frontier_analytics.intermediate
[0m11:07:12.806093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f72b85820>]}
[0m11:07:12.857457 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:07:12.860151 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:07:12.882822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7179bf20>]}
[0m11:07:12.883368 [info ] [MainThread]: Found 8 models, 16 sources, 466 macros
[0m11:07:12.883732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f71bb0770>]}
[0m11:07:12.885736 [info ] [MainThread]: 
[0m11:07:12.886718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:12.887546 [info ] [MainThread]: 
[0m11:07:12.888166 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:07:12.892280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m11:07:12.989326 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m11:07:12.989823 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m11:07:12.990162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:13.092458 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.102 seconds
[0m11:07:13.093865 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m11:07:13.096174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m11:07:13.101358 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m11:07:13.101771 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m11:07:13.102035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:13.187455 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.085 seconds
[0m11:07:13.188714 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m11:07:13.191765 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m11:07:13.196887 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:13.197335 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:07:13.197643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:13.280569 [debug] [MainThread]: SQL status: SELECT 73 in 0.083 seconds
[0m11:07:13.282712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f52fffb60>]}
[0m11:07:13.283519 [debug] [MainThread]: On master: ROLLBACK
[0m11:07:13.286196 [debug] [MainThread]: On master: COMMIT
[0m11:07:13.286517 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:13.286767 [debug] [MainThread]: On master: COMMIT
[0m11:07:13.291590 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m11:07:13.292011 [debug] [MainThread]: On master: Close
[0m11:07:13.299659 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_crm__companies
[0m11:07:13.300177 [debug] [Thread-2 (]: Began running node model.frontier_analytics.stg_crm__custom_captions
[0m11:07:13.300676 [debug] [Thread-3 (]: Began running node model.frontier_analytics.stg_crm__opportunities
[0m11:07:13.301269 [info ] [Thread-1 (]: 1 of 8 START sql view model dbt_dev_staging.stg_crm__companies ................. [RUN]
[0m11:07:13.301778 [debug] [Thread-4 (]: Began running node model.frontier_analytics.stg_crm__users
[0m11:07:13.302465 [info ] [Thread-2 (]: 2 of 8 START sql view model dbt_dev_staging.stg_crm__custom_captions ........... [RUN]
[0m11:07:13.303178 [info ] [Thread-3 (]: 3 of 8 START sql view model dbt_dev_staging.stg_crm__opportunities ............. [RUN]
[0m11:07:13.303745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.stg_crm__companies)
[0m11:07:13.304244 [info ] [Thread-4 (]: 4 of 8 START sql view model dbt_dev_staging.stg_crm__users ..................... [RUN]
[0m11:07:13.304975 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.frontier_analytics.stg_crm__custom_captions'
[0m11:07:13.305553 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.frontier_analytics.stg_crm__opportunities'
[0m11:07:13.305917 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_crm__companies
[0m11:07:13.306323 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.frontier_analytics.stg_crm__users'
[0m11:07:13.306633 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.stg_crm__custom_captions
[0m11:07:13.306938 [debug] [Thread-3 (]: Began compiling node model.frontier_analytics.stg_crm__opportunities
[0m11:07:13.312531 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__companies"
[0m11:07:13.313065 [debug] [Thread-4 (]: Began compiling node model.frontier_analytics.stg_crm__users
[0m11:07:13.316866 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__custom_captions"
[0m11:07:13.320142 [debug] [Thread-3 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__opportunities"
[0m11:07:13.323553 [debug] [Thread-4 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__users"
[0m11:07:13.324565 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.stg_crm__custom_captions
[0m11:07:13.325056 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_crm__companies
[0m11:07:13.325594 [debug] [Thread-3 (]: Began executing node model.frontier_analytics.stg_crm__opportunities
[0m11:07:13.331540 [debug] [Thread-4 (]: Began executing node model.frontier_analytics.stg_crm__users
[0m11:07:13.364075 [debug] [Thread-3 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__opportunities"
[0m11:07:13.366095 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__companies"
[0m11:07:13.368721 [debug] [Thread-4 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__users"
[0m11:07:13.371028 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__custom_captions"
[0m11:07:13.372832 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_crm__companies"
[0m11:07:13.373951 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_crm__opportunities"
[0m11:07:13.374635 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__companies"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__companies__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."CRM"."Company"

),

renamed as (

    select
        "Comp_CompanyId"    as company_id,
        "Comp_Name"         as company_name,
        "Comp_Sector"       as sector_code,
        "Comp_PrimaryUserId" as primary_user_id,
        "comp_blocks"       as block_code
    from source

)

select * from renamed
  );
[0m11:07:13.375268 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_crm__users"
[0m11:07:13.375662 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_crm__custom_captions"
[0m11:07:13.376129 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__opportunities"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."CRM"."Opportunity"

),

renamed as (

    select
        "Oppo_OpportunityId"    as opportunity_id,
        "Oppo_PrimaryCompanyId" as company_id,
        "Oppo_AssignedUserId"   as assigned_user_id,
        "Oppo_CreatedBy"        as created_by_user_id,
        "Oppo_Opened"           as opened_at,
        "Oppo_TargetClose"      as target_close_date,
        "Oppo_UpdatedDate"      as updated_at,
        "Oppo_Stage"            as stage,
        "Oppo_Certainty"        as certainty,
        "Oppo_Forecast"         as forecast_topline,
        "Oppo_ChannelId"        as channel_id,
        "oppo_segment"          as segment,
        "oppo_qty"              as quantity,
        "oppo_oppotype"         as opportunity_type,
        "oppo_principle"        as oem_principle,
        "oppo_OEM1"             as oem_1,
        "oppo_OEM2"             as oem_2,
        "oppo_oem3"             as oem_3,
        "oppo_sbu1"             as sbu_1_id,
        "oppo_SBU2"             as sbu_2_id,
        "oppo_sbu3"             as sbu_3_id,

        "oppo_SA"               as solution_architect_code,
        "oppo_CRIMOFF"          as services_subcategory,
        "oppo_Mustwin"          as is_mustwin,
        "oppo_VPvisit"          as is_vp_visit,
        "oppo_VPVISITREMARK"    as vp_visit_remark,
        "oppo_bforecast"        as forecast_bottomline,
        "oppo_topline1"         as topline_1,
        "oppo_topline2"         as topline_2,
        "oppo_topline3"         as topline_3,
        "oppo_botline1"         as bottomline_1,
        "oppo_botline2"         as bottomline_2,
        "oppo_botline3"         as bottomline_3
    from source

)

select * from renamed
  );
[0m11:07:13.376623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:13.376969 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__users"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__users__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."CRM"."Users"

),

renamed as (

    select
        "User_UserId"       as user_id,
        "User_FirstName"    as first_name,
        "User_LastName"     as last_name,
        "User_Logon"        as logon_id,
        concat("User_FirstName", ' ', "User_LastName") as full_name,
        regexp_replace("User_Logon"::text, '[^0-9]', '', 'g') as employee_id
    from source

)

select * from renamed
  );
[0m11:07:13.377315 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__custom_captions"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."CRM"."Custom_Captions"

),

renamed as (

    select
        "Capt_Code"     as caption_code,
        "Capt_Family"   as caption_family,
        "Capt_US"       as caption_value
    from source

)

select * from renamed
  );
[0m11:07:13.377632 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:07:13.378079 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:07:13.378515 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:07:13.471314 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.094 seconds
[0m11:07:13.476224 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_crm__opportunities"
[0m11:07:13.476641 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.098 seconds
[0m11:07:13.477114 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__opportunities"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities__dbt_tmp" rename to "stg_crm__opportunities"
[0m11:07:13.479449 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_crm__custom_captions"
[0m11:07:13.480384 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__custom_captions"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions__dbt_tmp" rename to "stg_crm__custom_captions"
[0m11:07:13.483415 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:07:13.484091 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:07:13.494647 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: COMMIT
[0m11:07:13.496026 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: COMMIT
[0m11:07:13.496628 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_crm__opportunities"
[0m11:07:13.497161 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.119 seconds
[0m11:07:13.497616 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_crm__custom_captions"
[0m11:07:13.498004 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: COMMIT
[0m11:07:13.500787 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_crm__users"
[0m11:07:13.501541 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: COMMIT
[0m11:07:13.502182 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__users"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__users__dbt_tmp" rename to "stg_crm__users"
[0m11:07:13.507088 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:07:13.507598 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m11:07:13.508795 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: COMMIT
[0m11:07:13.513935 [debug] [Thread-3 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities__dbt_backup"
[0m11:07:13.514523 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m11:07:13.515138 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_crm__users"
[0m11:07:13.520866 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_crm__opportunities"
[0m11:07:13.522858 [debug] [Thread-2 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions__dbt_backup"
[0m11:07:13.523384 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: COMMIT
[0m11:07:13.524058 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__opportunities"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities__dbt_backup" cascade
[0m11:07:13.524655 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_crm__custom_captions"
[0m11:07:13.525584 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__custom_captions"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions__dbt_backup" cascade
[0m11:07:13.529904 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m11:07:13.531589 [debug] [Thread-4 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_crm__users__dbt_backup"
[0m11:07:13.532325 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_crm__users"
[0m11:07:13.532643 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__users"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_crm__users__dbt_backup" cascade
[0m11:07:13.533155 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m11:07:13.533487 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m11:07:13.535676 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: Close
[0m11:07:13.536162 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:07:13.537224 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: Close
[0m11:07:13.539698 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: Close
[0m11:07:13.540889 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f766c2780>]}
[0m11:07:13.541450 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f723ab5f0>]}
[0m11:07:13.542046 [info ] [Thread-2 (]: 2 of 8 OK created sql view model dbt_dev_staging.stg_crm__custom_captions ...... [[32mCREATE VIEW[0m in 0.23s]
[0m11:07:13.542751 [info ] [Thread-3 (]: 3 of 8 OK created sql view model dbt_dev_staging.stg_crm__opportunities ........ [[32mCREATE VIEW[0m in 0.23s]
[0m11:07:13.543406 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f72f2cd40>]}
[0m11:07:13.544145 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.stg_crm__custom_captions
[0m11:07:13.544622 [debug] [Thread-3 (]: Finished running node model.frontier_analytics.stg_crm__opportunities
[0m11:07:13.545277 [info ] [Thread-4 (]: 4 of 8 OK created sql view model dbt_dev_staging.stg_crm__users ................ [[32mCREATE VIEW[0m in 0.24s]
[0m11:07:13.546032 [debug] [Thread-2 (]: Began running node model.frontier_analytics.stg_sap__margin_sharing
[0m11:07:13.546562 [debug] [Thread-3 (]: Began running node model.frontier_analytics.stg_sap__order_lines
[0m11:07:13.547098 [debug] [Thread-4 (]: Finished running node model.frontier_analytics.stg_crm__users
[0m11:07:13.547553 [info ] [Thread-2 (]: 5 of 8 START sql view model dbt_dev_staging.stg_sap__margin_sharing ............ [RUN]
[0m11:07:13.548021 [info ] [Thread-3 (]: 6 of 8 START sql view model dbt_dev_staging.stg_sap__order_lines ............... [RUN]
[0m11:07:13.548567 [debug] [Thread-4 (]: Began running node model.frontier_analytics.stg_sap__orders
[0m11:07:13.549086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__custom_captions, now model.frontier_analytics.stg_sap__margin_sharing)
[0m11:07:13.549488 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__opportunities, now model.frontier_analytics.stg_sap__order_lines)
[0m11:07:13.549896 [info ] [Thread-4 (]: 7 of 8 START sql view model dbt_dev_staging.stg_sap__orders .................... [RUN]
[0m11:07:13.550449 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.stg_sap__margin_sharing
[0m11:07:13.550927 [debug] [Thread-3 (]: Began compiling node model.frontier_analytics.stg_sap__order_lines
[0m11:07:13.551269 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__users, now model.frontier_analytics.stg_sap__orders)
[0m11:07:13.556013 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:07:13.558214 [debug] [Thread-3 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__order_lines"
[0m11:07:13.558679 [debug] [Thread-4 (]: Began compiling node model.frontier_analytics.stg_sap__orders
[0m11:07:13.561009 [debug] [Thread-4 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__orders"
[0m11:07:13.561685 [debug] [Thread-3 (]: Began executing node model.frontier_analytics.stg_sap__order_lines
[0m11:07:13.562061 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.stg_sap__margin_sharing
[0m11:07:13.564287 [debug] [Thread-3 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__order_lines"
[0m11:07:13.564636 [debug] [Thread-4 (]: Began executing node model.frontier_analytics.stg_sap__orders
[0m11:07:13.566642 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:07:13.567207 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m11:07:13.569187 [debug] [Thread-4 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__orders"
[0m11:07:13.569618 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.193 seconds
[0m11:07:13.570074 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__order_lines: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__order_lines"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."RDR1"

),

renamed as (

    select
        "DocEntry"      as order_id,
        "LineNum"       as line_number,
        "ItemCode"      as item_code,
        "Dscription"    as item_description,
        "U_SSC"         as subcategory,
        "LineTotal"     as line_total,
        "Quantity"      as quantity
    from source

)

select * from renamed
  );
[0m11:07:13.570501 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:07:13.574247 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_crm__companies"
[0m11:07:13.574840 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:13.575368 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m11:07:13.575907 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__margin_sharing"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."@F_MARGINSHARING"

),

renamed as (

    select
        "Code"                  as code,
        "U_AVA_DocEntry"::integer as order_id,
        "U_AVA_DocNum"          as order_number,
        "U_AVA_EMPID"           as employee_id_code,
        "U_AVA_SUB"             as sbu_code,
        "U_AVA_SUBCATEGORY"     as subcategory,
        "U_AVA_BLOCK"           as block_code,
        "U_AVA_MARGIN"          as margin_raw,
        "U_AVA_FMargin"         as margin_final,
        "U_S_Orn"               as source_reference
    from source

)

select * from renamed
  );
[0m11:07:13.576392 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__companies"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__companies__dbt_tmp" rename to "stg_crm__companies"
[0m11:07:13.576899 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."ORDR"

),

renamed as (

    select
        "DocEntry"          as order_id,
        "DocNum"            as order_number,
        "DocDate"           as order_date,
        "CardName"          as customer_name,
        "CANCELED"          as is_cancelled,
        "U_Marginpl"::numeric as margin,
        "U_SBU"             as sbu_code,
        "U_Ordertype"       as order_type,
        "U_AVA_MARGINTYPE"  as margin_type,
        "U_SalesExecutive"  as sales_executive_code,
        "U_AVA_Block"       as block_code,
        "U_Cgroup"          as customer_group_code,
        "U_Ldcst"           as ld_cost,
        "Comments"          as comments,
        "U_AVA_MARGINTYPE"  as margin_sharing_type

    from source

)

select * from renamed
  );
[0m11:07:13.577252 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:13.577691 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:13.582318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m11:07:13.583381 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: COMMIT
[0m11:07:13.583693 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_crm__companies"
[0m11:07:13.583951 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: COMMIT
[0m11:07:13.587941 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m11:07:13.589878 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_crm__companies__dbt_backup"
[0m11:07:13.590560 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_crm__companies"
[0m11:07:13.590916 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__companies"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_crm__companies__dbt_backup" cascade
[0m11:07:13.594418 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:07:13.595540 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: Close
[0m11:07:13.596014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f73d0aab0>]}
[0m11:07:13.596553 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dbt_dev_staging.stg_crm__companies ............ [[32mCREATE VIEW[0m in 0.29s]
[0m11:07:13.597000 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_crm__companies
[0m11:07:13.597296 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_sap__profit_centres
[0m11:07:13.597669 [info ] [Thread-1 (]: 8 of 8 START sql view model dbt_dev_staging.stg_sap__profit_centres ............ [RUN]
[0m11:07:13.598323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__companies, now model.frontier_analytics.stg_sap__profit_centres)
[0m11:07:13.598644 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_sap__profit_centres
[0m11:07:13.600945 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__profit_centres"
[0m11:07:13.601447 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_sap__profit_centres
[0m11:07:13.603524 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__profit_centres"
[0m11:07:13.604026 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m11:07:13.604313 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__profit_centres: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__profit_centres"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."OPRC"

),

renamed as (

    select
        "PrcCode"   as profit_centre_code,
        "PrcName"   as profit_centre_name
    from source

)

select * from renamed
  );
[0m11:07:13.604562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:13.663757 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.086 seconds
[0m11:07:13.667383 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:07:13.667768 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__margin_sharing"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing" rename to "stg_sap__margin_sharing__dbt_backup"
[0m11:07:13.670489 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:07:13.672683 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:07:13.673009 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__margin_sharing"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_tmp" rename to "stg_sap__margin_sharing"
[0m11:07:13.675625 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:07:13.678599 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: COMMIT
[0m11:07:13.679024 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:07:13.679320 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: COMMIT
[0m11:07:13.683314 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.108 seconds
[0m11:07:13.686120 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m11:07:13.686682 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m11:07:13.687177 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__order_lines: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__order_lines"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines" rename to "stg_sap__order_lines__dbt_backup"
[0m11:07:13.689088 [debug] [Thread-2 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_backup"
[0m11:07:13.690126 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m11:07:13.690434 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__margin_sharing"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_backup" cascade
[0m11:07:13.691228 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.087 seconds
[0m11:07:13.693662 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m11:07:13.693967 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__profit_centres: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__profit_centres"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres" rename to "stg_sap__profit_centres__dbt_backup"
[0m11:07:13.694492 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m11:07:13.696444 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m11:07:13.696771 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__order_lines: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__order_lines"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_tmp" rename to "stg_sap__order_lines"
[0m11:07:13.697117 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m11:07:13.697481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:07:13.697827 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.120 seconds
[0m11:07:13.699054 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: Close
[0m11:07:13.701595 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m11:07:13.702209 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:07:13.704308 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m11:07:13.705013 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f52f271a0>]}
[0m11:07:13.705415 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__profit_centres: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__profit_centres"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_tmp" rename to "stg_sap__profit_centres"
[0m11:07:13.706558 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__order_lines: COMMIT
[0m11:07:13.706950 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__orders" rename to "stg_sap__orders__dbt_backup"
[0m11:07:13.707629 [info ] [Thread-2 (]: 5 of 8 OK created sql view model dbt_dev_staging.stg_sap__margin_sharing ....... [[32mCREATE VIEW[0m in 0.16s]
[0m11:07:13.708327 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m11:07:13.709056 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.stg_sap__margin_sharing
[0m11:07:13.709492 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__order_lines: COMMIT
[0m11:07:13.710615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:07:13.712016 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__profit_centres: COMMIT
[0m11:07:13.712381 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m11:07:13.712655 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__profit_centres: COMMIT
[0m11:07:13.713085 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:07:13.715307 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m11:07:13.715712 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m11:07:13.716243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:07:13.716551 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_tmp" rename to "stg_sap__orders"
[0m11:07:13.719247 [debug] [Thread-3 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_backup"
[0m11:07:13.723132 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_backup"
[0m11:07:13.723977 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m11:07:13.724545 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m11:07:13.724939 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__order_lines: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__order_lines"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_backup" cascade
[0m11:07:13.725288 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__profit_centres: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__profit_centres"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_backup" cascade
[0m11:07:13.727926 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:07:13.729118 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: COMMIT
[0m11:07:13.729538 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m11:07:13.729840 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: COMMIT
[0m11:07:13.730723 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m11:07:13.732327 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__profit_centres: Close
[0m11:07:13.732862 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m11:07:13.733426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f52fbbd70>]}
[0m11:07:13.734577 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__order_lines: Close
[0m11:07:13.736839 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m11:07:13.735796 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dbt_dev_staging.stg_sap__profit_centres ....... [[32mCREATE VIEW[0m in 0.14s]
[0m11:07:13.738590 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f52fbd790>]}
[0m11:07:13.741023 [debug] [Thread-4 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_backup"
[0m11:07:13.742029 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_sap__profit_centres
[0m11:07:13.742795 [info ] [Thread-3 (]: 6 of 8 OK created sql view model dbt_dev_staging.stg_sap__order_lines .......... [[32mCREATE VIEW[0m in 0.19s]
[0m11:07:13.743553 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m11:07:13.744414 [debug] [Thread-3 (]: Finished running node model.frontier_analytics.stg_sap__order_lines
[0m11:07:13.744931 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_backup" cascade
[0m11:07:13.753147 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m11:07:13.754971 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__orders: Close
[0m11:07:13.755790 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774b042c-7503-43da-8d49-9aa50d34e8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f52fbb8c0>]}
[0m11:07:13.756704 [info ] [Thread-4 (]: 7 of 8 OK created sql view model dbt_dev_staging.stg_sap__orders ............... [[32mCREATE VIEW[0m in 0.20s]
[0m11:07:13.757220 [debug] [Thread-4 (]: Finished running node model.frontier_analytics.stg_sap__orders
[0m11:07:13.759482 [debug] [MainThread]: On master: COMMIT
[0m11:07:13.759832 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:13.760081 [debug] [MainThread]: On master: COMMIT
[0m11:07:13.760296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:13.837965 [debug] [MainThread]: SQL status: COMMIT in 0.078 seconds
[0m11:07:13.838685 [debug] [MainThread]: On master: Close
[0m11:07:13.839230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:13.839613 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__profit_centres' was properly closed.
[0m11:07:13.839823 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__margin_sharing' was properly closed.
[0m11:07:13.840011 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__order_lines' was properly closed.
[0m11:07:13.840225 [debug] [MainThread]: Connection 'model.frontier_analytics.stg_sap__orders' was properly closed.
[0m11:07:13.840509 [info ] [MainThread]: 
[0m11:07:13.840851 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m11:07:13.842093 [debug] [MainThread]: Command end result
[0m11:07:13.859389 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:07:13.861127 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:07:13.866622 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m11:07:13.867418 [info ] [MainThread]: 
[0m11:07:13.868093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:13.868399 [info ] [MainThread]: 
[0m11:07:13.868696 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m11:07:13.870445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8789665, "process_in_blocks": "91688", "process_kernel_time": 0.179986, "process_mem_max_rss": "134500", "process_out_blocks": "3224", "process_user_time": 2.245089}
[0m11:07:13.870990 [debug] [MainThread]: Command `dbt run` succeeded at 11:07:13.870873 after 1.88 seconds
[0m11:07:13.871342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f73e3d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f52f15bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74bca7e0>]}
[0m11:07:13.871696 [debug] [MainThread]: Flushing usage events
[0m11:07:15.166619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:13:26.744613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b50a92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b50ea7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b4d70d70>]}


============================== 11:13:26.751386 | 3da3927a-a04e-4eb3-b3ea-e8f3dc765931 ==============================
[0m11:13:26.751386 [info ] [MainThread]: Running with dbt=1.11.5
[0m11:13:26.751991 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'log_path': '/home/suraj/frontier_analytics/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_sap__orders_not_sharing', 'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'empty': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/home/suraj/.dbt', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager'}
[0m11:13:26.941024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3da3927a-a04e-4eb3-b3ea-e8f3dc765931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b45dcda0>]}
[0m11:13:27.003078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3da3927a-a04e-4eb3-b3ea-e8f3dc765931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b5532720>]}
[0m11:13:27.004712 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:13:27.065662 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m11:13:27.207871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:13:27.208675 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/intermediate/int_sap__orders_not_sharing.sql
[0m11:13:27.468078 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.frontier_analytics.marts
[0m11:13:27.481603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3da3927a-a04e-4eb3-b3ea-e8f3dc765931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b21fdd90>]}
[0m11:13:27.550500 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:13:27.553881 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:13:27.578426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3da3927a-a04e-4eb3-b3ea-e8f3dc765931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b298e930>]}
[0m11:13:27.579015 [info ] [MainThread]: Found 9 models, 16 sources, 466 macros
[0m11:13:27.579476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3da3927a-a04e-4eb3-b3ea-e8f3dc765931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b21db0b0>]}
[0m11:13:27.581443 [info ] [MainThread]: 
[0m11:13:27.582588 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:13:27.583332 [info ] [MainThread]: 
[0m11:13:27.584151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:13:27.586394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m11:13:27.646749 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m11:13:27.647316 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m11:13:27.648058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:27.748795 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.101 seconds
[0m11:13:27.750275 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m11:13:27.751335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now create_FBS_DB_dbt_dev_intermediate)
[0m11:13:27.751829 [debug] [ThreadPool]: Creating schema "database: "FBS_DB"
schema: "dbt_dev_intermediate"
"
[0m11:13:27.758028 [debug] [ThreadPool]: Using postgres connection "create_FBS_DB_dbt_dev_intermediate"
[0m11:13:27.758482 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "create_FBS_DB_dbt_dev_intermediate"} */
create schema if not exists "dbt_dev_intermediate"
[0m11:13:27.758754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:27.847990 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.089 seconds
[0m11:13:27.849094 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_intermediate: COMMIT
[0m11:13:27.849428 [debug] [ThreadPool]: Using postgres connection "create_FBS_DB_dbt_dev_intermediate"
[0m11:13:27.849687 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_intermediate: COMMIT
[0m11:13:27.853351 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m11:13:27.853771 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_intermediate: Close
[0m11:13:27.858123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_FBS_DB_dbt_dev_intermediate, now list_FBS_DB_dbt_dev_staging)
[0m11:13:27.862921 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m11:13:27.863292 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m11:13:27.863766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:27.864590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m11:13:27.866441 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m11:13:27.866919 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m11:13:27.867234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:27.946985 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.083 seconds
[0m11:13:27.948708 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m11:13:27.949493 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.082 seconds
[0m11:13:27.950362 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m11:13:27.950822 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m11:13:27.952554 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m11:13:27.956353 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:27.956813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:13:27.957116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:13:28.040498 [debug] [MainThread]: SQL status: SELECT 77 in 0.083 seconds
[0m11:13:28.042569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3da3927a-a04e-4eb3-b3ea-e8f3dc765931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b2de0e00>]}
[0m11:13:28.043010 [debug] [MainThread]: On master: ROLLBACK
[0m11:13:28.045290 [debug] [MainThread]: On master: COMMIT
[0m11:13:28.045602 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:28.045849 [debug] [MainThread]: On master: COMMIT
[0m11:13:28.049882 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m11:13:28.050343 [debug] [MainThread]: On master: Close
[0m11:13:28.054299 [debug] [Thread-1 (]: Began running node model.frontier_analytics.int_sap__orders_not_sharing
[0m11:13:28.054827 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_intermediate.int_sap__orders_not_sharing ... [RUN]
[0m11:13:28.055265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_intermediate, now model.frontier_analytics.int_sap__orders_not_sharing)
[0m11:13:28.055548 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.int_sap__orders_not_sharing
[0m11:13:28.061651 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_not_sharing"
[0m11:13:28.063008 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.int_sap__orders_not_sharing
[0m11:13:28.089767 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.int_sap__orders_not_sharing"
[0m11:13:28.091683 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_not_sharing"
[0m11:13:28.092144 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_not_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_not_sharing"} */

  create view "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_not_sharing__dbt_tmp"
    
    
  as (
    with orders as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__orders"

),

order_lines as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines"

),

profit_centres as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres"

),

-- Join orders to get one row per order (not per line)
-- rn = 1 ensures we take only the first line per order
-- This matches your original view logic exactly
orders_with_lines as (

    select
        o.order_id,
        o.order_number,
        o.order_date,
        o.customer_name,
        o.margin,
        o.sbu_code,
        o.order_type,
        o.margin_type,
        o.sales_executive_code,
        o.block_code,
        o.customer_group_code,
        o.ld_cost,
        o.comments,
        lower(l.subcategory) as subcategory,
        'Not Sharing' as sharing_type,
        row_number() over (partition by l.order_id) as rn

    from orders o
    join order_lines l on l.order_id = o.order_id

    -- Your original filters
    where o.margin <> 0
      and o.is_cancelled = 'N'
      and o.margin_sharing_type = 'NS'
      and (lower(l.subcategory) not like '%is%' or l.subcategory is null)
      and (o.sbu_code is null
           or o.sbu_code not in ('POWER SERVICE', 'SPWR'))

),

-- Clean employee ID - strip E000 prefix (your original CASE logic)
employee_id_cleaned as (

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        margin_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        rn,
        case
            when left(replace(sales_executive_code, 'E000', ''), 1) = '0'
                then right(replace(sales_executive_code, 'E000', ''), 3)
            when sales_executive_code = 'DIR00001'
                then '1'
            else replace(sales_executive_code, 'E000', '')
        end as employee_id,
        sales_executive_code as kam_profit_centre_code

    from orders_with_lines
    where rn = 1

)

select * from employee_id_cleaned
  );
[0m11:13:28.092484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:28.250149 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.157 seconds
[0m11:13:28.257176 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_not_sharing"
[0m11:13:28.257594 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_not_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_not_sharing"} */
alter table "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_not_sharing__dbt_tmp" rename to "int_sap__orders_not_sharing"
[0m11:13:28.261449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:13:28.273131 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_not_sharing: COMMIT
[0m11:13:28.273623 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_not_sharing"
[0m11:13:28.273971 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_not_sharing: COMMIT
[0m11:13:28.278515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m11:13:28.283343 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_not_sharing__dbt_backup"
[0m11:13:28.287885 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_not_sharing"
[0m11:13:28.288830 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_not_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_not_sharing"} */
drop view if exists "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_not_sharing__dbt_backup" cascade
[0m11:13:28.292678 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:13:28.294903 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_not_sharing: Close
[0m11:13:28.296937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3da3927a-a04e-4eb3-b3ea-e8f3dc765931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b705a930>]}
[0m11:13:28.297557 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dev_intermediate.int_sap__orders_not_sharing  [[32mCREATE VIEW[0m in 0.24s]
[0m11:13:28.298103 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.int_sap__orders_not_sharing
[0m11:13:28.300127 [debug] [MainThread]: On master: COMMIT
[0m11:13:28.300614 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:28.300909 [debug] [MainThread]: On master: COMMIT
[0m11:13:28.301096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:13:28.378093 [debug] [MainThread]: SQL status: COMMIT in 0.077 seconds
[0m11:13:28.378653 [debug] [MainThread]: On master: Close
[0m11:13:28.379140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:28.379383 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_staging' was properly closed.
[0m11:13:28.379565 [debug] [MainThread]: Connection 'model.frontier_analytics.int_sap__orders_not_sharing' was properly closed.
[0m11:13:28.379831 [info ] [MainThread]: 
[0m11:13:28.380109 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m11:13:28.380727 [debug] [MainThread]: Command end result
[0m11:13:28.463764 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:13:28.465431 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:13:28.470351 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m11:13:28.470690 [info ] [MainThread]: 
[0m11:13:28.471256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:28.471624 [info ] [MainThread]: 
[0m11:13:28.471955 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:13:28.474077 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7846447, "process_in_blocks": "90320", "process_kernel_time": 0.190349, "process_mem_max_rss": "128828", "process_out_blocks": "3064", "process_user_time": 1.989152}
[0m11:13:28.474786 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:28.474630 after 1.79 seconds
[0m11:13:28.475220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b50164b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b594b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b594b890>]}
[0m11:13:28.475608 [debug] [MainThread]: Flushing usage events
[0m11:13:29.529188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:15.626297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe11cd2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe12171ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe116e9b80>]}


============================== 11:15:15.632641 | 39867ef2-028c-40dd-bcf1-58f53dfe74c5 ==============================
[0m11:15:15.632641 [info ] [MainThread]: Running with dbt=1.11.5
[0m11:15:15.633167 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select int_sap__orders_sharing', 'log_format': 'default', 'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/home/suraj/frontier_analytics/logs', 'use_colors': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/suraj/.dbt', 'printer_width': '80', 'cache_selected_only': 'False'}
[0m11:15:15.826830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39867ef2-028c-40dd-bcf1-58f53dfe74c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe108ddf70>]}
[0m11:15:15.884515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39867ef2-028c-40dd-bcf1-58f53dfe74c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe13d46c60>]}
[0m11:15:15.885853 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:15:15.938448 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m11:15:16.055711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:15:16.056486 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/intermediate/int_sap__orders_sharing.sql
[0m11:15:16.272591 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.frontier_analytics.marts
[0m11:15:16.286215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39867ef2-028c-40dd-bcf1-58f53dfe74c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe0f1ba1e0>]}
[0m11:15:16.337421 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:15:16.339616 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:15:16.362584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39867ef2-028c-40dd-bcf1-58f53dfe74c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe0fd86db0>]}
[0m11:15:16.363036 [info ] [MainThread]: Found 10 models, 16 sources, 466 macros
[0m11:15:16.363360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39867ef2-028c-40dd-bcf1-58f53dfe74c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe0f1ba0f0>]}
[0m11:15:16.364778 [info ] [MainThread]: 
[0m11:15:16.365111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:15:16.365487 [info ] [MainThread]: 
[0m11:15:16.366023 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:15:16.367515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m11:15:16.398136 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m11:15:16.398538 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m11:15:16.398794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:16.487138 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.088 seconds
[0m11:15:16.488474 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m11:15:16.492432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_intermediate)
[0m11:15:16.498865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_staging'
[0m11:15:16.499530 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m11:15:16.501458 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m11:15:16.501021 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m11:15:16.501744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:16.502118 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m11:15:16.502678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:16.582685 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.081 seconds
[0m11:15:16.583850 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m11:15:16.584200 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.082 seconds
[0m11:15:16.585393 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m11:15:16.586346 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m11:15:16.588162 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m11:15:16.592731 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:16.593125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:15:16.593441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:16.688703 [debug] [MainThread]: SQL status: SELECT 80 in 0.095 seconds
[0m11:15:16.691448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39867ef2-028c-40dd-bcf1-58f53dfe74c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe0f97bdd0>]}
[0m11:15:16.691971 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:16.695469 [debug] [MainThread]: On master: COMMIT
[0m11:15:16.696047 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:16.696382 [debug] [MainThread]: On master: COMMIT
[0m11:15:16.706695 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m11:15:16.707204 [debug] [MainThread]: On master: Close
[0m11:15:16.715367 [debug] [Thread-1 (]: Began running node model.frontier_analytics.int_sap__orders_sharing
[0m11:15:16.715962 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_intermediate.int_sap__orders_sharing ....... [RUN]
[0m11:15:16.716553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.int_sap__orders_sharing)
[0m11:15:16.716934 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.int_sap__orders_sharing
[0m11:15:16.730080 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_sharing"
[0m11:15:16.731783 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.int_sap__orders_sharing
[0m11:15:16.758335 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.int_sap__orders_sharing"
[0m11:15:16.759136 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_sharing"
[0m11:15:16.759521 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_sharing"} */

  create view "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing__dbt_tmp"
    
    
  as (
    with margin_sharing as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing"

),

orders as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__orders"

),

order_lines as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines"

),

profit_centres as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres"

),

-- Replicate your original @F_MARGINSHARING logic
-- Final margin = U_AVA_FMargin if available, else clean U_AVA_MARGIN
margin_calculated as (

    select
        ms.code,
        ms.order_id,
        ms.order_number,
        ms.employee_id_code,
        ms.sbu_code,
        ms.subcategory,
        ms.block_code,
        ms.source_reference,
        case
            when ms.margin_final is null
                then regexp_replace(ms.margin_raw::text, '[^0-9-]', '', 'g')::numeric
            else ms.margin_final::numeric
        end as margin

    from margin_sharing ms

),

-- Join to ORDR to get order header details
joined as (

    select
        o.order_number,
        o.comments,
        mc.order_id,
        o.order_date,
        mc.margin,
        mc.sbu_code,
        o.order_type,
        o.margin_sharing_type,
        mc.employee_id_code,
        mc.block_code,
        o.customer_group_code,
        o.customer_name,
        o.ld_cost,
        lower(mc.subcategory) as subcategory,
        'Sharing' as sharing_type,
        row_number() over (partition by mc.order_id) as rn

    from margin_calculated mc
    left join orders o on o.order_id = mc.order_id
    left join order_lines l on l.order_id = mc.order_id

    where (
            coalesce(regexp_replace(mc.margin_raw::text, '[^0-9.-]', '', 'g')::numeric, 0) +
            coalesce(mc.margin_final::numeric, 0)
          ) <> 0
      and o.is_cancelled = 'N'
      and o.margin_sharing_type = 'S'
      and (lower(mc.subcategory) not like '%is%' or mc.subcategory is null)
      and (mc.sbu_code is null
           or mc.sbu_code not in ('POWER SERVICE', 'SPWR'))

),

-- Clean employee ID same logic as not sharing
employee_id_cleaned as (

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        margin_sharing_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        rn,
        case
            when left(replace(employee_id_code, 'E000', ''), 1) = '0'
                then right(replace(employee_id_code, 'E000', ''), 3)
            else replace(employee_id_code, 'E000', '')
        end as employee_id,
        employee_id_code as kam_profit_centre_code

    from joined
    where rn = 1

)

select * from employee_id_cleaned
  );
[0m11:15:16.759863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:16.854335 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column mc.margin_raw does not exist
LINE 80:             coalesce(regexp_replace(mc.margin_raw::text, '[^...
                                             ^

[0m11:15:16.855241 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: ROLLBACK
[0m11:15:16.863164 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: Close
[0m11:15:16.870706 [debug] [Thread-1 (]: Database Error in model int_sap__orders_sharing (models/intermediate/int_sap__orders_sharing.sql)
  column mc.margin_raw does not exist
  LINE 80:             coalesce(regexp_replace(mc.margin_raw::text, '[^...
                                               ^
  compiled code at target/run/frontier_analytics/models/intermediate/int_sap__orders_sharing.sql
[0m11:15:16.872274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39867ef2-028c-40dd-bcf1-58f53dfe74c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe0cdefb30>]}
[0m11:15:16.872850 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dev_intermediate.int_sap__orders_sharing  [[31mERROR[0m in 0.15s]
[0m11:15:16.873350 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.int_sap__orders_sharing
[0m11:15:16.873984 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.int_sap__orders_sharing' to be skipped because of status 'error'.  Reason: Database Error in model int_sap__orders_sharing (models/intermediate/int_sap__orders_sharing.sql)
  column mc.margin_raw does not exist
  LINE 80:             coalesce(regexp_replace(mc.margin_raw::text, '[^...
                                               ^
  compiled code at target/run/frontier_analytics/models/intermediate/int_sap__orders_sharing.sql.
[0m11:15:16.876746 [debug] [MainThread]: On master: COMMIT
[0m11:15:16.877286 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:16.877540 [debug] [MainThread]: On master: COMMIT
[0m11:15:16.877893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:16.959460 [debug] [MainThread]: SQL status: COMMIT in 0.081 seconds
[0m11:15:16.960037 [debug] [MainThread]: On master: Close
[0m11:15:16.960521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:16.962161 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_intermediate' was properly closed.
[0m11:15:16.962388 [debug] [MainThread]: Connection 'model.frontier_analytics.int_sap__orders_sharing' was properly closed.
[0m11:15:16.962674 [info ] [MainThread]: 
[0m11:15:16.962931 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m11:15:16.963492 [debug] [MainThread]: Command end result
[0m11:15:17.037927 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:15:17.039819 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:15:17.043977 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m11:15:17.044469 [info ] [MainThread]: 
[0m11:15:17.044865 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:15:17.045203 [info ] [MainThread]: 
[0m11:15:17.046071 [error] [MainThread]: [31mFailure in model int_sap__orders_sharing (models/intermediate/int_sap__orders_sharing.sql)[0m
[0m11:15:17.046394 [error] [MainThread]:   Database Error in model int_sap__orders_sharing (models/intermediate/int_sap__orders_sharing.sql)
  column mc.margin_raw does not exist
  LINE 80:             coalesce(regexp_replace(mc.margin_raw::text, '[^...
                                               ^
  compiled code at target/run/frontier_analytics/models/intermediate/int_sap__orders_sharing.sql
[0m11:15:17.046791 [info ] [MainThread]: 
[0m11:15:17.047199 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/intermediate/int_sap__orders_sharing.sql
[0m11:15:17.047444 [info ] [MainThread]: 
[0m11:15:17.047801 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:15:17.049240 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4749161, "process_in_blocks": "92176", "process_kernel_time": 0.191642, "process_mem_max_rss": "130468", "process_out_blocks": "3096", "process_user_time": 1.843414}
[0m11:15:17.049628 [debug] [MainThread]: Command `dbt run` failed at 11:15:17.049542 after 1.48 seconds
[0m11:15:17.049929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe116846e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe11f42930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe0c202de0>]}
[0m11:15:17.050232 [debug] [MainThread]: Flushing usage events
[0m11:15:18.110814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:16:33.445912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b834e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b834cb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b834e600>]}


============================== 11:16:33.450259 | 69359840-c79e-4b60-9178-231b166641b8 ==============================
[0m11:16:33.450259 [info ] [MainThread]: Running with dbt=1.11.5
[0m11:16:33.450768 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select int_sap__orders_sharing', 'debug': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'version_check': 'True', 'quiet': 'False', 'profiles_dir': '/home/suraj/.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_path': '/home/suraj/frontier_analytics/logs', 'log_format': 'default', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m11:16:33.623309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69359840-c79e-4b60-9178-231b166641b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b9e2f860>]}
[0m11:16:33.679675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69359840-c79e-4b60-9178-231b166641b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b7be6d20>]}
[0m11:16:33.680944 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:16:33.732745 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m11:16:33.838831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:16:33.839208 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:16:33.839447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:16:33.844258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.frontier_analytics.marts
[0m11:16:33.867136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69359840-c79e-4b60-9178-231b166641b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6321100>]}
[0m11:16:33.922347 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:16:33.924440 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:16:33.945298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69359840-c79e-4b60-9178-231b166641b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b5332ed0>]}
[0m11:16:33.945738 [info ] [MainThread]: Found 10 models, 16 sources, 466 macros
[0m11:16:33.946070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69359840-c79e-4b60-9178-231b166641b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6322ba0>]}
[0m11:16:33.947702 [info ] [MainThread]: 
[0m11:16:33.948184 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:16:33.948703 [info ] [MainThread]: 
[0m11:16:33.949371 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:16:33.951285 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m11:16:33.982594 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m11:16:33.982988 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m11:16:33.983248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:34.072859 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.090 seconds
[0m11:16:34.074099 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m11:16:34.078186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m11:16:34.088635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m11:16:34.093738 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m11:16:34.094071 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m11:16:34.094347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:34.095077 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m11:16:34.095489 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m11:16:34.095926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:34.181726 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.086 seconds
[0m11:16:34.182942 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m11:16:34.185434 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m11:16:34.279615 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.185 seconds
[0m11:16:34.280728 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m11:16:34.283475 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m11:16:34.288323 [debug] [MainThread]: Using postgres connection "master"
[0m11:16:34.288732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:16:34.289042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:16:34.484894 [debug] [MainThread]: SQL status: SELECT 80 in 0.196 seconds
[0m11:16:34.487402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69359840-c79e-4b60-9178-231b166641b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b42cfa40>]}
[0m11:16:34.487893 [debug] [MainThread]: On master: ROLLBACK
[0m11:16:34.493704 [debug] [MainThread]: On master: COMMIT
[0m11:16:34.494125 [debug] [MainThread]: Using postgres connection "master"
[0m11:16:34.494392 [debug] [MainThread]: On master: COMMIT
[0m11:16:34.498766 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m11:16:34.499064 [debug] [MainThread]: On master: Close
[0m11:16:34.505008 [debug] [Thread-1 (]: Began running node model.frontier_analytics.int_sap__orders_sharing
[0m11:16:34.505564 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_intermediate.int_sap__orders_sharing ....... [RUN]
[0m11:16:34.506246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_intermediate, now model.frontier_analytics.int_sap__orders_sharing)
[0m11:16:34.506603 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.int_sap__orders_sharing
[0m11:16:34.512751 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_sharing"
[0m11:16:34.513363 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.int_sap__orders_sharing
[0m11:16:34.538174 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.int_sap__orders_sharing"
[0m11:16:34.538875 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_sharing"
[0m11:16:34.539289 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_sharing"} */

  create view "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing__dbt_tmp"
    
    
  as (
    with margin_sharing as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing"

),

orders as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__orders"

),

order_lines as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines"

),

profit_centres as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres"

),

-- Replicate your original @F_MARGINSHARING logic
-- Final margin = U_AVA_FMargin if available, else clean U_AVA_MARGIN
margin_calculated as (

    select
        ms.code,
        ms.order_id,
        ms.order_number,
        ms.employee_id_code,
        ms.sbu_code,
        ms.subcategory,
        ms.block_code,
        ms.source_reference,
        case
            when ms.margin_final is null
                then regexp_replace(ms.margin_raw::text, '[^0-9-]', '', 'g')::numeric
            else ms.margin_final::numeric
        end as margin

    from margin_sharing ms

),

-- Join to ORDR to get order header details
joined as (

    select
        o.order_number,
        o.comments,
        mc.order_id,
        o.order_date,
        mc.margin,
        mc.sbu_code,
        o.order_type,
        o.margin_sharing_type,
        mc.employee_id_code,
        mc.block_code,
        o.customer_group_code,
        o.customer_name,
        o.ld_cost,
        lower(mc.subcategory) as subcategory,
        'Sharing' as sharing_type,
        row_number() over (partition by mc.order_id) as rn

    from margin_calculated mc
    left join orders o on o.order_id = mc.order_id
    left join order_lines l on l.order_id = mc.order_id

    where (
            coalesce(regexp_replace(mc.margin_raw::text, '[^0-9.-]', '', 'g')::numeric, 0) +
            coalesce(mc.margin_final::numeric, 0)
          ) <> 0
      and o.is_cancelled = 'N'
      and o.margin_sharing_type = 'S'
      and (lower(mc.subcategory) not like '%is%' or mc.subcategory is null)
      and (mc.sbu_code is null
           or mc.sbu_code not in ('POWER SERVICE', 'SPWR'))

),

-- Clean employee ID same logic as not sharing
employee_id_cleaned as (

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        margin_sharing_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        rn,
        case
            when left(replace(employee_id_code, 'E000', ''), 1) = '0'
                then right(replace(employee_id_code, 'E000', ''), 3)
            else replace(employee_id_code, 'E000', '')
        end as employee_id,
        employee_id_code as kam_profit_centre_code

    from joined
    where rn = 1

)

select * from employee_id_cleaned
  );
[0m11:16:34.539605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:34.618896 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column mc.margin_raw does not exist
LINE 80:             coalesce(regexp_replace(mc.margin_raw::text, '[^...
                                             ^

[0m11:16:34.619535 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: ROLLBACK
[0m11:16:34.622317 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: Close
[0m11:16:34.632086 [debug] [Thread-1 (]: Database Error in model int_sap__orders_sharing (models/intermediate/int_sap__orders_sharing.sql)
  column mc.margin_raw does not exist
  LINE 80:             coalesce(regexp_replace(mc.margin_raw::text, '[^...
                                               ^
  compiled code at target/run/frontier_analytics/models/intermediate/int_sap__orders_sharing.sql
[0m11:16:34.633855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69359840-c79e-4b60-9178-231b166641b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b418b170>]}
[0m11:16:34.634548 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dev_intermediate.int_sap__orders_sharing  [[31mERROR[0m in 0.13s]
[0m11:16:34.635154 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.int_sap__orders_sharing
[0m11:16:34.635851 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.int_sap__orders_sharing' to be skipped because of status 'error'.  Reason: Database Error in model int_sap__orders_sharing (models/intermediate/int_sap__orders_sharing.sql)
  column mc.margin_raw does not exist
  LINE 80:             coalesce(regexp_replace(mc.margin_raw::text, '[^...
                                               ^
  compiled code at target/run/frontier_analytics/models/intermediate/int_sap__orders_sharing.sql.
[0m11:16:34.638538 [debug] [MainThread]: On master: COMMIT
[0m11:16:34.639035 [debug] [MainThread]: Using postgres connection "master"
[0m11:16:34.639400 [debug] [MainThread]: On master: COMMIT
[0m11:16:34.639666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:16:34.709106 [debug] [MainThread]: SQL status: COMMIT in 0.069 seconds
[0m11:16:34.709573 [debug] [MainThread]: On master: Close
[0m11:16:34.710044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:34.710279 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_staging' was properly closed.
[0m11:16:34.710478 [debug] [MainThread]: Connection 'model.frontier_analytics.int_sap__orders_sharing' was properly closed.
[0m11:16:34.710719 [info ] [MainThread]: 
[0m11:16:34.710991 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m11:16:34.711533 [debug] [MainThread]: Command end result
[0m11:16:34.730432 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:16:34.731980 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:16:34.736420 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m11:16:34.736712 [info ] [MainThread]: 
[0m11:16:34.737032 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:16:34.737276 [info ] [MainThread]: 
[0m11:16:34.737636 [error] [MainThread]: [31mFailure in model int_sap__orders_sharing (models/intermediate/int_sap__orders_sharing.sql)[0m
[0m11:16:34.737925 [error] [MainThread]:   Database Error in model int_sap__orders_sharing (models/intermediate/int_sap__orders_sharing.sql)
  column mc.margin_raw does not exist
  LINE 80:             coalesce(regexp_replace(mc.margin_raw::text, '[^...
                                               ^
  compiled code at target/run/frontier_analytics/models/intermediate/int_sap__orders_sharing.sql
[0m11:16:34.738149 [info ] [MainThread]: 
[0m11:16:34.738403 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/intermediate/int_sap__orders_sharing.sql
[0m11:16:34.738608 [info ] [MainThread]: 
[0m11:16:34.738838 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:16:34.740293 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3474487, "process_in_blocks": "91896", "process_kernel_time": 0.144684, "process_mem_max_rss": "123616", "process_out_blocks": "2120", "process_user_time": 1.601175}
[0m11:16:34.740666 [debug] [MainThread]: Command `dbt run` failed at 11:16:34.740585 after 1.35 seconds
[0m11:16:34.740946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b7c8e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b42e0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b832a5a0>]}
[0m11:16:34.741214 [debug] [MainThread]: Flushing usage events
[0m11:16:35.752605 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:33.272153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2585851f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25a316f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd257ec20f0>]}


============================== 11:18:33.276497 | 7e56e15b-cbf7-4668-b7cc-5676a9b5a154 ==============================
[0m11:18:33.276497 [info ] [MainThread]: Running with dbt=1.11.5
[0m11:18:33.277050 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'partial_parse': 'True', 'version_check': 'True', 'log_format': 'default', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'log_path': '/home/suraj/frontier_analytics/logs', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'profiles_dir': '/home/suraj/.dbt', 'write_json': 'True', 'invocation_command': 'dbt run --select int_sap__orders_sharing', 'indirect_selection': 'eager'}
[0m11:18:33.460194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e56e15b-cbf7-4668-b7cc-5676a9b5a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd259e6a720>]}
[0m11:18:33.518247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e56e15b-cbf7-4668-b7cc-5676a9b5a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25a19aed0>]}
[0m11:18:33.519298 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:18:33.566855 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m11:18:33.678833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:18:33.679489 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/intermediate/int_sap__orders_sharing.sql
[0m11:18:33.885300 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.frontier_analytics.marts
[0m11:18:33.895984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e56e15b-cbf7-4668-b7cc-5676a9b5a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2555de480>]}
[0m11:18:33.946599 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:18:33.948949 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:18:33.971324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e56e15b-cbf7-4668-b7cc-5676a9b5a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25559aa50>]}
[0m11:18:33.971943 [info ] [MainThread]: Found 10 models, 16 sources, 466 macros
[0m11:18:33.972646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e56e15b-cbf7-4668-b7cc-5676a9b5a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd255da30b0>]}
[0m11:18:33.974908 [info ] [MainThread]: 
[0m11:18:33.975735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:33.976586 [info ] [MainThread]: 
[0m11:18:33.977345 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:18:33.978528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m11:18:34.006948 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m11:18:34.007486 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m11:18:34.007944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:34.115046 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.107 seconds
[0m11:18:34.116241 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m11:18:34.120671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m11:18:34.126189 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m11:18:34.126570 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m11:18:34.127029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m11:18:34.127405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:34.128748 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m11:18:34.129366 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m11:18:34.129628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:34.221567 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.092 seconds
[0m11:18:34.222671 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m11:18:34.229843 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.102 seconds
[0m11:18:34.231011 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m11:18:34.231340 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m11:18:34.233496 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m11:18:34.238059 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:34.238401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:18:34.238673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:18:34.335232 [debug] [MainThread]: SQL status: SELECT 80 in 0.096 seconds
[0m11:18:34.338067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e56e15b-cbf7-4668-b7cc-5676a9b5a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23ec47080>]}
[0m11:18:34.338479 [debug] [MainThread]: On master: ROLLBACK
[0m11:18:34.340967 [debug] [MainThread]: On master: COMMIT
[0m11:18:34.341328 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:34.341583 [debug] [MainThread]: On master: COMMIT
[0m11:18:34.346165 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m11:18:34.346447 [debug] [MainThread]: On master: Close
[0m11:18:34.350943 [debug] [Thread-1 (]: Began running node model.frontier_analytics.int_sap__orders_sharing
[0m11:18:34.351433 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_intermediate.int_sap__orders_sharing ....... [RUN]
[0m11:18:34.351825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.int_sap__orders_sharing)
[0m11:18:34.352105 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.int_sap__orders_sharing
[0m11:18:34.358529 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_sharing"
[0m11:18:34.359385 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.int_sap__orders_sharing
[0m11:18:34.386396 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.int_sap__orders_sharing"
[0m11:18:34.387793 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_sharing"
[0m11:18:34.388360 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_sharing"} */

  create view "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing__dbt_tmp"
    
    
  as (
    with margin_sharing as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing"

),

orders as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__orders"

),

order_lines as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines"

),

-- Replicate your original @F_MARGINSHARING logic
-- Final margin = margin_final if available, else clean margin_raw
margin_calculated as (

    select
        code,
        order_id,
        employee_id_code,
        sbu_code,
        subcategory,
        block_code,
        source_reference,
        margin_raw,
        margin_final,
        case
            when margin_final is null
                then regexp_replace(margin_raw::text, '[^0-9-]', '', 'g')::numeric
            else margin_final::numeric
        end as margin

    from margin_sharing

),

-- Join to ORDR to get order header details
joined as (

    select
        o.order_number,
        o.comments,
        mc.order_id,
        o.order_date,
        mc.margin,
        mc.sbu_code,
        o.order_type,
        o.margin_sharing_type,
        mc.employee_id_code,
        mc.block_code,
        o.customer_group_code,
        o.customer_name,
        o.ld_cost,
        lower(mc.subcategory) as subcategory,
        'Sharing' as sharing_type,
        row_number() over (partition by mc.order_id) as rn

    from margin_calculated mc
    left join orders o on o.order_id = mc.order_id
    left join order_lines l on l.order_id = mc.order_id

    where (
            coalesce(regexp_replace(mc.margin_raw::text, '[^0-9.-]', '', 'g')::numeric, 0) +
            coalesce(mc.margin_final::numeric, 0)
          ) <> 0
      and o.is_cancelled = 'N'
      and o.margin_sharing_type = 'S'
      and (lower(mc.subcategory) not like '%is%' or mc.subcategory is null)
      and (mc.sbu_code is null
           or mc.sbu_code not in ('POWER SERVICE', 'SPWR'))

),

-- Clean employee ID - same logic as not sharing
employee_id_cleaned as (

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        margin_sharing_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        rn,
        case
            when left(replace(employee_id_code, 'E000', ''), 1) = '0'
                then right(replace(employee_id_code, 'E000', ''), 3)
            else replace(employee_id_code, 'E000', '')
        end as employee_id,
        employee_id_code as kam_profit_centre_code

    from joined
    where rn = 1

)

select * from employee_id_cleaned
  );
[0m11:18:34.388748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:34.649918 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.261 seconds
[0m11:18:34.655167 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_sharing"
[0m11:18:34.655610 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_sharing"} */
alter table "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing__dbt_tmp" rename to "int_sap__orders_sharing"
[0m11:18:34.659199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:18:34.668962 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: COMMIT
[0m11:18:34.669623 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_sharing"
[0m11:18:34.670121 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: COMMIT
[0m11:18:34.674675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m11:18:34.678795 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing__dbt_backup"
[0m11:18:34.682235 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_sharing"
[0m11:18:34.682528 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_sharing"} */
drop view if exists "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing__dbt_backup" cascade
[0m11:18:34.686329 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:18:34.689537 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: Close
[0m11:18:34.691956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e56e15b-cbf7-4668-b7cc-5676a9b5a154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25a0d6bd0>]}
[0m11:18:34.692568 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dev_intermediate.int_sap__orders_sharing .. [[32mCREATE VIEW[0m in 0.34s]
[0m11:18:34.693211 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.int_sap__orders_sharing
[0m11:18:34.695568 [debug] [MainThread]: On master: COMMIT
[0m11:18:34.696157 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:34.696402 [debug] [MainThread]: On master: COMMIT
[0m11:18:34.696598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:18:34.774174 [debug] [MainThread]: SQL status: COMMIT in 0.077 seconds
[0m11:18:34.774675 [debug] [MainThread]: On master: Close
[0m11:18:34.775099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:34.775346 [debug] [MainThread]: Connection 'model.frontier_analytics.int_sap__orders_sharing' was properly closed.
[0m11:18:34.775570 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_intermediate' was properly closed.
[0m11:18:34.775827 [info ] [MainThread]: 
[0m11:18:34.776141 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m11:18:34.776682 [debug] [MainThread]: Command end result
[0m11:18:34.856875 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m11:18:34.858970 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m11:18:34.863370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m11:18:34.863634 [info ] [MainThread]: 
[0m11:18:34.863950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:34.864193 [info ] [MainThread]: 
[0m11:18:34.864446 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:18:34.866160 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6432279, "process_in_blocks": "92000", "process_kernel_time": 0.162134, "process_mem_max_rss": "130272", "process_out_blocks": "3096", "process_user_time": 1.774471}
[0m11:18:34.866688 [debug] [MainThread]: Command `dbt run` succeeded at 11:18:34.866533 after 1.64 seconds
[0m11:18:34.866997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd258119ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23edaa420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23ec2baa0>]}
[0m11:18:34.867349 [debug] [MainThread]: Flushing usage events
[0m11:18:35.928160 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:30.022487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35c3ee240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35c3ee270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35c6851f0>]}


============================== 12:34:30.027622 | c845b32d-8d17-4a47-90e8-bb74cf025e1d ==============================
[0m12:34:30.027622 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:34:30.028196 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'target_path': 'None', 'log_path': '/home/suraj/frontier_analytics/logs', 'version_check': 'True', 'write_json': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_format': 'default', 'no_print': 'None', 'profiles_dir': '/home/suraj/.dbt', 'invocation_command': 'dbt run --select int_sap__orders_combined', 'quiet': 'False', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m12:34:30.185223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c845b32d-8d17-4a47-90e8-bb74cf025e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35af64da0>]}
[0m12:34:30.236757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c845b32d-8d17-4a47-90e8-bb74cf025e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35ff93320>]}
[0m12:34:30.237741 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:34:30.289039 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:34:30.411481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:34:30.412026 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/intermediate/int_sap__orders_combined.sql
[0m12:34:30.624408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.frontier_analytics.marts
[0m12:34:30.634011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c845b32d-8d17-4a47-90e8-bb74cf025e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3597e6900>]}
[0m12:34:30.690404 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:34:30.692766 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:34:30.714396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c845b32d-8d17-4a47-90e8-bb74cf025e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3597a3d40>]}
[0m12:34:30.714822 [info ] [MainThread]: Found 11 models, 16 sources, 466 macros
[0m12:34:30.715144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c845b32d-8d17-4a47-90e8-bb74cf025e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc359fe3320>]}
[0m12:34:30.716473 [info ] [MainThread]: 
[0m12:34:30.716824 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:34:30.717081 [info ] [MainThread]: 
[0m12:34:30.717513 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:34:30.718539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m12:34:30.756724 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m12:34:30.757097 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m12:34:30.757366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:30.856411 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.099 seconds
[0m12:34:30.857770 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m12:34:30.861408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m12:34:30.866061 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:34:30.866375 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:34:30.866639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:30.867297 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:34:30.868619 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:34:30.869052 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:34:30.869315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:30.952444 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.082 seconds
[0m12:34:30.952912 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.086 seconds
[0m12:34:30.954143 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:34:30.955232 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:34:30.957461 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:34:30.958478 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:34:30.963116 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:30.963619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:34:30.963956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:31.054643 [debug] [MainThread]: SQL status: SELECT 83 in 0.091 seconds
[0m12:34:31.057378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c845b32d-8d17-4a47-90e8-bb74cf025e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35bb0b7d0>]}
[0m12:34:31.057735 [debug] [MainThread]: On master: ROLLBACK
[0m12:34:31.060070 [debug] [MainThread]: On master: COMMIT
[0m12:34:31.060351 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:31.060586 [debug] [MainThread]: On master: COMMIT
[0m12:34:31.064493 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m12:34:31.064755 [debug] [MainThread]: On master: Close
[0m12:34:31.072924 [debug] [Thread-1 (]: Began running node model.frontier_analytics.int_sap__orders_combined
[0m12:34:31.073511 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_intermediate.int_sap__orders_combined ...... [RUN]
[0m12:34:31.073987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.int_sap__orders_combined)
[0m12:34:31.074270 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.int_sap__orders_combined
[0m12:34:31.079738 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_combined"
[0m12:34:31.081698 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.int_sap__orders_combined
[0m12:34:31.110102 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.int_sap__orders_combined"
[0m12:34:31.112061 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:34:31.112451 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_combined"} */

  create view "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_tmp"
    
    
  as (
    with not_sharing as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_not_sharing"

),

sharing as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing"

),

profit_centres as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres"

),

-- Union both streams together with matching columns
combined as (

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        employee_id,
        kam_profit_centre_code

    from not_sharing

    union all

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        employee_id,
        kam_profit_centre_code

    from sharing

),

-- Join profit centres twice - once for block name, once for KAM name
-- This mirrors your original view joining OPRC twice with different aliases
enriched as (

    select
        c.order_id,
        c.order_number,
        c.order_date,
        c.customer_name,
        c.margin,
        c.sbu_code,
        c.order_type,
        c.ld_cost,
        c.comments,
        c.subcategory,
        c.sharing_type,
        c.employee_id,
        block_pc.profit_centre_name   as block_name,
        kam_pc.profit_centre_name     as kam_name,

        -- Indian financial year quarter mapping
        case
            when extract(month from c.order_date) in (4,5,6)   then 'Q1'
            when extract(month from c.order_date) in (7,8,9)   then 'Q2'
            when extract(month from c.order_date) in (10,11,12) then 'Q3'
            when extract(month from c.order_date) in (1,2,3)   then 'Q4'
        end as financial_quarter,

        -- Month name mapping
        case extract(month from c.order_date)
            when 1  then 'January'
            when 2  then 'February'
            when 3  then 'March'
            when 4  then 'April'
            when 5  then 'May'
            when 6  then 'June'
            when 7  then 'July'
            when 8  then 'August'
            when 9  then 'September'
            when 10 then 'October'
            when 11 then 'November'
            when 12 then 'December'
        end as month_name,

        date_trunc('month', c.order_date) as order_month

    from combined c
    left join profit_centres block_pc
        on c.block_code = block_pc.profit_centre_code
    left join profit_centres kam_pc
        on c.kam_profit_centre_code = kam_pc.profit_centre_code

)

select * from enriched
  );
[0m12:34:31.112755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:31.355667 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.243 seconds
[0m12:34:31.362050 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:34:31.362474 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_combined"} */
alter table "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_tmp" rename to "int_sap__orders_combined"
[0m12:34:31.366283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:34:31.375974 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: COMMIT
[0m12:34:31.376474 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:34:31.376781 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: COMMIT
[0m12:34:31.381086 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:34:31.385357 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_backup"
[0m12:34:31.388748 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:34:31.389028 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_combined"} */
drop view if exists "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_backup" cascade
[0m12:34:31.393734 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:34:31.395768 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: Close
[0m12:34:31.398881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c845b32d-8d17-4a47-90e8-bb74cf025e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35e606a20>]}
[0m12:34:31.399558 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dev_intermediate.int_sap__orders_combined . [[32mCREATE VIEW[0m in 0.32s]
[0m12:34:31.400065 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.int_sap__orders_combined
[0m12:34:31.402839 [debug] [MainThread]: On master: COMMIT
[0m12:34:31.403252 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:31.403492 [debug] [MainThread]: On master: COMMIT
[0m12:34:31.403690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:31.480029 [debug] [MainThread]: SQL status: COMMIT in 0.076 seconds
[0m12:34:31.480486 [debug] [MainThread]: On master: Close
[0m12:34:31.481039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:31.481339 [debug] [MainThread]: Connection 'model.frontier_analytics.int_sap__orders_combined' was properly closed.
[0m12:34:31.481531 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_intermediate' was properly closed.
[0m12:34:31.481761 [info ] [MainThread]: 
[0m12:34:31.482033 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m12:34:31.482571 [debug] [MainThread]: Command end result
[0m12:34:31.555808 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:34:31.557768 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:34:31.562136 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:34:31.562409 [info ] [MainThread]: 
[0m12:34:31.562761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:31.563399 [info ] [MainThread]: 
[0m12:34:31.563793 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:34:31.565984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5914828, "process_in_blocks": "77888", "process_kernel_time": 0.299018, "process_mem_max_rss": "132488", "process_out_blocks": "3144", "process_user_time": 1.853913}
[0m12:34:31.566420 [debug] [MainThread]: Command `dbt run` succeeded at 12:34:31.566336 after 1.59 seconds
[0m12:34:31.566707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35c6a92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35c6ab740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3585d58b0>]}
[0m12:34:31.566984 [debug] [MainThread]: Flushing usage events
[0m12:34:32.666075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:31.763906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec90049f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec90081520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec91ff9b80>]}


============================== 12:35:31.769659 | 6fcb70c7-2e37-407f-9143-676026f454e8 ==============================
[0m12:35:31.769659 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:35:31.770226 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '/home/suraj/.dbt', 'target_path': 'None', 'log_path': '/home/suraj/frontier_analytics/logs', 'quiet': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'empty': 'False', 'invocation_command': 'dbt run --select int_crm__opportunities_expanded', 'introspect': 'True'}
[0m12:35:31.938062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fcb70c7-2e37-407f-9143-676026f454e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8f0e94f0>]}
[0m12:35:31.990515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fcb70c7-2e37-407f-9143-676026f454e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8fa5b920>]}
[0m12:35:31.991984 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:35:32.040638 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:35:32.152105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:35:32.152607 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/intermediate/int_crm__opportunities_expanded.sql
[0m12:35:32.335050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.frontier_analytics.marts
[0m12:35:32.346255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fcb70c7-2e37-407f-9143-676026f454e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8c9e6d50>]}
[0m12:35:32.393816 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:35:32.396020 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:35:32.414850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fcb70c7-2e37-407f-9143-676026f454e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8c9a88c0>]}
[0m12:35:32.415269 [info ] [MainThread]: Found 12 models, 16 sources, 466 macros
[0m12:35:32.415627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fcb70c7-2e37-407f-9143-676026f454e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8d1bbcb0>]}
[0m12:35:32.417108 [info ] [MainThread]: 
[0m12:35:32.417466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:35:32.417935 [info ] [MainThread]: 
[0m12:35:32.418445 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:35:32.419286 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m12:35:32.450039 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m12:35:32.450412 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m12:35:32.450655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:32.555734 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.105 seconds
[0m12:35:32.556925 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m12:35:32.560831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m12:35:32.561429 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:35:32.566022 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:35:32.567166 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:35:32.567587 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:35:32.567953 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:35:32.568303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:32.568632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:32.639875 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.071 seconds
[0m12:35:32.640922 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:35:32.643040 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:35:32.737811 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.169 seconds
[0m12:35:32.738835 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:35:32.740969 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:35:32.745302 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:32.745585 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:35:32.745829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:32.842193 [debug] [MainThread]: SQL status: SELECT 86 in 0.096 seconds
[0m12:35:32.845958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fcb70c7-2e37-407f-9143-676026f454e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8dd630e0>]}
[0m12:35:32.846253 [debug] [MainThread]: On master: ROLLBACK
[0m12:35:32.849077 [debug] [MainThread]: On master: COMMIT
[0m12:35:32.849550 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:32.849862 [debug] [MainThread]: On master: COMMIT
[0m12:35:32.855026 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m12:35:32.855414 [debug] [MainThread]: On master: Close
[0m12:35:32.861302 [debug] [Thread-1 (]: Began running node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:35:32.861757 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_intermediate.int_crm__opportunities_expanded  [RUN]
[0m12:35:32.862119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.int_crm__opportunities_expanded)
[0m12:35:32.862379 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:35:32.868849 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:35:32.870636 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:35:32.892683 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:35:32.894092 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:35:32.894504 [debug] [Thread-1 (]: On model.frontier_analytics.int_crm__opportunities_expanded: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_crm__opportunities_expanded"} */

  create view "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded__dbt_tmp"
    
    
  as (
    with opportunities as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities"

),

users as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_crm__users"

),

companies as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_crm__companies"

),

captions as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions"

),

-- Build arrays for SBU, OEM, topline, bottomline
-- This mirrors your original view's array construction
base as (

    select
        o.opportunity_id,
        o.company_id,
        o.assigned_user_id,
        o.created_by_user_id,
        o.opened_at,
        o.target_close_date,
        o.updated_at,
        o.stage,
        o.certainty,
        o.segment,
        o.quantity,
        o.opportunity_type,
        o.services_subcategory,
        o.is_mustwin,
        o.is_vp_visit,
        o.vp_visit_remark,

        -- Assigned user details
        assigned_user.full_name      as assigned_user_name,
        assigned_user.employee_id    as assigned_employee_id,

        -- Created by user
        created_user.full_name       as created_by_name,

        -- Company details
        c.company_name,
        c.sector_code,
        c.block_code                 as company_block_code,

        -- Block name from captions
        block_cap.caption_value      as block_name,

        -- Vertical from captions
        vertical_cap.caption_value   as vertical,

        -- Solution architect from captions
        sa_cap.caption_value         as solution_architect,

        -- KAM from primary user of company
        kam_user.full_name           as kam_name,
        kam_user.employee_id         as kam_id,

        -- Certainty bucket
        case
            when o.certainty <= 90 then '<90'
            when o.certainty > 90  then '>90'
            else o.certainty::text
        end as certainty_bucket,

        -- Opportunity age in days
        current_date - o.opened_at::date as opportunity_age_days,

        -- Arrays for multi-SBU and multi-OEM expansion
        array[
            sbu1.caption_value,
            sbu2.caption_value,
            sbu3.caption_value,
            sbu4.caption_value
        ] as sbu_array,

        array[
            oem0.caption_value,
            oem1.caption_value,
            oem2.caption_value,
            oem3.caption_value
        ] as oem_array,

        array[
            round(o.forecast_topline, 2),
            round(o.topline_1, 2),
            round(o.topline_2, 2),
            round(o.topline_3, 2)
        ] as topline_array,

        array[
            round(o.forecast_bottomline, 2),
            round(o.bottomline_1, 2),
            round(o.bottomline_2, 2),
            round(o.bottomline_3, 2)
        ] as bottomline_array

    from opportunities o

    -- Assigned user
    left join users assigned_user
        on o.assigned_user_id = assigned_user.user_id

    -- Created by user
    left join users created_user
        on o.created_by_user_id = created_user.user_id

    -- KAM from company primary user
    left join companies c
        on o.company_id = c.company_id
    left join users kam_user
        on c.primary_user_id = kam_user.user_id

    -- Block name
    left join captions block_cap
        on c.block_code::text = block_cap.caption_code::text
        and block_cap.caption_family = 'oppo_principle'

    -- Vertical
    left join captions vertical_cap
        on c.sector_code::text = vertical_cap.caption_code::text

    -- Solution architect
    left join captions sa_cap
        on o.solution_architect_code::text = sa_cap.caption_code::text

    -- SBU captions
    left join captions sbu1
        on o.sbu_1_id = sbu1.caption_code::integer
        and sbu1.caption_family = 'Channels'
    left join captions sbu2
        on o.sbu_2_id = sbu2.caption_code::integer
        and sbu2.caption_family = 'Channels'
    left join captions sbu3
        on o.sbu_3_id = sbu3.caption_code::integer
        and sbu3.caption_family = 'Channels'
    left join captions sbu4
        on o.assigned_user_id = sbu4.caption_code::integer
        and sbu4.caption_family = 'Channels'

    -- OEM captions
    left join captions oem0
        on o.oem_principle::text = oem0.caption_code::text
        and oem0.caption_family = 'oppo_principle'
    left join captions oem1
        on o.oem_1::text = oem1.caption_code::text
        and oem1.caption_family = 'oppo_principle'
    left join captions oem2
        on o.oem_2::text = oem2.caption_code::text
        and oem2.caption_family = 'oppo_principle'
    left join captions oem3
        on o.oem_3::text = oem3.caption_code::text
        and oem3.caption_family = 'oppo_principle'

    -- Financial year filter - dynamic current FY
    where o.target_close_date > case
        when extract(month from current_date) >= 4
            then (extract(year from current_date)::text || '-04-01')::date
        else ((extract(year from current_date) - 1)::text || '-04-01')::date
    end

),

-- Unnest arrays - one row per SBU/OEM combination
-- This is the CROSS JOIN LATERAL unnest logic from your original view
expanded as (

    select
        b.opportunity_id,
        b.company_id,
        b.assigned_user_id,
        b.assigned_user_name,
        b.assigned_employee_id,
        b.created_by_name,
        b.opened_at::date               as open_date,
        to_char(b.opened_at, 'FMMonth') as open_month,
        b.target_close_date::date       as close_date,
        to_char(b.target_close_date, 'FMMonth') as close_month,
        b.updated_at,
        b.stage,
        b.certainty,
        b.certainty_bucket,
        b.segment,
        b.quantity,
        b.opportunity_type,
        b.services_subcategory,
        b.is_mustwin,
        b.is_vp_visit,
        b.vp_visit_remark,
        b.company_name,
        b.vertical,
        b.block_name,
        b.solution_architect,
        b.kam_name,
        b.kam_id,
        b.opportunity_age_days,
        b.sbu_array[u.idx + 1]          as sbu,
        b.oem_array[u.idx + 1]          as oem,
        b.topline_array[u.idx + 1]      as topline,
        b.bottomline_array[u.idx + 1]   as bottomline

    from base b
    cross join lateral (
        select unnest(array[0,1,2,3]) as idx
    ) u

    -- Only keep rows where bottomline is non-zero
    where b.bottomline_array[u.idx + 1] <> 0

)

select distinct * from expanded
  );
[0m12:35:32.894847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:33.052982 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.158 seconds
[0m12:35:33.057054 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:35:33.057359 [debug] [Thread-1 (]: On model.frontier_analytics.int_crm__opportunities_expanded: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_crm__opportunities_expanded"} */
alter table "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded__dbt_tmp" rename to "int_crm__opportunities_expanded"
[0m12:35:33.062464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:35:33.072098 [debug] [Thread-1 (]: On model.frontier_analytics.int_crm__opportunities_expanded: COMMIT
[0m12:35:33.072502 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:35:33.072793 [debug] [Thread-1 (]: On model.frontier_analytics.int_crm__opportunities_expanded: COMMIT
[0m12:35:33.077532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:35:33.081383 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded__dbt_backup"
[0m12:35:33.085534 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:35:33.085912 [debug] [Thread-1 (]: On model.frontier_analytics.int_crm__opportunities_expanded: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_crm__opportunities_expanded"} */
drop view if exists "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded__dbt_backup" cascade
[0m12:35:33.088695 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:35:33.090382 [debug] [Thread-1 (]: On model.frontier_analytics.int_crm__opportunities_expanded: Close
[0m12:35:33.092151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fcb70c7-2e37-407f-9143-676026f454e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8631f140>]}
[0m12:35:33.092711 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dev_intermediate.int_crm__opportunities_expanded  [[32mCREATE VIEW[0m in 0.23s]
[0m12:35:33.093736 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:35:33.095495 [debug] [MainThread]: On master: COMMIT
[0m12:35:33.095767 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:33.095950 [debug] [MainThread]: On master: COMMIT
[0m12:35:33.096130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:33.267241 [debug] [MainThread]: SQL status: COMMIT in 0.171 seconds
[0m12:35:33.267635 [debug] [MainThread]: On master: Close
[0m12:35:33.268020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:33.268221 [debug] [MainThread]: Connection 'model.frontier_analytics.int_crm__opportunities_expanded' was properly closed.
[0m12:35:33.268412 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_intermediate' was properly closed.
[0m12:35:33.268641 [info ] [MainThread]: 
[0m12:35:33.268953 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m12:35:33.269455 [debug] [MainThread]: Command end result
[0m12:35:33.336291 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:35:33.337799 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:35:33.341787 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:35:33.342022 [info ] [MainThread]: 
[0m12:35:33.342308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:33.342536 [info ] [MainThread]: 
[0m12:35:33.343130 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:35:33.345404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6340163, "process_in_blocks": "92248", "process_kernel_time": 0.37516, "process_mem_max_rss": "130348", "process_out_blocks": "3256", "process_user_time": 1.763743}
[0m12:35:33.345894 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:33.345795 after 1.63 seconds
[0m12:35:33.346186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8fda4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec934bb320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8645baa0>]}
[0m12:35:33.346461 [debug] [MainThread]: Flushing usage events
[0m12:35:34.280817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:00.344124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919e0f5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919e11e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919e0f61b0>]}


============================== 12:38:00.348502 | a4c84d3f-ef3a-450a-8a33-4eedd41df0e4 ==============================
[0m12:38:00.348502 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:38:00.348947 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'debug': 'False', 'profiles_dir': '/home/suraj/.dbt', 'fail_fast': 'False', 'invocation_command': 'dbt run --select marts', 'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'empty': 'False', 'log_format': 'default', 'partial_parse': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/home/suraj/frontier_analytics/logs', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'send_anonymous_usage_stats': 'True'}
[0m12:38:00.506560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4c84d3f-ef3a-450a-8a33-4eedd41df0e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919cd0b560>]}
[0m12:38:00.552428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4c84d3f-ef3a-450a-8a33-4eedd41df0e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919e59f3e0>]}
[0m12:38:00.553872 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:38:00.598691 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:38:00.696452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:38:00.697019 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/marts/mart_sap__sales_orders.sql
[0m12:38:00.697298 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/marts/mart_crm__pipeline.sql
[0m12:38:00.894562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4c84d3f-ef3a-450a-8a33-4eedd41df0e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919b5d3e30>]}
[0m12:38:00.945261 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:38:00.947258 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:38:00.966943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4c84d3f-ef3a-450a-8a33-4eedd41df0e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919b57af00>]}
[0m12:38:00.967389 [info ] [MainThread]: Found 14 models, 16 sources, 466 macros
[0m12:38:00.967715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4c84d3f-ef3a-450a-8a33-4eedd41df0e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a017a900>]}
[0m12:38:00.969312 [info ] [MainThread]: 
[0m12:38:00.969847 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:00.970110 [info ] [MainThread]: 
[0m12:38:00.970525 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:38:00.973619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m12:38:01.003571 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m12:38:01.003998 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m12:38:01.004383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:01.095834 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.091 seconds
[0m12:38:01.097035 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m12:38:01.097978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now create_FBS_DB_dbt_dev_marts)
[0m12:38:01.098426 [debug] [ThreadPool]: Creating schema "database: "FBS_DB"
schema: "dbt_dev_marts"
"
[0m12:38:01.102464 [debug] [ThreadPool]: Using postgres connection "create_FBS_DB_dbt_dev_marts"
[0m12:38:01.102928 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "create_FBS_DB_dbt_dev_marts"} */
create schema if not exists "dbt_dev_marts"
[0m12:38:01.103265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:01.180170 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.077 seconds
[0m12:38:01.181133 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_marts: COMMIT
[0m12:38:01.181452 [debug] [ThreadPool]: Using postgres connection "create_FBS_DB_dbt_dev_marts"
[0m12:38:01.181808 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_marts: COMMIT
[0m12:38:01.188621 [debug] [ThreadPool]: SQL status: COMMIT in 0.007 seconds
[0m12:38:01.189023 [debug] [ThreadPool]: On create_FBS_DB_dbt_dev_marts: Close
[0m12:38:01.190843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_FBS_DB_dbt_dev_marts, now list_FBS_DB_dbt_dev_staging)
[0m12:38:01.194429 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:38:01.194738 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:38:01.194972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:01.195459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:38:01.197622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_marts'
[0m12:38:01.199879 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:38:01.201873 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:38:01.202375 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:38:01.202743 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:38:01.203156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:01.203501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:01.277619 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.074 seconds
[0m12:38:01.278989 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:38:01.281470 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:38:01.367640 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.173 seconds
[0m12:38:01.368690 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:38:01.376156 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.173 seconds
[0m12:38:01.377256 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:38:01.377580 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:38:01.380258 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:38:01.384827 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:01.385205 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:38:01.385466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:01.464522 [debug] [MainThread]: SQL status: SELECT 90 in 0.079 seconds
[0m12:38:01.467806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4c84d3f-ef3a-450a-8a33-4eedd41df0e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9198c11850>]}
[0m12:38:01.468203 [debug] [MainThread]: On master: ROLLBACK
[0m12:38:01.470387 [debug] [MainThread]: On master: COMMIT
[0m12:38:01.470670 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:01.470886 [debug] [MainThread]: On master: COMMIT
[0m12:38:01.475934 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m12:38:01.476242 [debug] [MainThread]: On master: Close
[0m12:38:01.481949 [debug] [Thread-1 (]: Began running node model.frontier_analytics.mart_crm__pipeline
[0m12:38:01.482601 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dev_marts.mart_crm__pipeline .................. [RUN]
[0m12:38:01.483123 [debug] [Thread-2 (]: Began running node model.frontier_analytics.mart_sap__sales_orders
[0m12:38:01.483644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_intermediate, now model.frontier_analytics.mart_crm__pipeline)
[0m12:38:01.484360 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_dev_marts.mart_sap__sales_orders .............. [RUN]
[0m12:38:01.484822 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.mart_crm__pipeline
[0m12:38:01.485466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.mart_sap__sales_orders)
[0m12:38:01.491486 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.mart_crm__pipeline"
[0m12:38:01.492035 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.mart_sap__sales_orders
[0m12:38:01.495809 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.mart_sap__sales_orders"
[0m12:38:01.497210 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.mart_crm__pipeline
[0m12:38:01.515407 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.mart_sap__sales_orders
[0m12:38:01.584593 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.mart_sap__sales_orders"
[0m12:38:01.585292 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.mart_crm__pipeline"
[0m12:38:01.588582 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:38:01.588912 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_sap__sales_orders"} */

  
    

  create  table "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined"

),

sbu_mapping as (

    select * from "FBS_DB"."Excel_Data"."SBU_Name_Master"

),

account_type as (

    select * from "FBS_DB"."Excel_Data"."SAP_Account_Type_Mapping"

),

sbu_target as (

    select * from "FBS_DB"."Excel_Data"."SBU_Target"

),

-- Apply SBU name standardization and account type mapping
-- Mirror your original view's final SELECT with CASE for SBU name
final as (

    select distinct
        o.order_number              as so_number,
        o.comments                  as orn,
        o.order_id,
        o.order_date,
        o.order_month,
        o.margin,
        coalesce(sbu.\"SBU Name\", o.sbu_code) as sbu,
        o.kam_name,
        o.block_name                as block,
        o.order_type,
        o.subcategory,
        o.customer_name,
        o.sharing_type,
        o.financial_quarter,
        o.month_name,
        o.ld_cost,
        o.employee_id,
        at.\"Final Ac Type\"        as account_type,
        st.\"Region\"               as region

    from orders o

    -- SBU name standardization
    left join sbu_mapping sbu
        on o.sbu_code = sbu.\"PrcName\"

    -- Account type mapping
    left join account_type at
        on o.customer_group_code = at.\"SAP\"

    -- Region from SBU target via block
    left join sbu_target st
        on o.block_name = st.\"Block\"

    -- Current financial year filter
    where o.order_date >= case
        when extract(month from current_date) >= 4
            then (extract(year from current_date)::text || '-04-01')::date
        else ((extract(year from current_date) - 1)::text || '-04-01')::date
    end

    order by o.order_number

)

select * from final
  );
  
[0m12:38:01.589220 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:38:01.589664 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:38:01.589972 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */

  
    

  create  table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_tmp"
  
  
    as
  
  (
    with opportunities as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded"

),

account_type as (

    select * from "FBS_DB"."Excel_Data"."CRM_Account_Type_Mapping"

),

sbu_target as (

    select * from "FBS_DB"."Excel_Data"."SBU_Target"

),

final as (

    select distinct
        o.opportunity_id,
        o.company_id,
        o.open_date,
        o.open_month,
        o.close_date,
        o.close_month,
        o.assigned_user_name        as opportunity_assigned_user,
        o.assigned_employee_id      as empl_id,
        o.kam_name,
        o.kam_id,
        o.block_name                as block,
        o.stage,
        o.certainty,
        o.certainty_bucket,
        o.segment                   as category,
        o.company_name,
        o.vertical,
        o.sbu,
        o.oem,
        o.quantity,
        o.topline,
        o.bottomline,
        o.opportunity_age_days      as opportunity_age,
        o.opportunity_type          as tender,
        o.services_subcategory,
        o.solution_architect,
        o.is_mustwin,
        o.is_vp_visit,
        o.vp_visit_remark           as remark,
        o.created_by_name           as opportunity_created_by,
        o.updated_at                as last_modify_date,
        coalesce(at.\"Final Ac Type\", 'OTHER') as final_ac_type,
        st.\"Region\"               as region,
        st.\"Block Head\"           as block_head

    from opportunities o

    left join account_type at
        on o.segment::text = at.\"CRM\"::text

    left join sbu_target st
        on o.block_name = st.\"Block\"::text

)

select * from final
  );
  
[0m12:38:01.590261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:01.667254 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "\"
LINE 47:         coalesce(sbu.\"SBU Name\", o.sbu_code) as sbu,
                              ^

[0m12:38:01.667664 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: ROLLBACK
[0m12:38:01.668099 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "\"
LINE 64:         coalesce(at.\"Final Ac Type\", 'OTHER') as final_ac_...
                             ^

[0m12:38:01.668396 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: ROLLBACK
[0m12:38:01.669778 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: Close
[0m12:38:01.670792 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: Close
[0m12:38:01.680790 [debug] [Thread-2 (]: Database Error in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)
  syntax error at or near "\"
  LINE 47:         coalesce(sbu.\"SBU Name\", o.sbu_code) as sbu,
                                ^
  compiled code at target/run/frontier_analytics/models/marts/mart_sap__sales_orders.sql
[0m12:38:01.681729 [debug] [Thread-1 (]: Database Error in model mart_crm__pipeline (models/marts/mart_crm__pipeline.sql)
  syntax error at or near "\"
  LINE 64:         coalesce(at.\"Final Ac Type\", 'OTHER') as final_ac_...
                               ^
  compiled code at target/run/frontier_analytics/models/marts/mart_crm__pipeline.sql
[0m12:38:01.683436 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c84d3f-ef3a-450a-8a33-4eedd41df0e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919e5c4bc0>]}
[0m12:38:01.683735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c84d3f-ef3a-450a-8a33-4eedd41df0e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919e5f5f40>]}
[0m12:38:01.684211 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model dbt_dev_marts.mart_sap__sales_orders ..... [[31mERROR[0m in 0.20s]
[0m12:38:01.684769 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_dev_marts.mart_crm__pipeline ......... [[31mERROR[0m in 0.20s]
[0m12:38:01.685305 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.mart_sap__sales_orders
[0m12:38:01.685723 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.mart_crm__pipeline
[0m12:38:01.686188 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.mart_sap__sales_orders' to be skipped because of status 'error'.  Reason: Database Error in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)
  syntax error at or near "\"
  LINE 47:         coalesce(sbu.\"SBU Name\", o.sbu_code) as sbu,
                                ^
  compiled code at target/run/frontier_analytics/models/marts/mart_sap__sales_orders.sql.
[0m12:38:01.687507 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.mart_crm__pipeline' to be skipped because of status 'error'.  Reason: Database Error in model mart_crm__pipeline (models/marts/mart_crm__pipeline.sql)
  syntax error at or near "\"
  LINE 64:         coalesce(at.\"Final Ac Type\", 'OTHER') as final_ac_...
                               ^
  compiled code at target/run/frontier_analytics/models/marts/mart_crm__pipeline.sql.
[0m12:38:01.688965 [debug] [MainThread]: On master: COMMIT
[0m12:38:01.689221 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:01.689487 [debug] [MainThread]: On master: COMMIT
[0m12:38:01.689688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:01.753328 [debug] [MainThread]: SQL status: COMMIT in 0.064 seconds
[0m12:38:01.753776 [debug] [MainThread]: On master: Close
[0m12:38:01.754136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:01.754349 [debug] [MainThread]: Connection 'model.frontier_analytics.mart_sap__sales_orders' was properly closed.
[0m12:38:01.754525 [debug] [MainThread]: Connection 'model.frontier_analytics.mart_crm__pipeline' was properly closed.
[0m12:38:01.754699 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_marts' was properly closed.
[0m12:38:01.754967 [info ] [MainThread]: 
[0m12:38:01.755340 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m12:38:01.755984 [debug] [MainThread]: Command end result
[0m12:38:01.771073 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:38:01.773006 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:38:01.778557 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:38:01.778911 [info ] [MainThread]: 
[0m12:38:01.779254 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:38:01.779527 [info ] [MainThread]: 
[0m12:38:01.779828 [error] [MainThread]: [31mFailure in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)[0m
[0m12:38:01.780088 [error] [MainThread]:   Database Error in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)
  syntax error at or near "\"
  LINE 47:         coalesce(sbu.\"SBU Name\", o.sbu_code) as sbu,
                                ^
  compiled code at target/run/frontier_analytics/models/marts/mart_sap__sales_orders.sql
[0m12:38:01.780288 [info ] [MainThread]: 
[0m12:38:01.780522 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/marts/mart_sap__sales_orders.sql
[0m12:38:01.780725 [info ] [MainThread]: 
[0m12:38:01.780976 [error] [MainThread]: [31mFailure in model mart_crm__pipeline (models/marts/mart_crm__pipeline.sql)[0m
[0m12:38:01.781230 [error] [MainThread]:   Database Error in model mart_crm__pipeline (models/marts/mart_crm__pipeline.sql)
  syntax error at or near "\"
  LINE 64:         coalesce(at.\"Final Ac Type\", 'OTHER') as final_ac_...
                               ^
  compiled code at target/run/frontier_analytics/models/marts/mart_crm__pipeline.sql
[0m12:38:01.781443 [info ] [MainThread]: 
[0m12:38:01.781674 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/marts/mart_crm__pipeline.sql
[0m12:38:01.781861 [info ] [MainThread]: 
[0m12:38:01.782076 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m12:38:01.783390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4860305, "process_in_blocks": "90888", "process_kernel_time": 0.265749, "process_mem_max_rss": "129156", "process_out_blocks": "3312", "process_user_time": 1.746357}
[0m12:38:01.783761 [debug] [MainThread]: Command `dbt run` failed at 12:38:01.783681 after 1.49 seconds
[0m12:38:01.784036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919e279f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919df64fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919f433980>]}
[0m12:38:01.784320 [debug] [MainThread]: Flushing usage events
[0m12:38:02.759858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:53.840738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162b68a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162b209f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162ae7fc80>]}


============================== 12:43:53.846819 | 817f246b-3186-410a-8427-76e96c7565f5 ==============================
[0m12:43:53.846819 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:43:53.847310 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_experimental_parser': 'False', 'log_path': '/home/suraj/frontier_analytics/logs', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --select marts', 'profiles_dir': '/home/suraj/.dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'static_parser': 'True', 'empty': 'False', 'target_path': 'None'}
[0m12:43:54.003317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '817f246b-3186-410a-8427-76e96c7565f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162a7ef980>]}
[0m12:43:54.047737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '817f246b-3186-410a-8427-76e96c7565f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162ab8f0e0>]}
[0m12:43:54.048821 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:43:54.093635 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:43:54.187821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:43:54.188424 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/marts/mart_sap__sales_orders.sql
[0m12:43:54.188748 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/marts/mart_crm__pipeline.sql
[0m12:43:54.378412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '817f246b-3186-410a-8427-76e96c7565f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16283cff50>]}
[0m12:43:54.428119 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:43:54.430178 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:43:54.452898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '817f246b-3186-410a-8427-76e96c7565f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162837ea80>]}
[0m12:43:54.453428 [info ] [MainThread]: Found 14 models, 16 sources, 466 macros
[0m12:43:54.453758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817f246b-3186-410a-8427-76e96c7565f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1628b843e0>]}
[0m12:43:54.455142 [info ] [MainThread]: 
[0m12:43:54.455512 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:54.455740 [info ] [MainThread]: 
[0m12:43:54.456106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:54.459022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m12:43:54.496411 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m12:43:54.496780 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m12:43:54.497032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:54.581079 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.084 seconds
[0m12:43:54.582386 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m12:43:54.584798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m12:43:54.585634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_marts'
[0m12:43:54.590103 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:43:54.590925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:43:54.592286 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:43:54.592903 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:43:54.593945 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:43:54.594355 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:43:54.594648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:54.595013 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:43:54.595424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:54.595879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:54.682431 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.087 seconds
[0m12:43:54.683722 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:43:54.685451 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.091 seconds
[0m12:43:54.686515 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:43:54.687005 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:43:54.687315 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.091 seconds
[0m12:43:54.688462 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:43:54.688971 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:43:54.690289 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:43:54.694550 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:54.694889 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:43:54.695139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:54.769929 [debug] [MainThread]: SQL status: SELECT 90 in 0.075 seconds
[0m12:43:54.772934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817f246b-3186-410a-8427-76e96c7565f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1629704b60>]}
[0m12:43:54.773269 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:54.775420 [debug] [MainThread]: On master: COMMIT
[0m12:43:54.775694 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:54.775913 [debug] [MainThread]: On master: COMMIT
[0m12:43:54.782319 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m12:43:54.782811 [debug] [MainThread]: On master: Close
[0m12:43:54.788023 [debug] [Thread-1 (]: Began running node model.frontier_analytics.mart_crm__pipeline
[0m12:43:54.788763 [debug] [Thread-2 (]: Began running node model.frontier_analytics.mart_sap__sales_orders
[0m12:43:54.788464 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dev_marts.mart_crm__pipeline .................. [RUN]
[0m12:43:54.789797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_intermediate, now model.frontier_analytics.mart_crm__pipeline)
[0m12:43:54.790128 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.mart_crm__pipeline
[0m12:43:54.789173 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_dev_marts.mart_sap__sales_orders .............. [RUN]
[0m12:43:54.796384 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.mart_crm__pipeline"
[0m12:43:54.797082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.mart_sap__sales_orders)
[0m12:43:54.798003 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.mart_sap__sales_orders
[0m12:43:54.800959 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.mart_sap__sales_orders"
[0m12:43:54.801661 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.mart_sap__sales_orders
[0m12:43:54.802029 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.mart_crm__pipeline
[0m12:43:54.837157 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.mart_sap__sales_orders"
[0m12:43:54.838715 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.mart_crm__pipeline"
[0m12:43:54.839180 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:43:54.839525 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_sap__sales_orders"} */

  
    

  create  table "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined"

),

sbu_mapping as (

    select * from "FBS_DB"."Excel_Data"."SBU_Name_Master"

),

account_type as (

    select * from "FBS_DB"."Excel_Data"."SAP_Account_Type_Mapping"

),

sbu_target as (

    select * from "FBS_DB"."Excel_Data"."SBU_Target"

),

final as (

    select distinct
        o.order_number              as so_number,
        o.comments                  as orn,
        o.order_id,
        o.order_date,
        o.order_month,
        o.margin,
        coalesce(sbu."SBU Name", o.sbu_code) as sbu,
        o.kam_name,
        o.block_name                as block,
        o.order_type,
        o.subcategory,
        o.customer_name,
        o.sharing_type,
        o.financial_quarter,
        o.month_name,
        o.ld_cost,
        o.employee_id,
        at."Final Ac Type"          as account_type,
        st."Region"                 as region

    from orders o

    left join sbu_mapping sbu
        on o.sbu_code = sbu."PrcName"

    left join account_type at
        on o.customer_group_code = at."SAP"

    left join sbu_target st
        on o.block_name = st."Block"

    where o.order_date >= case
        when extract(month from current_date) >= 4
            then (extract(year from current_date)::text || '-04-01')::date
        else ((extract(year from current_date) - 1)::text || '-04-01')::date
    end

    order by o.order_number

)

select * from final
  );
  
[0m12:43:54.839810 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:54.840313 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:43:54.840614 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */

  
    

  create  table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_tmp"
  
  
    as
  
  (
    with opportunities as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded"

),

account_type as (

    select * from "FBS_DB"."Excel_Data"."CRM_Account_Type_Mapping"

),

sbu_target as (

    select * from "FBS_DB"."Excel_Data"."SBU_Target"

),

final as (

    select distinct
        o.opportunity_id,
        o.company_id,
        o.open_date,
        o.open_month,
        o.close_date,
        o.close_month,
        o.assigned_user_name        as opportunity_assigned_user,
        o.assigned_employee_id      as empl_id,
        o.kam_name,
        o.kam_id,
        o.block_name                as block,
        o.stage,
        o.certainty,
        o.certainty_bucket,
        o.segment                   as category,
        o.company_name,
        o.vertical,
        o.sbu,
        o.oem,
        o.quantity,
        o.topline,
        o.bottomline,
        o.opportunity_age_days      as opportunity_age,
        o.opportunity_type          as tender,
        o.services_subcategory,
        o.solution_architect,
        o.is_mustwin,
        o.is_vp_visit,
        o.vp_visit_remark           as remark,
        o.created_by_name           as opportunity_created_by,
        o.updated_at                as last_modify_date,
        coalesce(at."Final Ac Type", 'OTHER') as final_ac_type,
        st."Region"                 as region,
        st."Block Head"             as block_head

    from opportunities o

    left join account_type at
        on o.segment::text = at."CRM"::text

    left join sbu_target st
        on o.block_name = st."Block"::text

)

select * from final
  );
  
[0m12:43:54.840861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:55.015410 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column o.customer_group_code does not exist
LINE 65:         on o.customer_group_code = at."SAP"
                    ^

[0m12:43:55.015930 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: ROLLBACK
[0m12:43:55.019251 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: Close
[0m12:43:55.026768 [debug] [Thread-2 (]: Database Error in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)
  column o.customer_group_code does not exist
  LINE 65:         on o.customer_group_code = at."SAP"
                      ^
  compiled code at target/run/frontier_analytics/models/marts/mart_sap__sales_orders.sql
[0m12:43:55.028471 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817f246b-3186-410a-8427-76e96c7565f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162b6d4ce0>]}
[0m12:43:55.029044 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model dbt_dev_marts.mart_sap__sales_orders ..... [[31mERROR[0m in 0.23s]
[0m12:43:55.029508 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.mart_sap__sales_orders
[0m12:43:55.030260 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.mart_sap__sales_orders' to be skipped because of status 'error'.  Reason: Database Error in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)
  column o.customer_group_code does not exist
  LINE 65:         on o.customer_group_code = at."SAP"
                      ^
  compiled code at target/run/frontier_analytics/models/marts/mart_sap__sales_orders.sql.
[0m12:43:55.355291 [debug] [Thread-1 (]: SQL status: SELECT 6287 in 0.514 seconds
[0m12:43:55.413124 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:43:55.413593 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */
alter table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_tmp" rename to "mart_crm__pipeline"
[0m12:43:55.417175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:43:55.426837 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: COMMIT
[0m12:43:55.427253 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:43:55.427517 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: COMMIT
[0m12:43:55.430751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:55.434445 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_backup"
[0m12:43:55.437662 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:43:55.437960 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */
drop table if exists "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_backup" cascade
[0m12:43:55.443524 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:43:55.445433 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: Close
[0m12:43:55.445937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817f246b-3186-410a-8427-76e96c7565f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1628bb78c0>]}
[0m12:43:55.446456 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_dev_marts.mart_crm__pipeline ............. [[32mSELECT 6287[0m in 0.66s]
[0m12:43:55.446862 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.mart_crm__pipeline
[0m12:43:55.448794 [debug] [MainThread]: On master: COMMIT
[0m12:43:55.449123 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:55.449419 [debug] [MainThread]: On master: COMMIT
[0m12:43:55.449618 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:55.516086 [debug] [MainThread]: SQL status: COMMIT in 0.066 seconds
[0m12:43:55.516488 [debug] [MainThread]: On master: Close
[0m12:43:55.516880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:55.517092 [debug] [MainThread]: Connection 'model.frontier_analytics.mart_sap__sales_orders' was properly closed.
[0m12:43:55.517277 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_marts' was properly closed.
[0m12:43:55.517454 [debug] [MainThread]: Connection 'model.frontier_analytics.mart_crm__pipeline' was properly closed.
[0m12:43:55.517728 [info ] [MainThread]: 
[0m12:43:55.518002 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m12:43:55.518524 [debug] [MainThread]: Command end result
[0m12:43:55.534209 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:43:55.535599 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:43:55.541698 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:43:55.542194 [info ] [MainThread]: 
[0m12:43:55.542735 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:43:55.543277 [info ] [MainThread]: 
[0m12:43:55.543974 [error] [MainThread]: [31mFailure in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)[0m
[0m12:43:55.544526 [error] [MainThread]:   Database Error in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)
  column o.customer_group_code does not exist
  LINE 65:         on o.customer_group_code = at."SAP"
                      ^
  compiled code at target/run/frontier_analytics/models/marts/mart_sap__sales_orders.sql
[0m12:43:55.544807 [info ] [MainThread]: 
[0m12:43:55.545220 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/marts/mart_sap__sales_orders.sql
[0m12:43:55.545498 [info ] [MainThread]: 
[0m12:43:55.545855 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m12:43:55.547140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.750197, "process_in_blocks": "89536", "process_kernel_time": 0.24957, "process_mem_max_rss": "131292", "process_out_blocks": "3304", "process_user_time": 1.819784}
[0m12:43:55.547534 [debug] [MainThread]: Command `dbt run` failed at 12:43:55.547448 after 1.75 seconds
[0m12:43:55.547831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162a9197c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162b6d7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162b6d67e0>]}
[0m12:43:55.548103 [debug] [MainThread]: Flushing usage events
[0m12:43:56.563852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:20.713437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cbbde090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ce0d6d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cd85c200>]}


============================== 12:46:20.718244 | 060a8504-1a37-4b54-ba40-3612dfac1842 ==============================
[0m12:46:20.718244 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:46:20.718781 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/suraj/frontier_analytics/logs', 'profiles_dir': '/home/suraj/.dbt', 'write_json': 'True', 'version_check': 'True', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'introspect': 'True', 'empty': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select marts', 'target_path': 'None', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:46:20.869701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '060a8504-1a37-4b54-ba40-3612dfac1842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cb38a900>]}
[0m12:46:20.916776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '060a8504-1a37-4b54-ba40-3612dfac1842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cf83b350>]}
[0m12:46:20.917800 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:46:20.961255 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:46:21.064960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:46:21.065541 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/intermediate/int_sap__orders_combined.sql
[0m12:46:21.255780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '060a8504-1a37-4b54-ba40-3612dfac1842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c8feba10>]}
[0m12:46:21.301139 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:46:21.302870 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:46:21.324114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '060a8504-1a37-4b54-ba40-3612dfac1842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c939f950>]}
[0m12:46:21.324521 [info ] [MainThread]: Found 14 models, 16 sources, 466 macros
[0m12:46:21.324828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '060a8504-1a37-4b54-ba40-3612dfac1842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c8fcd430>]}
[0m12:46:21.326272 [info ] [MainThread]: 
[0m12:46:21.326650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:46:21.326943 [info ] [MainThread]: 
[0m12:46:21.327335 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:46:21.330401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m12:46:21.356884 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m12:46:21.357465 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m12:46:21.357801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:21.440606 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.083 seconds
[0m12:46:21.441794 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m12:46:21.443869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m12:46:21.445068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:46:21.450479 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:46:21.450989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_marts'
[0m12:46:21.452333 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:46:21.452707 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:46:21.453922 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:46:21.454260 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:46:21.454603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:21.454869 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:46:21.455227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:21.455796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:21.534455 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.079 seconds
[0m12:46:21.535617 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:46:21.536369 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.082 seconds
[0m12:46:21.537156 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:46:21.537709 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:46:21.540168 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:46:21.628993 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.173 seconds
[0m12:46:21.630218 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:46:21.632373 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:46:21.635928 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:21.636217 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:46:21.636455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:46:21.812301 [debug] [MainThread]: SQL status: SELECT 90 in 0.176 seconds
[0m12:46:21.815249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '060a8504-1a37-4b54-ba40-3612dfac1842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ca34bb60>]}
[0m12:46:21.815562 [debug] [MainThread]: On master: ROLLBACK
[0m12:46:21.818567 [debug] [MainThread]: On master: COMMIT
[0m12:46:21.818826 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:21.819032 [debug] [MainThread]: On master: COMMIT
[0m12:46:21.823868 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m12:46:21.824240 [debug] [MainThread]: On master: Close
[0m12:46:21.829001 [debug] [Thread-1 (]: Began running node model.frontier_analytics.mart_crm__pipeline
[0m12:46:21.829374 [debug] [Thread-2 (]: Began running node model.frontier_analytics.mart_sap__sales_orders
[0m12:46:21.829762 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dev_marts.mart_crm__pipeline .................. [RUN]
[0m12:46:21.830237 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_dev_marts.mart_sap__sales_orders .............. [RUN]
[0m12:46:21.830804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_marts, now model.frontier_analytics.mart_crm__pipeline)
[0m12:46:21.831482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.mart_sap__sales_orders)
[0m12:46:21.831811 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.mart_crm__pipeline
[0m12:46:21.832109 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.mart_sap__sales_orders
[0m12:46:21.839080 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.mart_crm__pipeline"
[0m12:46:21.841632 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.mart_sap__sales_orders"
[0m12:46:21.842464 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.mart_crm__pipeline
[0m12:46:21.853361 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.mart_sap__sales_orders
[0m12:46:21.874355 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.mart_sap__sales_orders"
[0m12:46:21.874937 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.mart_crm__pipeline"
[0m12:46:21.875490 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:46:21.875790 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */

  
    

  create  table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_tmp"
  
  
    as
  
  (
    with opportunities as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded"

),

account_type as (

    select * from "FBS_DB"."Excel_Data"."CRM_Account_Type_Mapping"

),

sbu_target as (

    select * from "FBS_DB"."Excel_Data"."SBU_Target"

),

final as (

    select distinct
        o.opportunity_id,
        o.company_id,
        o.open_date,
        o.open_month,
        o.close_date,
        o.close_month,
        o.assigned_user_name        as opportunity_assigned_user,
        o.assigned_employee_id      as empl_id,
        o.kam_name,
        o.kam_id,
        o.block_name                as block,
        o.stage,
        o.certainty,
        o.certainty_bucket,
        o.segment                   as category,
        o.company_name,
        o.vertical,
        o.sbu,
        o.oem,
        o.quantity,
        o.topline,
        o.bottomline,
        o.opportunity_age_days      as opportunity_age,
        o.opportunity_type          as tender,
        o.services_subcategory,
        o.solution_architect,
        o.is_mustwin,
        o.is_vp_visit,
        o.vp_visit_remark           as remark,
        o.created_by_name           as opportunity_created_by,
        o.updated_at                as last_modify_date,
        coalesce(at."Final Ac Type", 'OTHER') as final_ac_type,
        st."Region"                 as region,
        st."Block Head"             as block_head

    from opportunities o

    left join account_type at
        on o.segment::text = at."CRM"::text

    left join sbu_target st
        on o.block_name = st."Block"::text

)

select * from final
  );
  
[0m12:46:21.876075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:21.876768 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:46:21.877067 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_sap__sales_orders"} */

  
    

  create  table "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined"

),

sbu_mapping as (

    select * from "FBS_DB"."Excel_Data"."SBU_Name_Master"

),

account_type as (

    select * from "FBS_DB"."Excel_Data"."SAP_Account_Type_Mapping"

),

sbu_target as (

    select * from "FBS_DB"."Excel_Data"."SBU_Target"

),

final as (

    select distinct
        o.order_number              as so_number,
        o.comments                  as orn,
        o.order_id,
        o.order_date,
        o.order_month,
        o.margin,
        coalesce(sbu."SBU Name", o.sbu_code) as sbu,
        o.kam_name,
        o.block_name                as block,
        o.order_type,
        o.subcategory,
        o.customer_name,
        o.sharing_type,
        o.financial_quarter,
        o.month_name,
        o.ld_cost,
        o.employee_id,
        at."Final Ac Type"          as account_type,
        st."Region"                 as region

    from orders o

    left join sbu_mapping sbu
        on o.sbu_code = sbu."PrcName"

    left join account_type at
        on o.customer_group_code = at."SAP"

    left join sbu_target st
        on o.block_name = st."Block"

    where o.order_date >= case
        when extract(month from current_date) >= 4
            then (extract(year from current_date)::text || '-04-01')::date
        else ((extract(year from current_date) - 1)::text || '-04-01')::date
    end

    order by o.order_number

)

select * from final
  );
  
[0m12:46:21.877353 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:46:21.952086 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column o.customer_group_code does not exist
LINE 65:         on o.customer_group_code = at."SAP"
                    ^

[0m12:46:21.952557 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: ROLLBACK
[0m12:46:21.955072 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: Close
[0m12:46:21.962419 [debug] [Thread-2 (]: Database Error in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)
  column o.customer_group_code does not exist
  LINE 65:         on o.customer_group_code = at."SAP"
                      ^
  compiled code at target/run/frontier_analytics/models/marts/mart_sap__sales_orders.sql
[0m12:46:21.963891 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '060a8504-1a37-4b54-ba40-3612dfac1842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c9f9c2f0>]}
[0m12:46:21.964395 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model dbt_dev_marts.mart_sap__sales_orders ..... [[31mERROR[0m in 0.13s]
[0m12:46:21.964830 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.mart_sap__sales_orders
[0m12:46:21.965270 [debug] [Thread-7 (]: Marking all children of 'model.frontier_analytics.mart_sap__sales_orders' to be skipped because of status 'error'.  Reason: Database Error in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)
  column o.customer_group_code does not exist
  LINE 65:         on o.customer_group_code = at."SAP"
                      ^
  compiled code at target/run/frontier_analytics/models/marts/mart_sap__sales_orders.sql.
[0m12:46:22.407998 [debug] [Thread-1 (]: SQL status: SELECT 6287 in 0.532 seconds
[0m12:46:22.466180 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:46:22.466579 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */
alter table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline" rename to "mart_crm__pipeline__dbt_backup"
[0m12:46:22.470910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:46:22.472799 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:46:22.473078 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */
alter table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_tmp" rename to "mart_crm__pipeline"
[0m12:46:22.476194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:46:22.486751 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: COMMIT
[0m12:46:22.487147 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:46:22.487399 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: COMMIT
[0m12:46:22.496588 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m12:46:22.500823 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_backup"
[0m12:46:22.503976 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:46:22.504599 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */
drop table if exists "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_backup" cascade
[0m12:46:22.536392 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.031 seconds
[0m12:46:22.538374 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: Close
[0m12:46:22.538912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '060a8504-1a37-4b54-ba40-3612dfac1842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c18374d0>]}
[0m12:46:22.539407 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_dev_marts.mart_crm__pipeline ............. [[32mSELECT 6287[0m in 0.71s]
[0m12:46:22.539877 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.mart_crm__pipeline
[0m12:46:22.541845 [debug] [MainThread]: On master: COMMIT
[0m12:46:22.542419 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:22.542677 [debug] [MainThread]: On master: COMMIT
[0m12:46:22.542894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:46:22.617200 [debug] [MainThread]: SQL status: COMMIT in 0.074 seconds
[0m12:46:22.617563 [debug] [MainThread]: On master: Close
[0m12:46:22.617936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:22.618140 [debug] [MainThread]: Connection 'model.frontier_analytics.mart_sap__sales_orders' was properly closed.
[0m12:46:22.618311 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_intermediate' was properly closed.
[0m12:46:22.618506 [debug] [MainThread]: Connection 'model.frontier_analytics.mart_crm__pipeline' was properly closed.
[0m12:46:22.618772 [info ] [MainThread]: 
[0m12:46:22.619029 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m12:46:22.619625 [debug] [MainThread]: Command end result
[0m12:46:22.636169 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:46:22.637632 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:46:22.641691 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:46:22.641994 [info ] [MainThread]: 
[0m12:46:22.642295 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:46:22.642536 [info ] [MainThread]: 
[0m12:46:22.642864 [error] [MainThread]: [31mFailure in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)[0m
[0m12:46:22.643184 [error] [MainThread]:   Database Error in model mart_sap__sales_orders (models/marts/mart_sap__sales_orders.sql)
  column o.customer_group_code does not exist
  LINE 65:         on o.customer_group_code = at."SAP"
                      ^
  compiled code at target/run/frontier_analytics/models/marts/mart_sap__sales_orders.sql
[0m12:46:22.643408 [info ] [MainThread]: 
[0m12:46:22.643653 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/marts/mart_sap__sales_orders.sql
[0m12:46:22.643866 [info ] [MainThread]: 
[0m12:46:22.644120 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m12:46:22.645920 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9782007, "process_in_blocks": "92520", "process_kernel_time": 0.193775, "process_mem_max_rss": "133240", "process_out_blocks": "3304", "process_user_time": 1.80211}
[0m12:46:22.646395 [debug] [MainThread]: Command `dbt run` failed at 12:46:22.646294 after 1.98 seconds
[0m12:46:22.646694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cc3427b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32cd85c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ca7beb10>]}
[0m12:46:22.646968 [debug] [MainThread]: Flushing usage events
[0m12:46:23.598510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:24.597122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d54156d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d51204a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d5a83f20>]}


============================== 12:47:24.602827 | 27c6f470-49c8-4f65-abe3-fadce1d3e4ed ==============================
[0m12:47:24.602827 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:47:24.603825 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'cache_selected_only': 'False', 'log_path': '/home/suraj/frontier_analytics/logs', 'fail_fast': 'False', 'invocation_command': 'dbt run --select int_sap__orders_combined', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'profiles_dir': '/home/suraj/.dbt', 'write_json': 'True', 'target_path': 'None', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'empty': 'False', 'log_cache_events': 'False', 'partial_parse': 'True'}
[0m12:47:24.771877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27c6f470-49c8-4f65-abe3-fadce1d3e4ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d4b24da0>]}
[0m12:47:24.822791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27c6f470-49c8-4f65-abe3-fadce1d3e4ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d6f9a780>]}
[0m12:47:24.824277 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:47:24.877855 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:47:24.999261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:24.999703 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:47:24.999933 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:25.029761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27c6f470-49c8-4f65-abe3-fadce1d3e4ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d3778e90>]}
[0m12:47:25.083197 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:47:25.085774 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:47:25.108266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27c6f470-49c8-4f65-abe3-fadce1d3e4ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d2b0c470>]}
[0m12:47:25.108736 [info ] [MainThread]: Found 14 models, 16 sources, 466 macros
[0m12:47:25.109060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27c6f470-49c8-4f65-abe3-fadce1d3e4ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d3779310>]}
[0m12:47:25.111596 [info ] [MainThread]: 
[0m12:47:25.112510 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:47:25.113346 [info ] [MainThread]: 
[0m12:47:25.114482 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:25.116381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m12:47:25.147615 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m12:47:25.148061 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m12:47:25.148322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:25.245436 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.097 seconds
[0m12:47:25.246531 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m12:47:25.250723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m12:47:25.251537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_marts'
[0m12:47:25.252356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:47:25.256622 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:47:25.257956 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:47:25.259103 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:47:25.259545 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:47:25.259928 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:47:25.260311 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:47:25.260671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:25.261013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:25.261331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:25.345732 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.085 seconds
[0m12:47:25.347006 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:47:25.347992 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.087 seconds
[0m12:47:25.348914 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:47:25.349969 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:47:25.354019 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:47:25.442073 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.181 seconds
[0m12:47:25.443177 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:47:25.450012 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:47:25.455207 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:25.455641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:47:25.456067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:25.638355 [debug] [MainThread]: SQL status: SELECT 90 in 0.182 seconds
[0m12:47:25.642168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27c6f470-49c8-4f65-abe3-fadce1d3e4ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d2b07e00>]}
[0m12:47:25.642613 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:25.645339 [debug] [MainThread]: On master: COMMIT
[0m12:47:25.645622 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:25.645843 [debug] [MainThread]: On master: COMMIT
[0m12:47:25.650705 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m12:47:25.650966 [debug] [MainThread]: On master: Close
[0m12:47:25.656155 [debug] [Thread-1 (]: Began running node model.frontier_analytics.int_sap__orders_combined
[0m12:47:25.656617 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_intermediate.int_sap__orders_combined ...... [RUN]
[0m12:47:25.657068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.int_sap__orders_combined)
[0m12:47:25.657339 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.int_sap__orders_combined
[0m12:47:25.663170 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_combined"
[0m12:47:25.664690 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.int_sap__orders_combined
[0m12:47:25.686970 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.int_sap__orders_combined"
[0m12:47:25.687557 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:47:25.687949 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_combined"} */

  create view "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_tmp"
    
    
  as (
    with not_sharing as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_not_sharing"

),

sharing as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing"

),

profit_centres as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres"

),

-- Union both streams together with matching columns
combined as (

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        employee_id,
        kam_profit_centre_code

    from not_sharing

    union all

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        employee_id,
        kam_profit_centre_code

    from sharing

),

-- Join profit centres twice - once for block name, once for KAM name
-- This mirrors your original view joining OPRC twice with different aliases
enriched as (

    select
        c.order_id,
        c.order_number,
        c.order_date,
        c.customer_name,
        c.margin,
        c.sbu_code,
        c.order_type,
        c.ld_cost,
        c.comments,
        c.subcategory,
        c.sharing_type,
        c.employee_id,
        c.customer_group_code,
        block_pc.profit_centre_name   as block_name,
        kam_pc.profit_centre_name     as kam_name,

        -- Indian financial year quarter mapping
        case
            when extract(month from c.order_date) in (4,5,6)   then 'Q1'
            when extract(month from c.order_date) in (7,8,9)   then 'Q2'
            when extract(month from c.order_date) in (10,11,12) then 'Q3'
            when extract(month from c.order_date) in (1,2,3)   then 'Q4'
        end as financial_quarter,

        -- Month name mapping
        case extract(month from c.order_date)
            when 1  then 'January'
            when 2  then 'February'
            when 3  then 'March'
            when 4  then 'April'
            when 5  then 'May'
            when 6  then 'June'
            when 7  then 'July'
            when 8  then 'August'
            when 9  then 'September'
            when 10 then 'October'
            when 11 then 'November'
            when 12 then 'December'
        end as month_name,

        date_trunc('month', c.order_date) as order_month

    from combined c
    left join profit_centres block_pc
        on c.block_code = block_pc.profit_centre_code
    left join profit_centres kam_pc
        on c.kam_profit_centre_code = kam_pc.profit_centre_code

)

select * from enriched
  );
[0m12:47:25.688252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:25.893232 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.205 seconds
[0m12:47:25.898051 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:47:25.898419 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_combined"} */
alter table "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined" rename to "int_sap__orders_combined__dbt_backup"
[0m12:47:25.901978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:47:25.904953 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:47:25.905245 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_combined"} */
alter table "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_tmp" rename to "int_sap__orders_combined"
[0m12:47:25.908751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:47:25.921770 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: COMMIT
[0m12:47:25.922207 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:47:25.922486 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: COMMIT
[0m12:47:25.925930 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:47:25.929693 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_backup"
[0m12:47:25.935397 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:47:25.935815 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_combined"} */
drop view if exists "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_backup" cascade
[0m12:47:25.940738 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:47:25.942353 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_combined: Close
[0m12:47:25.944421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c6f470-49c8-4f65-abe3-fadce1d3e4ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d19724e0>]}
[0m12:47:25.944933 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dev_intermediate.int_sap__orders_combined . [[32mCREATE VIEW[0m in 0.29s]
[0m12:47:25.945385 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.int_sap__orders_combined
[0m12:47:25.947723 [debug] [MainThread]: On master: COMMIT
[0m12:47:25.948186 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:25.948435 [debug] [MainThread]: On master: COMMIT
[0m12:47:25.948623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:26.124958 [debug] [MainThread]: SQL status: COMMIT in 0.176 seconds
[0m12:47:26.125365 [debug] [MainThread]: On master: Close
[0m12:47:26.125768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:26.125978 [debug] [MainThread]: Connection 'model.frontier_analytics.int_sap__orders_combined' was properly closed.
[0m12:47:26.126155 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_marts' was properly closed.
[0m12:47:26.126305 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_intermediate' was properly closed.
[0m12:47:26.126498 [info ] [MainThread]: 
[0m12:47:26.126822 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m12:47:26.127313 [debug] [MainThread]: Command end result
[0m12:47:26.144894 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:47:26.146324 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:47:26.150360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:47:26.150599 [info ] [MainThread]: 
[0m12:47:26.150905 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:26.151129 [info ] [MainThread]: 
[0m12:47:26.151375 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:47:26.152968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6058342, "process_in_blocks": "91760", "process_kernel_time": 0.176723, "process_mem_max_rss": "124572", "process_out_blocks": "2264", "process_user_time": 1.590515}
[0m12:47:26.153382 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:26.153288 after 1.61 seconds
[0m12:47:26.153770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d59fb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d5b25730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2d5b253a0>]}
[0m12:47:26.154110 [debug] [MainThread]: Flushing usage events
[0m12:47:27.156341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:32.149238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aaf8b6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aaf745520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aaf9852b0>]}


============================== 12:47:32.151890 | 2fd0c354-fb9f-42ac-84a7-f28bfc17c2ea ==============================
[0m12:47:32.151890 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:47:32.152376 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'empty': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select marts', 'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/home/suraj/frontier_analytics/logs', 'profiles_dir': '/home/suraj/.dbt', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:47:32.281453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fd0c354-fb9f-42ac-84a7-f28bfc17c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aae6e6540>]}
[0m12:47:32.331374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fd0c354-fb9f-42ac-84a7-f28bfc17c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aaf76d8e0>]}
[0m12:47:32.332223 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:47:32.370568 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:47:32.440593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:32.440957 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:47:32.441173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:32.466889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fd0c354-fb9f-42ac-84a7-f28bfc17c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aae710110>]}
[0m12:47:32.520102 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:47:32.521851 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:47:32.532098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fd0c354-fb9f-42ac-84a7-f28bfc17c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aad314e60>]}
[0m12:47:32.532560 [info ] [MainThread]: Found 14 models, 16 sources, 466 macros
[0m12:47:32.532996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fd0c354-fb9f-42ac-84a7-f28bfc17c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aad30b2c0>]}
[0m12:47:32.534929 [info ] [MainThread]: 
[0m12:47:32.535521 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:47:32.535891 [info ] [MainThread]: 
[0m12:47:32.536324 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:32.539939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m12:47:32.562577 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m12:47:32.562937 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m12:47:32.563174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:32.739632 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.176 seconds
[0m12:47:32.740859 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m12:47:32.742853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_intermediate)
[0m12:47:32.747013 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:47:32.747311 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:47:32.748311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:32.748870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_marts'
[0m12:47:32.749934 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:47:32.750187 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:47:32.750460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:32.751213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_staging'
[0m12:47:32.752776 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:47:32.753052 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:47:32.753289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:32.835624 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.087 seconds
[0m12:47:32.836929 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:47:32.841856 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:47:32.848683 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.098 seconds
[0m12:47:32.849759 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:47:32.852635 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.099 seconds
[0m12:47:32.853725 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:47:32.854215 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:47:32.857464 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:47:32.862616 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:32.863011 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:47:32.863347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:33.043871 [debug] [MainThread]: SQL status: SELECT 90 in 0.180 seconds
[0m12:47:33.048425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fd0c354-fb9f-42ac-84a7-f28bfc17c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aaf00a840>]}
[0m12:47:33.048977 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:33.057644 [debug] [MainThread]: On master: COMMIT
[0m12:47:33.058043 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:33.058298 [debug] [MainThread]: On master: COMMIT
[0m12:47:33.062635 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m12:47:33.063586 [debug] [MainThread]: On master: Close
[0m12:47:33.072278 [debug] [Thread-1 (]: Began running node model.frontier_analytics.mart_crm__pipeline
[0m12:47:33.072876 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dev_marts.mart_crm__pipeline .................. [RUN]
[0m12:47:33.073411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.mart_crm__pipeline)
[0m12:47:33.073771 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.mart_crm__pipeline
[0m12:47:33.079780 [debug] [Thread-2 (]: Began running node model.frontier_analytics.mart_sap__sales_orders
[0m12:47:33.082312 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.mart_crm__pipeline"
[0m12:47:33.083085 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_dev_marts.mart_sap__sales_orders .............. [RUN]
[0m12:47:33.084467 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_marts, now model.frontier_analytics.mart_sap__sales_orders)
[0m12:47:33.085060 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.mart_sap__sales_orders
[0m12:47:33.088020 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.mart_sap__sales_orders"
[0m12:47:33.088594 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.mart_sap__sales_orders
[0m12:47:33.088991 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.mart_crm__pipeline
[0m12:47:33.134846 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.mart_crm__pipeline"
[0m12:47:33.135665 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.mart_sap__sales_orders"
[0m12:47:33.136216 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:47:33.136633 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:47:33.137004 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_sap__sales_orders"} */

  
    

  create  table "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined"

),

sbu_mapping as (

    select * from "FBS_DB"."Excel_Data"."SBU_Name_Master"

),

account_type as (

    select * from "FBS_DB"."Excel_Data"."SAP_Account_Type_Mapping"

),

sbu_target as (

    select * from "FBS_DB"."Excel_Data"."SBU_Target"

),

final as (

    select distinct
        o.order_number              as so_number,
        o.comments                  as orn,
        o.order_id,
        o.order_date,
        o.order_month,
        o.margin,
        coalesce(sbu."SBU Name", o.sbu_code) as sbu,
        o.kam_name,
        o.block_name                as block,
        o.order_type,
        o.subcategory,
        o.customer_name,
        o.sharing_type,
        o.financial_quarter,
        o.month_name,
        o.ld_cost,
        o.employee_id,
        at."Final Ac Type"          as account_type,
        st."Region"                 as region

    from orders o

    left join sbu_mapping sbu
        on o.sbu_code = sbu."PrcName"

    left join account_type at
        on o.customer_group_code = at."SAP"

    left join sbu_target st
        on o.block_name = st."Block"

    where o.order_date >= case
        when extract(month from current_date) >= 4
            then (extract(year from current_date)::text || '-04-01')::date
        else ((extract(year from current_date) - 1)::text || '-04-01')::date
    end

    order by o.order_number

)

select * from final
  );
  
[0m12:47:33.137501 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */

  
    

  create  table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_tmp"
  
  
    as
  
  (
    with opportunities as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded"

),

account_type as (

    select * from "FBS_DB"."Excel_Data"."CRM_Account_Type_Mapping"

),

sbu_target as (

    select * from "FBS_DB"."Excel_Data"."SBU_Target"

),

final as (

    select distinct
        o.opportunity_id,
        o.company_id,
        o.open_date,
        o.open_month,
        o.close_date,
        o.close_month,
        o.assigned_user_name        as opportunity_assigned_user,
        o.assigned_employee_id      as empl_id,
        o.kam_name,
        o.kam_id,
        o.block_name                as block,
        o.stage,
        o.certainty,
        o.certainty_bucket,
        o.segment                   as category,
        o.company_name,
        o.vertical,
        o.sbu,
        o.oem,
        o.quantity,
        o.topline,
        o.bottomline,
        o.opportunity_age_days      as opportunity_age,
        o.opportunity_type          as tender,
        o.services_subcategory,
        o.solution_architect,
        o.is_mustwin,
        o.is_vp_visit,
        o.vp_visit_remark           as remark,
        o.created_by_name           as opportunity_created_by,
        o.updated_at                as last_modify_date,
        coalesce(at."Final Ac Type", 'OTHER') as final_ac_type,
        st."Region"                 as region,
        st."Block Head"             as block_head

    from opportunities o

    left join account_type at
        on o.segment::text = at."CRM"::text

    left join sbu_target st
        on o.block_name = st."Block"::text

)

select * from final
  );
  
[0m12:47:33.137926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:47:33.138315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:33.610959 [debug] [Thread-1 (]: SQL status: SELECT 6287 in 0.472 seconds
[0m12:47:33.617556 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:47:33.617928 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */
alter table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline" rename to "mart_crm__pipeline__dbt_backup"
[0m12:47:33.622219 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:47:33.624540 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:47:33.624847 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */
alter table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_tmp" rename to "mart_crm__pipeline"
[0m12:47:33.628889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:47:33.639751 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: COMMIT
[0m12:47:33.640551 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:47:33.640841 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: COMMIT
[0m12:47:33.650946 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m12:47:33.655581 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_backup"
[0m12:47:33.658953 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:47:33.659258 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */
drop table if exists "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_backup" cascade
[0m12:47:33.667691 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m12:47:33.670011 [debug] [Thread-1 (]: On model.frontier_analytics.mart_crm__pipeline: Close
[0m12:47:33.671766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fd0c354-fb9f-42ac-84a7-f28bfc17c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab1a76870>]}
[0m12:47:33.673386 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_dev_marts.mart_crm__pipeline ............. [[32mSELECT 6287[0m in 0.60s]
[0m12:47:33.673997 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.mart_crm__pipeline
[0m12:47:34.381413 [debug] [Thread-2 (]: SQL status: SELECT 2010 in 1.243 seconds
[0m12:47:34.384056 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:47:34.384376 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_sap__sales_orders"} */
alter table "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders__dbt_tmp" rename to "mart_sap__sales_orders"
[0m12:47:34.390044 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:47:34.391082 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: COMMIT
[0m12:47:34.391354 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:47:34.391754 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: COMMIT
[0m12:47:34.399464 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m12:47:34.401087 [debug] [Thread-2 (]: Applying DROP to: "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders__dbt_backup"
[0m12:47:34.401548 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:47:34.401798 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_sap__sales_orders"} */
drop table if exists "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders__dbt_backup" cascade
[0m12:47:34.405719 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:47:34.406647 [debug] [Thread-2 (]: On model.frontier_analytics.mart_sap__sales_orders: Close
[0m12:47:34.407127 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fd0c354-fb9f-42ac-84a7-f28bfc17c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aabe825a0>]}
[0m12:47:34.407601 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dbt_dev_marts.mart_sap__sales_orders ......... [[32mSELECT 2010[0m in 1.32s]
[0m12:47:34.407997 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.mart_sap__sales_orders
[0m12:47:34.410549 [debug] [MainThread]: On master: COMMIT
[0m12:47:34.410988 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:34.411273 [debug] [MainThread]: On master: COMMIT
[0m12:47:34.411574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:34.480036 [debug] [MainThread]: SQL status: COMMIT in 0.068 seconds
[0m12:47:34.480456 [debug] [MainThread]: On master: Close
[0m12:47:34.480820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:34.481013 [debug] [MainThread]: Connection 'list_FBS_DB_dbt_dev_intermediate' was properly closed.
[0m12:47:34.481184 [debug] [MainThread]: Connection 'model.frontier_analytics.mart_sap__sales_orders' was properly closed.
[0m12:47:34.481339 [debug] [MainThread]: Connection 'model.frontier_analytics.mart_crm__pipeline' was properly closed.
[0m12:47:34.481651 [info ] [MainThread]: 
[0m12:47:34.481937 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m12:47:34.482500 [debug] [MainThread]: Command end result
[0m12:47:34.501492 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:47:34.503194 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:47:34.507067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:47:34.507335 [info ] [MainThread]: 
[0m12:47:34.507633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:34.507872 [info ] [MainThread]: 
[0m12:47:34.508104 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:47:34.508835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.408215, "process_in_blocks": "8", "process_kernel_time": 0.124779, "process_mem_max_rss": "124800", "process_out_blocks": "2280", "process_user_time": 1.535744}
[0m12:47:34.509213 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:34.509136 after 2.41 seconds
[0m12:47:34.509530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aaf1921e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab1a76870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aaff78e00>]}
[0m12:47:34.509813 [debug] [MainThread]: Flushing usage events
[0m12:47:35.423944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:56.030873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15b3f5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15c4d91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15aff8920>]}


============================== 12:50:56.036399 | 4343069f-317c-43ad-a8e5-b27a7c0095f2 ==============================
[0m12:50:56.036399 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:50:56.036869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'quiet': 'False', 'introspect': 'True', 'log_format': 'default', 'empty': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/home/suraj/frontier_analytics/logs', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/suraj/.dbt', 'log_cache_events': 'False', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'target_path': 'None', 'static_parser': 'True'}
[0m12:50:56.223477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15d27f620>]}
[0m12:50:56.278366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15add8ec0>]}
[0m12:50:56.281205 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:50:56.337499 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:50:56.445518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:56.445915 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:50:56.446121 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:56.470644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15af98770>]}
[0m12:50:56.531357 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:50:56.534230 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:50:56.564633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff158b0a630>]}
[0m12:50:56.565106 [info ] [MainThread]: Found 14 models, 16 sources, 466 macros
[0m12:50:56.565407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff159f34710>]}
[0m12:50:56.567464 [info ] [MainThread]: 
[0m12:50:56.568213 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:50:56.568615 [info ] [MainThread]: 
[0m12:50:56.569091 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:50:56.573535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m12:50:56.581448 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m12:50:56.582452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB'
[0m12:50:56.634727 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m12:50:56.635199 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m12:50:56.635671 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB"
[0m12:50:56.636134 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m12:50:56.636446 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m12:50:56.636739 [debug] [ThreadPool]: On list_FBS_DB: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB"} */

    select distinct nspname from pg_namespace
  
[0m12:50:56.637019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:56.637262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:56.637544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:56.734963 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.097 seconds
[0m12:50:56.735432 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.098 seconds
[0m12:50:56.736568 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m12:50:56.737548 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m12:50:56.816913 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.180 seconds
[0m12:50:56.818291 [debug] [ThreadPool]: On list_FBS_DB: Close
[0m12:50:56.820904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_staging)
[0m12:50:56.825452 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:50:56.826318 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:50:56.826909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_intermediate)
[0m12:50:56.827360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:56.828934 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:50:56.829638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FBS_DB, now list_FBS_DB_dbt_dev_marts)
[0m12:50:56.830553 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:50:56.832311 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:50:56.832752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:56.833208 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:50:56.833742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:56.918550 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.086 seconds
[0m12:50:56.919053 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.085 seconds
[0m12:50:56.920352 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:50:56.921481 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:50:56.923729 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:50:56.924816 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:50:57.008439 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.181 seconds
[0m12:50:57.009696 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:50:57.011915 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:50:57.017640 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:57.018050 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:50:57.018261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:57.215311 [debug] [MainThread]: SQL status: SELECT 90 in 0.197 seconds
[0m12:50:57.218648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff158b10650>]}
[0m12:50:57.219010 [debug] [MainThread]: On master: ROLLBACK
[0m12:50:57.221143 [debug] [MainThread]: On master: COMMIT
[0m12:50:57.221370 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:57.221526 [debug] [MainThread]: On master: COMMIT
[0m12:50:57.225397 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m12:50:57.225654 [debug] [MainThread]: On master: Close
[0m12:50:57.232786 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_crm__companies
[0m12:50:57.233221 [debug] [Thread-2 (]: Began running node model.frontier_analytics.stg_crm__custom_captions
[0m12:50:57.233671 [debug] [Thread-3 (]: Began running node model.frontier_analytics.stg_crm__opportunities
[0m12:50:57.234178 [info ] [Thread-1 (]: 1 of 14 START sql view model dbt_dev_staging.stg_crm__companies ................ [RUN]
[0m12:50:57.234555 [debug] [Thread-4 (]: Began running node model.frontier_analytics.stg_crm__users
[0m12:50:57.235029 [info ] [Thread-2 (]: 2 of 14 START sql view model dbt_dev_staging.stg_crm__custom_captions .......... [RUN]
[0m12:50:57.235628 [info ] [Thread-3 (]: 3 of 14 START sql view model dbt_dev_staging.stg_crm__opportunities ............ [RUN]
[0m12:50:57.236331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.stg_crm__companies)
[0m12:50:57.237357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_marts, now model.frontier_analytics.stg_crm__custom_captions)
[0m12:50:57.236943 [info ] [Thread-4 (]: 4 of 14 START sql view model dbt_dev_staging.stg_crm__users .................... [RUN]
[0m12:50:57.237892 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_intermediate, now model.frontier_analytics.stg_crm__opportunities)
[0m12:50:57.238245 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_crm__companies
[0m12:50:57.238537 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.stg_crm__custom_captions
[0m12:50:57.238970 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.frontier_analytics.stg_crm__users'
[0m12:50:57.239279 [debug] [Thread-3 (]: Began compiling node model.frontier_analytics.stg_crm__opportunities
[0m12:50:57.246178 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__companies"
[0m12:50:57.250193 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__custom_captions"
[0m12:50:57.250743 [debug] [Thread-4 (]: Began compiling node model.frontier_analytics.stg_crm__users
[0m12:50:57.252733 [debug] [Thread-3 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__opportunities"
[0m12:50:57.255558 [debug] [Thread-4 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__users"
[0m12:50:57.256717 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_crm__companies
[0m12:50:57.257203 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.stg_crm__custom_captions
[0m12:50:57.299533 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__custom_captions"
[0m12:50:57.300668 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__companies"
[0m12:50:57.301364 [debug] [Thread-3 (]: Began executing node model.frontier_analytics.stg_crm__opportunities
[0m12:50:57.302201 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_crm__custom_captions"
[0m12:50:57.302579 [debug] [Thread-4 (]: Began executing node model.frontier_analytics.stg_crm__users
[0m12:50:57.305469 [debug] [Thread-3 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__opportunities"
[0m12:50:57.305864 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_crm__companies"
[0m12:50:57.306435 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__custom_captions"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."CRM"."Custom_Captions"

),

renamed as (

    select
        "Capt_Code"     as caption_code,
        "Capt_Family"   as caption_family,
        "Capt_US"       as caption_value
    from source

)

select * from renamed
  );
[0m12:50:57.309294 [debug] [Thread-4 (]: Writing runtime sql for node "model.frontier_analytics.stg_crm__users"
[0m12:50:57.309953 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__companies"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__companies__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."CRM"."Company"

),

renamed as (

    select
        "Comp_CompanyId"    as company_id,
        "Comp_Name"         as company_name,
        "Comp_Sector"       as sector_code,
        "Comp_PrimaryUserId" as primary_user_id,
        "comp_blocks"       as block_code
    from source

)

select * from renamed
  );
[0m12:50:57.310396 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:50:57.310790 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_crm__opportunities"
[0m12:50:57.311438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:57.311907 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_crm__users"
[0m12:50:57.312497 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__opportunities"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."CRM"."Opportunity"

),

renamed as (

    select
        "Oppo_OpportunityId"    as opportunity_id,
        "Oppo_PrimaryCompanyId" as company_id,
        "Oppo_AssignedUserId"   as assigned_user_id,
        "Oppo_CreatedBy"        as created_by_user_id,
        "Oppo_Opened"           as opened_at,
        "Oppo_TargetClose"      as target_close_date,
        "Oppo_UpdatedDate"      as updated_at,
        "Oppo_Stage"            as stage,
        "Oppo_Certainty"        as certainty,
        "Oppo_Forecast"         as forecast_topline,
        "Oppo_ChannelId"        as channel_id,
        "oppo_segment"          as segment,
        "oppo_qty"              as quantity,
        "oppo_oppotype"         as opportunity_type,
        "oppo_principle"        as oem_principle,
        "oppo_OEM1"             as oem_1,
        "oppo_OEM2"             as oem_2,
        "oppo_oem3"             as oem_3,
        "oppo_sbu1"             as sbu_1_id,
        "oppo_SBU2"             as sbu_2_id,
        "oppo_sbu3"             as sbu_3_id,

        "oppo_SA"               as solution_architect_code,
        "oppo_CRIMOFF"          as services_subcategory,
        "oppo_Mustwin"          as is_mustwin,
        "oppo_VPvisit"          as is_vp_visit,
        "oppo_VPVISITREMARK"    as vp_visit_remark,
        "oppo_bforecast"        as forecast_bottomline,
        "oppo_topline1"         as topline_1,
        "oppo_topline2"         as topline_2,
        "oppo_topline3"         as topline_3,
        "oppo_botline1"         as bottomline_1,
        "oppo_botline2"         as bottomline_2,
        "oppo_botline3"         as bottomline_3
    from source

)

select * from renamed
  );
[0m12:50:57.313126 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__users"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_crm__users__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."CRM"."Users"

),

renamed as (

    select
        "User_UserId"       as user_id,
        "User_FirstName"    as first_name,
        "User_LastName"     as last_name,
        "User_Logon"        as logon_id,
        concat("User_FirstName", ' ', "User_LastName") as full_name,
        regexp_replace("User_Logon"::text, '[^0-9]', '', 'g') as employee_id
    from source

)

select * from renamed
  );
[0m12:50:57.313514 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:50:57.313881 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:50:57.461575 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.151 seconds
[0m12:50:57.468977 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_crm__custom_captions"
[0m12:50:57.469311 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__custom_captions"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions" rename to "stg_crm__custom_captions__dbt_backup"
[0m12:50:57.470004 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.156 seconds
[0m12:50:57.472113 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_crm__opportunities"
[0m12:50:57.472470 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__opportunities"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities" rename to "stg_crm__opportunities__dbt_backup"
[0m12:50:57.472943 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.159 seconds
[0m12:50:57.477204 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_crm__users"
[0m12:50:57.477918 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__users"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__users" rename to "stg_crm__users__dbt_backup"
[0m12:50:57.478695 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m12:50:57.481298 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_crm__custom_captions"
[0m12:50:57.481869 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.170 seconds
[0m12:50:57.482298 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__custom_captions"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions__dbt_tmp" rename to "stg_crm__custom_captions"
[0m12:50:57.488056 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m12:50:57.488792 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m12:50:57.489342 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_crm__companies"
[0m12:50:57.491596 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_crm__opportunities"
[0m12:50:57.494289 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_crm__users"
[0m12:50:57.494795 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:50:57.495227 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__companies"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__companies" rename to "stg_crm__companies__dbt_backup"
[0m12:50:57.495645 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__opportunities"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities__dbt_tmp" rename to "stg_crm__opportunities"
[0m12:50:57.496004 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__users"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__users__dbt_tmp" rename to "stg_crm__users"
[0m12:50:57.507502 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: COMMIT
[0m12:50:57.508458 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_crm__custom_captions"
[0m12:50:57.508716 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: COMMIT
[0m12:50:57.511181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:50:57.513940 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_crm__companies"
[0m12:50:57.514592 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__companies"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_crm__companies__dbt_tmp" rename to "stg_crm__companies"
[0m12:50:57.515142 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m12:50:57.515531 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:50:57.515816 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m12:50:57.520857 [debug] [Thread-2 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions__dbt_backup"
[0m12:50:57.522291 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: COMMIT
[0m12:50:57.522723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:50:57.523667 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: COMMIT
[0m12:50:57.527920 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_crm__custom_captions"
[0m12:50:57.528494 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_crm__users"
[0m12:50:57.529699 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: COMMIT
[0m12:50:57.530086 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_crm__opportunities"
[0m12:50:57.530451 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__custom_captions"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions__dbt_backup" cascade
[0m12:50:57.530754 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: COMMIT
[0m12:50:57.531100 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_crm__companies"
[0m12:50:57.531425 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: COMMIT
[0m12:50:57.532032 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: COMMIT
[0m12:50:57.534242 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m12:50:57.536891 [debug] [Thread-4 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_crm__users__dbt_backup"
[0m12:50:57.537636 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_crm__users"
[0m12:50:57.537951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:50:57.538242 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__users"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_crm__users__dbt_backup" cascade
[0m12:50:57.538491 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m12:50:57.538895 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m12:50:57.540573 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_crm__companies__dbt_backup"
[0m12:50:57.543511 [debug] [Thread-3 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities__dbt_backup"
[0m12:50:57.547371 [debug] [Thread-2 (]: On model.frontier_analytics.stg_crm__custom_captions: Close
[0m12:50:57.548369 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_crm__companies"
[0m12:50:57.548933 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.008 seconds
[0m12:50:57.549573 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_crm__opportunities"
[0m12:50:57.551763 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__companies"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_crm__companies__dbt_backup" cascade
[0m12:50:57.552966 [debug] [Thread-4 (]: On model.frontier_analytics.stg_crm__users: Close
[0m12:50:57.553541 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15b780f50>]}
[0m12:50:57.553890 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_crm__opportunities"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities__dbt_backup" cascade
[0m12:50:57.555570 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1566c9a90>]}
[0m12:50:57.555055 [info ] [Thread-2 (]: 2 of 14 OK created sql view model dbt_dev_staging.stg_crm__custom_captions ..... [[32mCREATE VIEW[0m in 0.31s]
[0m12:50:57.557704 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.stg_crm__custom_captions
[0m12:50:57.558127 [debug] [Thread-2 (]: Began running node model.frontier_analytics.stg_sap__margin_sharing
[0m12:50:57.559236 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:50:57.561107 [debug] [Thread-1 (]: On model.frontier_analytics.stg_crm__companies: Close
[0m12:50:57.556831 [info ] [Thread-4 (]: 4 of 14 OK created sql view model dbt_dev_staging.stg_crm__users ............... [[32mCREATE VIEW[0m in 0.32s]
[0m12:50:57.562897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff158bb1f10>]}
[0m12:50:57.563656 [debug] [Thread-4 (]: Finished running node model.frontier_analytics.stg_crm__users
[0m12:50:57.558569 [info ] [Thread-2 (]: 5 of 14 START sql view model dbt_dev_staging.stg_sap__margin_sharing ........... [RUN]
[0m12:50:57.564402 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m12:50:57.565628 [info ] [Thread-1 (]: 1 of 14 OK created sql view model dbt_dev_staging.stg_crm__companies ........... [[32mCREATE VIEW[0m in 0.33s]
[0m12:50:57.566178 [debug] [Thread-4 (]: Began running node model.frontier_analytics.stg_sap__order_lines
[0m12:50:57.566741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__custom_captions, now model.frontier_analytics.stg_sap__margin_sharing)
[0m12:50:57.568247 [debug] [Thread-3 (]: On model.frontier_analytics.stg_crm__opportunities: Close
[0m12:50:57.568783 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_crm__companies
[0m12:50:57.569207 [info ] [Thread-4 (]: 6 of 14 START sql view model dbt_dev_staging.stg_sap__order_lines .............. [RUN]
[0m12:50:57.569634 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.stg_sap__margin_sharing
[0m12:50:57.570132 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_sap__orders
[0m12:50:57.570929 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1566b8ec0>]}
[0m12:50:57.571287 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__users, now model.frontier_analytics.stg_sap__order_lines)
[0m12:50:57.663481 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__margin_sharing"
[0m12:50:57.664191 [info ] [Thread-1 (]: 7 of 14 START sql view model dbt_dev_staging.stg_sap__orders ................... [RUN]
[0m12:50:57.664856 [info ] [Thread-3 (]: 3 of 14 OK created sql view model dbt_dev_staging.stg_crm__opportunities ....... [[32mCREATE VIEW[0m in 0.33s]
[0m12:50:57.665305 [debug] [Thread-4 (]: Began compiling node model.frontier_analytics.stg_sap__order_lines
[0m12:50:57.666092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__companies, now model.frontier_analytics.stg_sap__orders)
[0m12:50:57.666559 [debug] [Thread-3 (]: Finished running node model.frontier_analytics.stg_crm__opportunities
[0m12:50:57.668671 [debug] [Thread-4 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__order_lines"
[0m12:50:57.669160 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_sap__orders
[0m12:50:57.669449 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.stg_sap__margin_sharing
[0m12:50:57.669865 [debug] [Thread-3 (]: Began running node model.frontier_analytics.stg_sap__profit_centres
[0m12:50:57.672180 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__orders"
[0m12:50:57.672615 [debug] [Thread-4 (]: Began executing node model.frontier_analytics.stg_sap__order_lines
[0m12:50:57.675463 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__margin_sharing"
[0m12:50:57.676023 [info ] [Thread-3 (]: 8 of 14 START sql view model dbt_dev_staging.stg_sap__profit_centres ........... [RUN]
[0m12:50:57.679219 [debug] [Thread-4 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__order_lines"
[0m12:50:57.680247 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__opportunities, now model.frontier_analytics.stg_sap__profit_centres)
[0m12:50:57.680658 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_sap__orders
[0m12:50:57.681423 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m12:50:57.681973 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m12:50:57.682356 [debug] [Thread-3 (]: Began compiling node model.frontier_analytics.stg_sap__profit_centres
[0m12:50:57.684327 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__orders"
[0m12:50:57.684767 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__order_lines: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__order_lines"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."RDR1"

),

renamed as (

    select
        "DocEntry"      as order_id,
        "LineNum"       as line_number,
        "ItemCode"      as item_code,
        "Dscription"    as item_description,
        "U_SSC"         as subcategory,
        "LineTotal"     as line_total,
        "Quantity"      as quantity
    from source

)

select * from renamed
  );
[0m12:50:57.685146 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__margin_sharing"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."@F_MARGINSHARING"

),

renamed as (

    select
        "Code"                  as code,
        "U_AVA_DocEntry"::integer as order_id,
        "U_AVA_DocNum"          as order_number,
        "U_AVA_EMPID"           as employee_id_code,
        "U_AVA_SUB"             as sbu_code,
        "U_AVA_SUBCATEGORY"     as subcategory,
        "U_AVA_BLOCK"           as block_code,
        "U_AVA_MARGIN"          as margin_raw,
        "U_AVA_FMargin"         as margin_final,
        "U_S_Orn"               as source_reference
    from source

)

select * from renamed
  );
[0m12:50:57.686959 [debug] [Thread-3 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__profit_centres"
[0m12:50:57.687474 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:50:57.687842 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:50:57.688256 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m12:50:57.688910 [debug] [Thread-3 (]: Began executing node model.frontier_analytics.stg_sap__profit_centres
[0m12:50:57.689516 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."ORDR"

),

renamed as (

    select
        "DocEntry"          as order_id,
        "DocNum"            as order_number,
        "DocDate"           as order_date,
        "CardName"          as customer_name,
        "CANCELED"          as is_cancelled,
        "U_Marginpl"::numeric as margin,
        "U_SBU"             as sbu_code,
        "U_Ordertype"       as order_type,
        "U_AVA_MARGINTYPE"  as margin_type,
        "U_SalesExecutive"  as sales_executive_code,
        "U_AVA_Block"       as block_code,
        "U_Cgroup"          as customer_group_code,
        "U_Ldcst"           as ld_cost,
        "Comments"          as comments,
        "U_AVA_MARGINTYPE"  as margin_sharing_type

    from source

)

select * from renamed
  );
[0m12:50:57.691312 [debug] [Thread-3 (]: Writing runtime sql for node "model.frontier_analytics.stg_sap__profit_centres"
[0m12:50:57.691739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:57.692566 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m12:50:57.692933 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__profit_centres"} */

  create view "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_tmp"
    
    
  as (
    with source as (

    select * from "FBS_DB"."SAP"."OPRC"

),

renamed as (

    select
        "PrcCode"   as profit_centre_code,
        "PrcName"   as profit_centre_name
    from source

)

select * from renamed
  );
[0m12:50:57.693257 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:50:57.789052 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.101 seconds
[0m12:50:57.791868 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m12:50:57.792183 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__margin_sharing"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing" rename to "stg_sap__margin_sharing__dbt_backup"
[0m12:50:57.792722 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.099 seconds
[0m12:50:57.795571 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m12:50:57.795919 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__profit_centres"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres" rename to "stg_sap__profit_centres__dbt_backup"
[0m12:50:57.796728 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:50:57.799591 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m12:50:57.799955 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__margin_sharing"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_tmp" rename to "stg_sap__margin_sharing"
[0m12:50:57.800283 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.109 seconds
[0m12:50:57.801936 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m12:50:57.802199 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__orders" rename to "stg_sap__orders__dbt_backup"
[0m12:50:57.802500 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:50:57.803916 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m12:50:57.804136 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__profit_centres"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_tmp" rename to "stg_sap__profit_centres"
[0m12:50:57.804789 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:50:57.805548 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: COMMIT
[0m12:50:57.805751 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m12:50:57.805926 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: COMMIT
[0m12:50:57.806653 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:50:57.807446 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: COMMIT
[0m12:50:57.807693 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m12:50:57.807928 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: COMMIT
[0m12:50:57.808211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:50:57.809879 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m12:50:57.810219 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m12:50:57.810542 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_tmp" rename to "stg_sap__orders"
[0m12:50:57.812319 [debug] [Thread-2 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_backup"
[0m12:50:57.812680 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:50:57.813494 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.stg_sap__margin_sharing"
[0m12:50:57.815313 [debug] [Thread-3 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_backup"
[0m12:50:57.815826 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__margin_sharing"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing__dbt_backup" cascade
[0m12:50:57.816331 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.stg_sap__profit_centres"
[0m12:50:57.816912 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__profit_centres"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres__dbt_backup" cascade
[0m12:50:57.817253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:50:57.818208 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: COMMIT
[0m12:50:57.818417 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m12:50:57.818585 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: COMMIT
[0m12:50:57.821565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:50:57.822778 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_backup"
[0m12:50:57.823092 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.stg_sap__orders"
[0m12:50:57.823302 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__orders"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__orders__dbt_backup" cascade
[0m12:50:57.823941 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m12:50:57.824794 [debug] [Thread-2 (]: On model.frontier_analytics.stg_sap__margin_sharing: Close
[0m12:50:57.825191 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15455bc50>]}
[0m12:50:57.826029 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.009 seconds
[0m12:50:57.827513 [debug] [Thread-3 (]: On model.frontier_analytics.stg_sap__profit_centres: Close
[0m12:50:57.825675 [info ] [Thread-2 (]: 5 of 14 OK created sql view model dbt_dev_staging.stg_sap__margin_sharing ...... [[32mCREATE VIEW[0m in 0.26s]
[0m12:50:57.828324 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.stg_sap__margin_sharing
[0m12:50:57.828852 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15bb06510>]}
[0m12:50:57.829293 [debug] [Thread-2 (]: Began running node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:50:57.830069 [info ] [Thread-3 (]: 8 of 14 OK created sql view model dbt_dev_staging.stg_sap__profit_centres ...... [[32mCREATE VIEW[0m in 0.15s]
[0m12:50:57.830728 [info ] [Thread-2 (]: 9 of 14 START sql view model dbt_dev_intermediate.int_crm__opportunities_expanded  [RUN]
[0m12:50:57.831140 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m12:50:57.831669 [debug] [Thread-3 (]: Finished running node model.frontier_analytics.stg_sap__profit_centres
[0m12:50:57.832327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_sap__margin_sharing, now model.frontier_analytics.int_crm__opportunities_expanded)
[0m12:50:57.833454 [debug] [Thread-1 (]: On model.frontier_analytics.stg_sap__orders: Close
[0m12:50:57.834017 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:50:57.836882 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:50:57.837372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15678f800>]}
[0m12:50:57.837992 [info ] [Thread-1 (]: 7 of 14 OK created sql view model dbt_dev_staging.stg_sap__orders .............. [[32mCREATE VIEW[0m in 0.17s]
[0m12:50:57.838441 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_sap__orders
[0m12:50:57.839005 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:50:57.840704 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:50:57.841097 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:50:57.841448 [debug] [Thread-2 (]: On model.frontier_analytics.int_crm__opportunities_expanded: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_crm__opportunities_expanded"} */

  create view "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded__dbt_tmp"
    
    
  as (
    with opportunities as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_crm__opportunities"

),

users as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_crm__users"

),

companies as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_crm__companies"

),

captions as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_crm__custom_captions"

),

-- Build arrays for SBU, OEM, topline, bottomline
-- This mirrors your original view's array construction
base as (

    select
        o.opportunity_id,
        o.company_id,
        o.assigned_user_id,
        o.created_by_user_id,
        o.opened_at,
        o.target_close_date,
        o.updated_at,
        o.stage,
        o.certainty,
        o.segment,
        o.quantity,
        o.opportunity_type,
        o.services_subcategory,
        o.is_mustwin,
        o.is_vp_visit,
        o.vp_visit_remark,

        -- Assigned user details
        assigned_user.full_name      as assigned_user_name,
        assigned_user.employee_id    as assigned_employee_id,

        -- Created by user
        created_user.full_name       as created_by_name,

        -- Company details
        c.company_name,
        c.sector_code,
        c.block_code                 as company_block_code,

        -- Block name from captions
        block_cap.caption_value      as block_name,

        -- Vertical from captions
        vertical_cap.caption_value   as vertical,

        -- Solution architect from captions
        sa_cap.caption_value         as solution_architect,

        -- KAM from primary user of company
        kam_user.full_name           as kam_name,
        kam_user.employee_id         as kam_id,

        -- Certainty bucket
        case
            when o.certainty <= 90 then '<90'
            when o.certainty > 90  then '>90'
            else o.certainty::text
        end as certainty_bucket,

        -- Opportunity age in days
        current_date - o.opened_at::date as opportunity_age_days,

        -- Arrays for multi-SBU and multi-OEM expansion
        array[
            sbu1.caption_value,
            sbu2.caption_value,
            sbu3.caption_value,
            sbu4.caption_value
        ] as sbu_array,

        array[
            oem0.caption_value,
            oem1.caption_value,
            oem2.caption_value,
            oem3.caption_value
        ] as oem_array,

        array[
            round(o.forecast_topline, 2),
            round(o.topline_1, 2),
            round(o.topline_2, 2),
            round(o.topline_3, 2)
        ] as topline_array,

        array[
            round(o.forecast_bottomline, 2),
            round(o.bottomline_1, 2),
            round(o.bottomline_2, 2),
            round(o.bottomline_3, 2)
        ] as bottomline_array

    from opportunities o

    -- Assigned user
    left join users assigned_user
        on o.assigned_user_id = assigned_user.user_id

    -- Created by user
    left join users created_user
        on o.created_by_user_id = created_user.user_id

    -- KAM from company primary user
    left join companies c
        on o.company_id = c.company_id
    left join users kam_user
        on c.primary_user_id = kam_user.user_id

    -- Block name
    left join captions block_cap
        on c.block_code::text = block_cap.caption_code::text
        and block_cap.caption_family = 'oppo_principle'

    -- Vertical
    left join captions vertical_cap
        on c.sector_code::text = vertical_cap.caption_code::text

    -- Solution architect
    left join captions sa_cap
        on o.solution_architect_code::text = sa_cap.caption_code::text

    -- SBU captions
    left join captions sbu1
        on o.sbu_1_id = sbu1.caption_code::integer
        and sbu1.caption_family = 'Channels'
    left join captions sbu2
        on o.sbu_2_id = sbu2.caption_code::integer
        and sbu2.caption_family = 'Channels'
    left join captions sbu3
        on o.sbu_3_id = sbu3.caption_code::integer
        and sbu3.caption_family = 'Channels'
    left join captions sbu4
        on o.assigned_user_id = sbu4.caption_code::integer
        and sbu4.caption_family = 'Channels'

    -- OEM captions
    left join captions oem0
        on o.oem_principle::text = oem0.caption_code::text
        and oem0.caption_family = 'oppo_principle'
    left join captions oem1
        on o.oem_1::text = oem1.caption_code::text
        and oem1.caption_family = 'oppo_principle'
    left join captions oem2
        on o.oem_2::text = oem2.caption_code::text
        and oem2.caption_family = 'oppo_principle'
    left join captions oem3
        on o.oem_3::text = oem3.caption_code::text
        and oem3.caption_family = 'oppo_principle'

    -- Financial year filter - dynamic current FY
    where o.target_close_date > case
        when extract(month from current_date) >= 4
            then (extract(year from current_date)::text || '-04-01')::date
        else ((extract(year from current_date) - 1)::text || '-04-01')::date
    end

),

-- Unnest arrays - one row per SBU/OEM combination
-- This is the CROSS JOIN LATERAL unnest logic from your original view
expanded as (

    select
        b.opportunity_id,
        b.company_id,
        b.assigned_user_id,
        b.assigned_user_name,
        b.assigned_employee_id,
        b.created_by_name,
        b.opened_at::date               as open_date,
        to_char(b.opened_at, 'FMMonth') as open_month,
        b.target_close_date::date       as close_date,
        to_char(b.target_close_date, 'FMMonth') as close_month,
        b.updated_at,
        b.stage,
        b.certainty,
        b.certainty_bucket,
        b.segment,
        b.quantity,
        b.opportunity_type,
        b.services_subcategory,
        b.is_mustwin,
        b.is_vp_visit,
        b.vp_visit_remark,
        b.company_name,
        b.vertical,
        b.block_name,
        b.solution_architect,
        b.kam_name,
        b.kam_id,
        b.opportunity_age_days,
        b.sbu_array[u.idx + 1]          as sbu,
        b.oem_array[u.idx + 1]          as oem,
        b.topline_array[u.idx + 1]      as topline,
        b.bottomline_array[u.idx + 1]   as bottomline

    from base b
    cross join lateral (
        select unnest(array[0,1,2,3]) as idx
    ) u

    -- Only keep rows where bottomline is non-zero
    where b.bottomline_array[u.idx + 1] <> 0

)

select distinct * from expanded
  );
[0m12:50:57.841742 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:50:57.884746 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.197 seconds
[0m12:50:57.886866 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m12:50:57.887116 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__order_lines: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__order_lines"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines" rename to "stg_sap__order_lines__dbt_backup"
[0m12:50:57.890858 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:50:57.893635 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m12:50:57.893927 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__order_lines: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__order_lines"} */
alter table "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_tmp" rename to "stg_sap__order_lines"
[0m12:50:57.897889 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:50:57.898848 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__order_lines: COMMIT
[0m12:50:57.899135 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m12:50:57.899451 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__order_lines: COMMIT
[0m12:50:57.904739 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m12:50:57.906070 [debug] [Thread-4 (]: Applying DROP to: "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_backup"
[0m12:50:57.906406 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.stg_sap__order_lines"
[0m12:50:57.906598 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__order_lines: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.stg_sap__order_lines"} */
drop view if exists "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines__dbt_backup" cascade
[0m12:50:57.920603 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.014 seconds
[0m12:50:57.921672 [debug] [Thread-4 (]: On model.frontier_analytics.stg_sap__order_lines: Close
[0m12:50:57.922045 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff158bb1f40>]}
[0m12:50:57.922461 [info ] [Thread-4 (]: 6 of 14 OK created sql view model dbt_dev_staging.stg_sap__order_lines ......... [[32mCREATE VIEW[0m in 0.35s]
[0m12:50:57.922850 [debug] [Thread-4 (]: Finished running node model.frontier_analytics.stg_sap__order_lines
[0m12:50:57.923536 [debug] [Thread-3 (]: Began running node model.frontier_analytics.int_sap__orders_not_sharing
[0m12:50:57.923910 [info ] [Thread-3 (]: 10 of 14 START sql view model dbt_dev_intermediate.int_sap__orders_not_sharing . [RUN]
[0m12:50:57.924282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_sap__profit_centres, now model.frontier_analytics.int_sap__orders_not_sharing)
[0m12:50:57.924553 [debug] [Thread-3 (]: Began compiling node model.frontier_analytics.int_sap__orders_not_sharing
[0m12:50:57.927430 [debug] [Thread-3 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_not_sharing"
[0m12:50:57.929173 [debug] [Thread-1 (]: Began running node model.frontier_analytics.int_sap__orders_sharing
[0m12:50:57.930516 [info ] [Thread-1 (]: 11 of 14 START sql view model dbt_dev_intermediate.int_sap__orders_sharing ..... [RUN]
[0m12:50:57.931065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_sap__orders, now model.frontier_analytics.int_sap__orders_sharing)
[0m12:50:57.931356 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.int_sap__orders_sharing
[0m12:50:57.933754 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_sharing"
[0m12:50:57.934585 [debug] [Thread-3 (]: Began executing node model.frontier_analytics.int_sap__orders_not_sharing
[0m12:50:57.936772 [debug] [Thread-3 (]: Writing runtime sql for node "model.frontier_analytics.int_sap__orders_not_sharing"
[0m12:50:57.937332 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_not_sharing"
[0m12:50:57.937674 [debug] [Thread-3 (]: On model.frontier_analytics.int_sap__orders_not_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_not_sharing"} */

  create view "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_not_sharing__dbt_tmp"
    
    
  as (
    with orders as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__orders"

),

order_lines as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines"

),

profit_centres as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres"

),

-- Join orders to get one row per order (not per line)
-- rn = 1 ensures we take only the first line per order
-- This matches your original view logic exactly
orders_with_lines as (

    select
        o.order_id,
        o.order_number,
        o.order_date,
        o.customer_name,
        o.margin,
        o.sbu_code,
        o.order_type,
        o.margin_type,
        o.sales_executive_code,
        o.block_code,
        o.customer_group_code,
        o.ld_cost,
        o.comments,
        lower(l.subcategory) as subcategory,
        'Not Sharing' as sharing_type,
        row_number() over (partition by l.order_id) as rn

    from orders o
    join order_lines l on l.order_id = o.order_id

    -- Your original filters
    where o.margin <> 0
      and o.is_cancelled = 'N'
      and o.margin_sharing_type = 'NS'
      and (lower(l.subcategory) not like '%is%' or l.subcategory is null)
      and (o.sbu_code is null
           or o.sbu_code not in ('POWER SERVICE', 'SPWR'))

),

-- Clean employee ID - strip E000 prefix (your original CASE logic)
employee_id_cleaned as (

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        margin_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        rn,
        case
            when left(replace(sales_executive_code, 'E000', ''), 1) = '0'
                then right(replace(sales_executive_code, 'E000', ''), 3)
            when sales_executive_code = 'DIR00001'
                then '1'
            else replace(sales_executive_code, 'E000', '')
        end as employee_id,
        sales_executive_code as kam_profit_centre_code

    from orders_with_lines
    where rn = 1

)

select * from employee_id_cleaned
  );
[0m12:50:57.938026 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.int_sap__orders_sharing
[0m12:50:57.938415 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:50:57.940078 [debug] [Thread-1 (]: Writing runtime sql for node "model.frontier_analytics.int_sap__orders_sharing"
[0m12:50:57.940903 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_sharing"
[0m12:50:57.941200 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_sharing"} */

  create view "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing__dbt_tmp"
    
    
  as (
    with margin_sharing as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__margin_sharing"

),

orders as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__orders"

),

order_lines as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__order_lines"

),

-- Replicate your original @F_MARGINSHARING logic
-- Final margin = margin_final if available, else clean margin_raw
margin_calculated as (

    select
        code,
        order_id,
        employee_id_code,
        sbu_code,
        subcategory,
        block_code,
        source_reference,
        margin_raw,
        margin_final,
        case
            when margin_final is null
                then regexp_replace(margin_raw::text, '[^0-9-]', '', 'g')::numeric
            else margin_final::numeric
        end as margin

    from margin_sharing

),

-- Join to ORDR to get order header details
joined as (

    select
        o.order_number,
        o.comments,
        mc.order_id,
        o.order_date,
        mc.margin,
        mc.sbu_code,
        o.order_type,
        o.margin_sharing_type,
        mc.employee_id_code,
        mc.block_code,
        o.customer_group_code,
        o.customer_name,
        o.ld_cost,
        lower(mc.subcategory) as subcategory,
        'Sharing' as sharing_type,
        row_number() over (partition by mc.order_id) as rn

    from margin_calculated mc
    left join orders o on o.order_id = mc.order_id
    left join order_lines l on l.order_id = mc.order_id

    where (
            coalesce(regexp_replace(mc.margin_raw::text, '[^0-9.-]', '', 'g')::numeric, 0) +
            coalesce(mc.margin_final::numeric, 0)
          ) <> 0
      and o.is_cancelled = 'N'
      and o.margin_sharing_type = 'S'
      and (lower(mc.subcategory) not like '%is%' or mc.subcategory is null)
      and (mc.sbu_code is null
           or mc.sbu_code not in ('POWER SERVICE', 'SPWR'))

),

-- Clean employee ID - same logic as not sharing
employee_id_cleaned as (

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        margin_sharing_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        rn,
        case
            when left(replace(employee_id_code, 'E000', ''), 1) = '0'
                then right(replace(employee_id_code, 'E000', ''), 3)
            else replace(employee_id_code, 'E000', '')
        end as employee_id,
        employee_id_code as kam_profit_centre_code

    from joined
    where rn = 1

)

select * from employee_id_cleaned
  );
[0m12:50:57.941470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:58.019227 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.078 seconds
[0m12:50:58.021436 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_sharing"
[0m12:50:58.021683 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_sharing"} */
alter table "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing__dbt_tmp" rename to "int_sap__orders_sharing"
[0m12:50:58.024738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:50:58.025529 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: COMMIT
[0m12:50:58.025759 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_sharing"
[0m12:50:58.025963 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: COMMIT
[0m12:50:58.029750 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:50:58.031679 [debug] [Thread-1 (]: Applying DROP to: "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing__dbt_backup"
[0m12:50:58.032159 [debug] [Thread-1 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_sharing"
[0m12:50:58.032362 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_sharing"} */
drop view if exists "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing__dbt_backup" cascade
[0m12:50:58.034584 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:50:58.035509 [debug] [Thread-1 (]: On model.frontier_analytics.int_sap__orders_sharing: Close
[0m12:50:58.035932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff156699010>]}
[0m12:50:58.036332 [info ] [Thread-1 (]: 11 of 14 OK created sql view model dbt_dev_intermediate.int_sap__orders_sharing  [[32mCREATE VIEW[0m in 0.10s]
[0m12:50:58.036830 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.int_sap__orders_sharing
[0m12:50:58.102476 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.261 seconds
[0m12:50:58.104290 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:50:58.104651 [debug] [Thread-2 (]: On model.frontier_analytics.int_crm__opportunities_expanded: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_crm__opportunities_expanded"} */
alter table "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded__dbt_tmp" rename to "int_crm__opportunities_expanded"
[0m12:50:58.109864 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:50:58.110798 [debug] [Thread-2 (]: On model.frontier_analytics.int_crm__opportunities_expanded: COMMIT
[0m12:50:58.111051 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:50:58.111256 [debug] [Thread-2 (]: On model.frontier_analytics.int_crm__opportunities_expanded: COMMIT
[0m12:50:58.114717 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m12:50:58.116177 [debug] [Thread-2 (]: Applying DROP to: "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded__dbt_backup"
[0m12:50:58.116567 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:50:58.116760 [debug] [Thread-2 (]: On model.frontier_analytics.int_crm__opportunities_expanded: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_crm__opportunities_expanded"} */
drop view if exists "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded__dbt_backup" cascade
[0m12:50:58.119192 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:50:58.120054 [debug] [Thread-2 (]: On model.frontier_analytics.int_crm__opportunities_expanded: Close
[0m12:50:58.120397 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1566ecc20>]}
[0m12:50:58.120762 [info ] [Thread-2 (]: 9 of 14 OK created sql view model dbt_dev_intermediate.int_crm__opportunities_expanded  [[32mCREATE VIEW[0m in 0.29s]
[0m12:50:58.121171 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:50:58.121849 [debug] [Thread-4 (]: Began running node model.frontier_analytics.mart_crm__pipeline
[0m12:50:58.122269 [info ] [Thread-4 (]: 12 of 14 START sql table model dbt_dev_marts.mart_crm__pipeline ................ [RUN]
[0m12:50:58.122641 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_sap__order_lines, now model.frontier_analytics.mart_crm__pipeline)
[0m12:50:58.122909 [debug] [Thread-4 (]: Began compiling node model.frontier_analytics.mart_crm__pipeline
[0m12:50:58.126651 [debug] [Thread-4 (]: Writing injected SQL for node "model.frontier_analytics.mart_crm__pipeline"
[0m12:50:58.127633 [debug] [Thread-4 (]: Began executing node model.frontier_analytics.mart_crm__pipeline
[0m12:50:58.136568 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.198 seconds
[0m12:50:58.138390 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_not_sharing"
[0m12:50:58.138674 [debug] [Thread-3 (]: On model.frontier_analytics.int_sap__orders_not_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_not_sharing"} */
alter table "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_not_sharing__dbt_tmp" rename to "int_sap__orders_not_sharing"
[0m12:50:58.146700 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m12:50:58.147296 [debug] [Thread-4 (]: Writing runtime sql for node "model.frontier_analytics.mart_crm__pipeline"
[0m12:50:58.148422 [debug] [Thread-3 (]: On model.frontier_analytics.int_sap__orders_not_sharing: COMMIT
[0m12:50:58.149038 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_not_sharing"
[0m12:50:58.149305 [debug] [Thread-3 (]: On model.frontier_analytics.int_sap__orders_not_sharing: COMMIT
[0m12:50:58.149693 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:50:58.149974 [debug] [Thread-4 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */

  
    

  create  table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_tmp"
  
  
    as
  
  (
    with opportunities as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_crm__opportunities_expanded"

),

account_type as (

    select * from "FBS_DB"."Excel_Data"."CRM_Account_Type_Mapping"

),

sbu_target as (

    select * from "FBS_DB"."Excel_Data"."SBU_Target"

),

final as (

    select distinct
        o.opportunity_id,
        o.company_id,
        o.open_date,
        o.open_month,
        o.close_date,
        o.close_month,
        o.assigned_user_name        as opportunity_assigned_user,
        o.assigned_employee_id      as empl_id,
        o.kam_name,
        o.kam_id,
        o.block_name                as block,
        o.stage,
        o.certainty,
        o.certainty_bucket,
        o.segment                   as category,
        o.company_name,
        o.vertical,
        o.sbu,
        o.oem,
        o.quantity,
        o.topline,
        o.bottomline,
        o.opportunity_age_days      as opportunity_age,
        o.opportunity_type          as tender,
        o.services_subcategory,
        o.solution_architect,
        o.is_mustwin,
        o.is_vp_visit,
        o.vp_visit_remark           as remark,
        o.created_by_name           as opportunity_created_by,
        o.updated_at                as last_modify_date,
        coalesce(at."Final Ac Type", 'OTHER') as final_ac_type,
        st."Region"                 as region,
        st."Block Head"             as block_head

    from opportunities o

    left join account_type at
        on o.segment::text = at."CRM"::text

    left join sbu_target st
        on o.block_name = st."Block"::text

)

select * from final
  );
  
[0m12:50:58.150212 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:50:58.153474 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m12:50:58.154791 [debug] [Thread-3 (]: Applying DROP to: "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_not_sharing__dbt_backup"
[0m12:50:58.155243 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_not_sharing"
[0m12:50:58.155447 [debug] [Thread-3 (]: On model.frontier_analytics.int_sap__orders_not_sharing: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_not_sharing"} */
drop view if exists "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_not_sharing__dbt_backup" cascade
[0m12:50:58.158031 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:50:58.158816 [debug] [Thread-3 (]: On model.frontier_analytics.int_sap__orders_not_sharing: Close
[0m12:50:58.159176 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15a8112e0>]}
[0m12:50:58.159598 [info ] [Thread-3 (]: 10 of 14 OK created sql view model dbt_dev_intermediate.int_sap__orders_not_sharing  [[32mCREATE VIEW[0m in 0.23s]
[0m12:50:58.160029 [debug] [Thread-3 (]: Finished running node model.frontier_analytics.int_sap__orders_not_sharing
[0m12:50:58.160796 [debug] [Thread-2 (]: Began running node model.frontier_analytics.int_sap__orders_combined
[0m12:50:58.161520 [info ] [Thread-2 (]: 13 of 14 START sql view model dbt_dev_intermediate.int_sap__orders_combined .... [RUN]
[0m12:50:58.162198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.int_crm__opportunities_expanded, now model.frontier_analytics.int_sap__orders_combined)
[0m12:50:58.162609 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.int_sap__orders_combined
[0m12:50:58.164981 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_combined"
[0m12:50:58.165822 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.int_sap__orders_combined
[0m12:50:58.167802 [debug] [Thread-2 (]: Writing runtime sql for node "model.frontier_analytics.int_sap__orders_combined"
[0m12:50:58.168235 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:50:58.168539 [debug] [Thread-2 (]: On model.frontier_analytics.int_sap__orders_combined: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_combined"} */

  create view "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_tmp"
    
    
  as (
    with not_sharing as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_not_sharing"

),

sharing as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_sharing"

),

profit_centres as (

    select * from "FBS_DB"."dbt_dev_staging"."stg_sap__profit_centres"

),

-- Union both streams together with matching columns
combined as (

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        employee_id,
        kam_profit_centre_code

    from not_sharing

    union all

    select
        order_id,
        order_number,
        order_date,
        customer_name,
        margin,
        sbu_code,
        order_type,
        block_code,
        customer_group_code,
        ld_cost,
        comments,
        subcategory,
        sharing_type,
        employee_id,
        kam_profit_centre_code

    from sharing

),

-- Join profit centres twice - once for block name, once for KAM name
-- This mirrors your original view joining OPRC twice with different aliases
enriched as (

    select
        c.order_id,
        c.order_number,
        c.order_date,
        c.customer_name,
        c.margin,
        c.sbu_code,
        c.order_type,
        c.ld_cost,
        c.comments,
        c.subcategory,
        c.sharing_type,
        c.employee_id,
        c.customer_group_code,
        block_pc.profit_centre_name   as block_name,
        kam_pc.profit_centre_name     as kam_name,

        -- Indian financial year quarter mapping
        case
            when extract(month from c.order_date) in (4,5,6)   then 'Q1'
            when extract(month from c.order_date) in (7,8,9)   then 'Q2'
            when extract(month from c.order_date) in (10,11,12) then 'Q3'
            when extract(month from c.order_date) in (1,2,3)   then 'Q4'
        end as financial_quarter,

        -- Month name mapping
        case extract(month from c.order_date)
            when 1  then 'January'
            when 2  then 'February'
            when 3  then 'March'
            when 4  then 'April'
            when 5  then 'May'
            when 6  then 'June'
            when 7  then 'July'
            when 8  then 'August'
            when 9  then 'September'
            when 10 then 'October'
            when 11 then 'November'
            when 12 then 'December'
        end as month_name,

        date_trunc('month', c.order_date) as order_month

    from combined c
    left join profit_centres block_pc
        on c.block_code = block_pc.profit_centre_code
    left join profit_centres kam_pc
        on c.kam_profit_centre_code = kam_pc.profit_centre_code

)

select * from enriched
  );
[0m12:50:58.168777 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:50:58.243923 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.075 seconds
[0m12:50:58.246438 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:50:58.246746 [debug] [Thread-2 (]: On model.frontier_analytics.int_sap__orders_combined: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_combined"} */
alter table "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_tmp" rename to "int_sap__orders_combined"
[0m12:50:58.250374 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:50:58.251320 [debug] [Thread-2 (]: On model.frontier_analytics.int_sap__orders_combined: COMMIT
[0m12:50:58.251549 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:50:58.251717 [debug] [Thread-2 (]: On model.frontier_analytics.int_sap__orders_combined: COMMIT
[0m12:50:58.255695 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m12:50:58.256913 [debug] [Thread-2 (]: Applying DROP to: "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_backup"
[0m12:50:58.257232 [debug] [Thread-2 (]: Using postgres connection "model.frontier_analytics.int_sap__orders_combined"
[0m12:50:58.257446 [debug] [Thread-2 (]: On model.frontier_analytics.int_sap__orders_combined: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.int_sap__orders_combined"} */
drop view if exists "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined__dbt_backup" cascade
[0m12:50:58.261775 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:50:58.262967 [debug] [Thread-2 (]: On model.frontier_analytics.int_sap__orders_combined: Close
[0m12:50:58.263371 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15a8112e0>]}
[0m12:50:58.263832 [info ] [Thread-2 (]: 13 of 14 OK created sql view model dbt_dev_intermediate.int_sap__orders_combined  [[32mCREATE VIEW[0m in 0.10s]
[0m12:50:58.264279 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.int_sap__orders_combined
[0m12:50:58.265175 [debug] [Thread-3 (]: Began running node model.frontier_analytics.mart_sap__sales_orders
[0m12:50:58.265813 [info ] [Thread-3 (]: 14 of 14 START sql table model dbt_dev_marts.mart_sap__sales_orders ............ [RUN]
[0m12:50:58.266224 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.int_sap__orders_not_sharing, now model.frontier_analytics.mart_sap__sales_orders)
[0m12:50:58.266473 [debug] [Thread-3 (]: Began compiling node model.frontier_analytics.mart_sap__sales_orders
[0m12:50:58.269004 [debug] [Thread-3 (]: Writing injected SQL for node "model.frontier_analytics.mart_sap__sales_orders"
[0m12:50:58.269439 [debug] [Thread-3 (]: Began executing node model.frontier_analytics.mart_sap__sales_orders
[0m12:50:58.271080 [debug] [Thread-3 (]: Writing runtime sql for node "model.frontier_analytics.mart_sap__sales_orders"
[0m12:50:58.271480 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:50:58.271746 [debug] [Thread-3 (]: On model.frontier_analytics.mart_sap__sales_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_sap__sales_orders"} */

  
    

  create  table "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (

    select * from "FBS_DB"."dbt_dev_intermediate"."int_sap__orders_combined"

),

sbu_mapping as (

    select * from "FBS_DB"."Excel_Data"."SBU_Name_Master"

),

account_type as (

    select * from "FBS_DB"."Excel_Data"."SAP_Account_Type_Mapping"

),

sbu_target as (

    select * from "FBS_DB"."Excel_Data"."SBU_Target"

),

final as (

    select distinct
        o.order_number              as so_number,
        o.comments                  as orn,
        o.order_id,
        o.order_date,
        o.order_month,
        o.margin,
        coalesce(sbu."SBU Name", o.sbu_code) as sbu,
        o.kam_name,
        o.block_name                as block,
        o.order_type,
        o.subcategory,
        o.customer_name,
        o.sharing_type,
        o.financial_quarter,
        o.month_name,
        o.ld_cost,
        o.employee_id,
        at."Final Ac Type"          as account_type,
        st."Region"                 as region

    from orders o

    left join sbu_mapping sbu
        on o.sbu_code = sbu."PrcName"

    left join account_type at
        on o.customer_group_code = at."SAP"

    left join sbu_target st
        on o.block_name = st."Block"

    where o.order_date >= case
        when extract(month from current_date) >= 4
            then (extract(year from current_date)::text || '-04-01')::date
        else ((extract(year from current_date) - 1)::text || '-04-01')::date
    end

    order by o.order_number

)

select * from final
  );
  
[0m12:50:58.271990 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:50:58.721036 [debug] [Thread-4 (]: SQL status: SELECT 6287 in 0.571 seconds
[0m12:50:58.726649 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:50:58.726951 [debug] [Thread-4 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */
alter table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline" rename to "mart_crm__pipeline__dbt_backup"
[0m12:50:58.732769 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:50:58.734646 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:50:58.734896 [debug] [Thread-4 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */
alter table "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_tmp" rename to "mart_crm__pipeline"
[0m12:50:58.737468 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:50:58.738310 [debug] [Thread-4 (]: On model.frontier_analytics.mart_crm__pipeline: COMMIT
[0m12:50:58.738512 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:50:58.738685 [debug] [Thread-4 (]: On model.frontier_analytics.mart_crm__pipeline: COMMIT
[0m12:50:58.743570 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m12:50:58.745337 [debug] [Thread-4 (]: Applying DROP to: "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_backup"
[0m12:50:58.747404 [debug] [Thread-4 (]: Using postgres connection "model.frontier_analytics.mart_crm__pipeline"
[0m12:50:58.747650 [debug] [Thread-4 (]: On model.frontier_analytics.mart_crm__pipeline: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_crm__pipeline"} */
drop table if exists "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline__dbt_backup" cascade
[0m12:50:58.779371 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.031 seconds
[0m12:50:58.780604 [debug] [Thread-4 (]: On model.frontier_analytics.mart_crm__pipeline: Close
[0m12:50:58.781005 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff158bd0f50>]}
[0m12:50:58.781383 [info ] [Thread-4 (]: 12 of 14 OK created sql table model dbt_dev_marts.mart_crm__pipeline ........... [[32mSELECT 6287[0m in 0.66s]
[0m12:50:58.781774 [debug] [Thread-4 (]: Finished running node model.frontier_analytics.mart_crm__pipeline
[0m12:50:59.562830 [debug] [Thread-3 (]: SQL status: SELECT 2010 in 1.291 seconds
[0m12:50:59.565664 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:50:59.565945 [debug] [Thread-3 (]: On model.frontier_analytics.mart_sap__sales_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_sap__sales_orders"} */
alter table "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders" rename to "mart_sap__sales_orders__dbt_backup"
[0m12:50:59.571365 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:50:59.573197 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:50:59.573413 [debug] [Thread-3 (]: On model.frontier_analytics.mart_sap__sales_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_sap__sales_orders"} */
alter table "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders__dbt_tmp" rename to "mart_sap__sales_orders"
[0m12:50:59.576351 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:50:59.577448 [debug] [Thread-3 (]: On model.frontier_analytics.mart_sap__sales_orders: COMMIT
[0m12:50:59.577695 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:50:59.577904 [debug] [Thread-3 (]: On model.frontier_analytics.mart_sap__sales_orders: COMMIT
[0m12:50:59.583268 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:50:59.584702 [debug] [Thread-3 (]: Applying DROP to: "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders__dbt_backup"
[0m12:50:59.585068 [debug] [Thread-3 (]: Using postgres connection "model.frontier_analytics.mart_sap__sales_orders"
[0m12:50:59.585254 [debug] [Thread-3 (]: On model.frontier_analytics.mart_sap__sales_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "model.frontier_analytics.mart_sap__sales_orders"} */
drop table if exists "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders__dbt_backup" cascade
[0m12:50:59.611019 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.025 seconds
[0m12:50:59.612238 [debug] [Thread-3 (]: On model.frontier_analytics.mart_sap__sales_orders: Close
[0m12:50:59.612725 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4343069f-317c-43ad-a8e5-b27a7c0095f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1566ddac0>]}
[0m12:50:59.613182 [info ] [Thread-3 (]: 14 of 14 OK created sql table model dbt_dev_marts.mart_sap__sales_orders ....... [[32mSELECT 2010[0m in 1.35s]
[0m12:50:59.613640 [debug] [Thread-3 (]: Finished running node model.frontier_analytics.mart_sap__sales_orders
[0m12:50:59.616808 [debug] [MainThread]: On master: COMMIT
[0m12:50:59.617136 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:59.617309 [debug] [MainThread]: On master: COMMIT
[0m12:50:59.617450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:59.802321 [debug] [MainThread]: SQL status: COMMIT in 0.185 seconds
[0m12:50:59.802674 [debug] [MainThread]: On master: Close
[0m12:50:59.802992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:59.803162 [debug] [MainThread]: Connection 'model.frontier_analytics.mart_sap__sales_orders' was properly closed.
[0m12:50:59.803303 [debug] [MainThread]: Connection 'model.frontier_analytics.int_sap__orders_sharing' was properly closed.
[0m12:50:59.803433 [debug] [MainThread]: Connection 'model.frontier_analytics.int_sap__orders_combined' was properly closed.
[0m12:50:59.803556 [debug] [MainThread]: Connection 'model.frontier_analytics.mart_crm__pipeline' was properly closed.
[0m12:50:59.803845 [info ] [MainThread]: 
[0m12:50:59.804171 [info ] [MainThread]: Finished running 2 table models, 12 view models in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m12:50:59.805633 [debug] [MainThread]: Command end result
[0m12:50:59.828891 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:50:59.832343 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:50:59.837457 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:50:59.837714 [info ] [MainThread]: 
[0m12:50:59.837992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:59.838247 [info ] [MainThread]: 
[0m12:50:59.838476 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m12:50:59.840621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.861161, "process_in_blocks": "91744", "process_kernel_time": 0.722454, "process_mem_max_rss": "127760", "process_out_blocks": "2744", "process_user_time": 2.186889}
[0m12:50:59.840974 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:59.840903 after 3.86 seconds
[0m12:50:59.841195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15ad65070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15b5ab0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15b085eb0>]}
[0m12:50:59.841405 [debug] [MainThread]: Flushing usage events
[0m12:51:01.032110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:22.020029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb5a8abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb67ed220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb5dd2120>]}


============================== 12:52:22.022215 | 16030ad9-d79f-4686-b0c8-1b6e44092c2a ==============================
[0m12:52:22.022215 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:52:22.022596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'quiet': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/suraj/frontier_analytics/logs', 'cache_selected_only': 'False', 'use_colors': 'True', 'debug': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/suraj/.dbt', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt test', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False'}
[0m12:52:22.138112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16030ad9-d79f-4686-b0c8-1b6e44092c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb57d3170>]}
[0m12:52:22.186856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16030ad9-d79f-4686-b0c8-1b6e44092c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb49678f0>]}
[0m12:52:22.187490 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:52:22.224742 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:52:22.290519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:52:22.290970 [debug] [MainThread]: Partial parsing: added file: frontier_analytics://models/marts/schema.yml
[0m12:52:22.418945 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_sap__sales_orders' in package 'frontier_analytics'
(models/marts/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m12:52:22.419509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '16030ad9-d79f-4686-b0c8-1b6e44092c2a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb35edf10>]}
[0m12:52:22.494691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16030ad9-d79f-4686-b0c8-1b6e44092c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb35354c0>]}
[0m12:52:22.551573 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:52:22.552877 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:52:22.575251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16030ad9-d79f-4686-b0c8-1b6e44092c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb2f2a720>]}
[0m12:52:22.575811 [info ] [MainThread]: Found 14 models, 8 data tests, 16 sources, 466 macros
[0m12:52:22.576328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16030ad9-d79f-4686-b0c8-1b6e44092c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb305b560>]}
[0m12:52:22.578484 [info ] [MainThread]: 
[0m12:52:22.578926 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:22.579175 [info ] [MainThread]: 
[0m12:52:22.579574 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:52:22.582745 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_staging'
[0m12:52:22.589624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_marts'
[0m12:52:22.596781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:52:22.664882 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:52:22.665329 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:52:22.665663 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:52:22.665912 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:52:22.666196 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:52:22.666452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:22.666696 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:52:22.666970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:22.667351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:22.770388 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.103 seconds
[0m12:52:22.771442 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:52:22.771826 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.105 seconds
[0m12:52:22.772596 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:52:22.772939 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.106 seconds
[0m12:52:22.773868 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:52:22.774389 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:52:22.775490 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:52:22.777117 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:52:22.782457 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:22.783032 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:52:22.783673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:22.968102 [debug] [MainThread]: SQL status: SELECT 90 in 0.184 seconds
[0m12:52:22.970892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16030ad9-d79f-4686-b0c8-1b6e44092c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb311be00>]}
[0m12:52:22.971156 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:22.973917 [debug] [MainThread]: On master: COMMIT
[0m12:52:22.974187 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:22.974364 [debug] [MainThread]: On master: COMMIT
[0m12:52:22.979543 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m12:52:22.979859 [debug] [MainThread]: On master: Close
[0m12:52:22.983816 [debug] [Thread-1 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:52:22.984153 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4  [RUN]
[0m12:52:22.984510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_intermediate, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e)
[0m12:52:22.984758 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:52:22.990399 [debug] [Thread-2 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:52:22.990949 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:52:22.991504 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:52:22.991866 [debug] [Thread-4 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:52:22.992275 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing  [RUN]
[0m12:52:22.992977 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_crm__pipeline_bottomline ....................... [RUN]
[0m12:52:22.993360 [info ] [Thread-4 (]: 4 of 8 START test not_null_mart_crm__pipeline_opportunity_id ................... [RUN]
[0m12:52:22.993970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f)
[0m12:52:22.994676 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_marts, now test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02)
[0m12:52:22.995584 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f'
[0m12:52:22.996252 [debug] [Thread-2 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:52:22.996917 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:52:22.997419 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:52:22.998103 [debug] [Thread-4 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:52:23.001064 [debug] [Thread-2 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:52:23.006010 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:52:23.014688 [debug] [Thread-4 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:52:23.021027 [debug] [Thread-1 (]: Writing runtime sql for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:52:23.021797 [debug] [Thread-2 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:52:23.022664 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:52:23.024369 [debug] [Thread-2 (]: Writing runtime sql for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:52:23.028508 [debug] [Thread-3 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:52:23.029384 [debug] [Thread-4 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:52:23.030018 [debug] [Thread-1 (]: Using postgres connection "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:52:23.030465 [debug] [Thread-2 (]: Using postgres connection "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:52:23.031916 [debug] [Thread-4 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:52:23.032383 [debug] [Thread-3 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:52:23.032759 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        financial_quarter as value_field,
        count(*) as n_records

    from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
    group by financial_quarter

)

select *
from all_values
where value_field not in (
    'Q1','Q2','Q3','Q4'
)



  
  
      
    ) dbt_internal_test
[0m12:52:23.033143 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sharing_type as value_field,
        count(*) as n_records

    from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
    group by sharing_type

)

select *
from all_values
where value_field not in (
    'Sharing','Not Sharing'
)



  
  
      
    ) dbt_internal_test
[0m12:52:23.033615 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bottomline
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where bottomline is null



  
  
      
    ) dbt_internal_test
[0m12:52:23.033993 [debug] [Thread-4 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:52:23.034346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:23.034696 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:52:23.035078 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:52:23.035430 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select opportunity_id
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where opportunity_id is null



  
  
      
    ) dbt_internal_test
[0m12:52:23.036453 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:52:23.117950 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.083 seconds
[0m12:52:23.120854 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: ROLLBACK
[0m12:52:23.121452 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.087 seconds
[0m12:52:23.122377 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: ROLLBACK
[0m12:52:23.122776 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.088 seconds
[0m12:52:23.123686 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: ROLLBACK
[0m12:52:23.124260 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.088 seconds
[0m12:52:23.124817 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: Close
[0m12:52:23.125271 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: Close
[0m12:52:23.126804 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: ROLLBACK
[0m12:52:23.127306 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: Close
[0m12:52:23.128274 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4  [[32mPASS[0m in 0.14s]
[0m12:52:23.128986 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing  [[32mPASS[0m in 0.14s]
[0m12:52:23.129783 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_crm__pipeline_bottomline ............................. [[32mPASS[0m in 0.14s]
[0m12:52:23.130345 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:52:23.130898 [debug] [Thread-2 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:52:23.131375 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:52:23.131811 [debug] [Thread-1 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:52:23.132238 [debug] [Thread-2 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:52:23.132719 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:52:23.133033 [info ] [Thread-1 (]: 5 of 8 START test not_null_mart_crm__pipeline_stage ............................ [RUN]
[0m12:52:23.133489 [info ] [Thread-2 (]: 6 of 8 START test not_null_mart_sap__sales_orders_margin ....................... [RUN]
[0m12:52:23.134359 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: Close
[0m12:52:23.134826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e, now test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37)
[0m12:52:23.133925 [info ] [Thread-3 (]: 7 of 8 START test not_null_mart_sap__sales_orders_order_id ..................... [RUN]
[0m12:52:23.135290 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f, now test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d)
[0m12:52:23.135616 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:52:23.135976 [info ] [Thread-4 (]: 4 of 8 PASS not_null_mart_crm__pipeline_opportunity_id ......................... [[32mPASS[0m in 0.14s]
[0m12:52:23.136349 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02, now test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec)
[0m12:52:23.136620 [debug] [Thread-2 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:52:23.139397 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:52:23.139928 [debug] [Thread-4 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:52:23.140250 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:52:23.144314 [debug] [Thread-2 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:52:23.145098 [debug] [Thread-4 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:52:23.148106 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:52:23.148589 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:52:23.149085 [info ] [Thread-4 (]: 8 of 8 START test not_null_mart_sap__sales_orders_so_number .................... [RUN]
[0m12:52:23.150091 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:52:23.150428 [debug] [Thread-2 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:52:23.151689 [debug] [Thread-1 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:52:23.152182 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f, now test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b)
[0m12:52:23.153389 [debug] [Thread-3 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:52:23.154645 [debug] [Thread-2 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:52:23.155411 [debug] [Thread-4 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:52:23.155843 [debug] [Thread-1 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:52:23.156557 [debug] [Thread-3 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:52:23.161044 [debug] [Thread-4 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:52:23.161798 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where stage is null



  
  
      
    ) dbt_internal_test
[0m12:52:23.162409 [debug] [Thread-2 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:52:23.162986 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:52:23.163592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:23.163962 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select margin
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where margin is null



  
  
      
    ) dbt_internal_test
[0m12:52:23.164313 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:52:23.165000 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:52:23.166029 [debug] [Thread-4 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:52:23.167875 [debug] [Thread-4 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:52:23.168328 [debug] [Thread-4 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:52:23.168561 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select so_number
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where so_number is null



  
  
      
    ) dbt_internal_test
[0m12:52:23.168757 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:52:23.245371 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.081 seconds
[0m12:52:23.246661 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: ROLLBACK
[0m12:52:23.247085 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.078 seconds
[0m12:52:23.247478 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.082 seconds
[0m12:52:23.248538 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: ROLLBACK
[0m12:52:23.249460 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: ROLLBACK
[0m12:52:23.250191 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: Close
[0m12:52:23.250759 [info ] [Thread-3 (]: 7 of 8 PASS not_null_mart_sap__sales_orders_order_id ........................... [[32mPASS[0m in 0.11s]
[0m12:52:23.251222 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:52:23.252103 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: Close
[0m12:52:23.252811 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: Close
[0m12:52:23.252570 [info ] [Thread-4 (]: 8 of 8 PASS not_null_mart_sap__sales_orders_so_number .......................... [[32mPASS[0m in 0.10s]
[0m12:52:23.253821 [debug] [Thread-4 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:52:23.253281 [info ] [Thread-2 (]: 6 of 8 PASS not_null_mart_sap__sales_orders_margin ............................. [[32mPASS[0m in 0.12s]
[0m12:52:23.254636 [debug] [Thread-2 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:52:23.343507 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.180 seconds
[0m12:52:23.345167 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: ROLLBACK
[0m12:52:23.347736 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: Close
[0m12:52:23.348208 [info ] [Thread-1 (]: 5 of 8 PASS not_null_mart_crm__pipeline_stage .................................. [[32mPASS[0m in 0.21s]
[0m12:52:23.348665 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:52:23.350983 [debug] [MainThread]: On master: COMMIT
[0m12:52:23.351312 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:23.351492 [debug] [MainThread]: On master: COMMIT
[0m12:52:23.351647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:23.417386 [debug] [MainThread]: SQL status: COMMIT in 0.066 seconds
[0m12:52:23.417827 [debug] [MainThread]: On master: Close
[0m12:52:23.418193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:23.418383 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d' was properly closed.
[0m12:52:23.418540 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec' was properly closed.
[0m12:52:23.418680 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37' was properly closed.
[0m12:52:23.418801 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b' was properly closed.
[0m12:52:23.419065 [info ] [MainThread]: 
[0m12:52:23.419356 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m12:52:23.420374 [debug] [MainThread]: Command end result
[0m12:52:23.436987 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:52:23.438330 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:52:23.443005 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:52:23.443304 [info ] [MainThread]: 
[0m12:52:23.443582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:23.443798 [info ] [MainThread]: 
[0m12:52:23.444018 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m12:52:23.444376 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:52:23.445158 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4683359, "process_in_blocks": "1848", "process_kernel_time": 0.14963, "process_mem_max_rss": "129408", "process_out_blocks": "3576", "process_user_time": 1.78559}
[0m12:52:23.445532 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:23.445456 after 1.47 seconds
[0m12:52:23.445760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb764c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb67caa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb67ca600>]}
[0m12:52:23.445979 [debug] [MainThread]: Flushing usage events
[0m12:52:24.420798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:01.471706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcef9029f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efceffd51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcef901f70>]}


============================== 12:53:01.474008 | 4018d196-2be7-4a24-a904-0fba8b8eee3c ==============================
[0m12:53:01.474008 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:53:01.474558 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'invocation_command': 'dbt test', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/home/suraj/frontier_analytics/logs', 'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/suraj/.dbt', 'log_cache_events': 'False', 'empty': 'None', 'debug': 'False', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False'}
[0m12:53:01.592657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4018d196-2be7-4a24-a904-0fba8b8eee3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf01304a0>]}
[0m12:53:01.640339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4018d196-2be7-4a24-a904-0fba8b8eee3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcee72baa0>]}
[0m12:53:01.641101 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:53:01.679414 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:53:01.758439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:01.759404 [debug] [MainThread]: Partial parsing: updated file: frontier_analytics://models/marts/schema.yml
[0m12:53:02.024390 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_sap__sales_orders' in package 'frontier_analytics'
(models/marts/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m12:53:02.025115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4018d196-2be7-4a24-a904-0fba8b8eee3c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efced3fc950>]}
[0m12:53:02.096268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4018d196-2be7-4a24-a904-0fba8b8eee3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcecfdd9a0>]}
[0m12:53:02.209247 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:53:02.210849 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:53:02.231317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4018d196-2be7-4a24-a904-0fba8b8eee3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcecf95010>]}
[0m12:53:02.231714 [info ] [MainThread]: Found 14 models, 8 data tests, 16 sources, 466 macros
[0m12:53:02.231984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4018d196-2be7-4a24-a904-0fba8b8eee3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf1c7cc80>]}
[0m12:53:02.233669 [info ] [MainThread]: 
[0m12:53:02.233983 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:53:02.234227 [info ] [MainThread]: 
[0m12:53:02.234599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:53:02.238752 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_staging'
[0m12:53:02.245968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:53:02.252430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_marts'
[0m12:53:02.272229 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:53:02.272612 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:53:02.272884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:02.273370 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:53:02.273773 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:53:02.274180 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:53:02.274503 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:53:02.274810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:02.275105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:02.360413 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.087 seconds
[0m12:53:02.363006 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:53:02.363938 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.089 seconds
[0m12:53:02.365279 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:53:02.365714 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.091 seconds
[0m12:53:02.366797 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:53:02.367169 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:53:02.368428 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:53:02.369188 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:53:02.373192 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:02.373455 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:53:02.373673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:02.453625 [debug] [MainThread]: SQL status: SELECT 90 in 0.080 seconds
[0m12:53:02.458294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4018d196-2be7-4a24-a904-0fba8b8eee3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcecf70620>]}
[0m12:53:02.458660 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:02.462728 [debug] [MainThread]: On master: COMMIT
[0m12:53:02.462973 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:02.463127 [debug] [MainThread]: On master: COMMIT
[0m12:53:02.467003 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m12:53:02.467231 [debug] [MainThread]: On master: Close
[0m12:53:02.471378 [debug] [Thread-1 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:53:02.471701 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4  [RUN]
[0m12:53:02.472078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_intermediate, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e)
[0m12:53:02.472356 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:53:02.472654 [debug] [Thread-2 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:53:02.478823 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing  [RUN]
[0m12:53:02.479262 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:02.481182 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:53:02.481649 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_marts, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f)
[0m12:53:02.481973 [debug] [Thread-4 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:02.482364 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_crm__pipeline_bottomline ....................... [RUN]
[0m12:53:02.482875 [debug] [Thread-2 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:53:02.483278 [info ] [Thread-4 (]: 4 of 8 START test not_null_mart_crm__pipeline_opportunity_id ................... [RUN]
[0m12:53:02.483948 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02)
[0m12:53:02.487033 [debug] [Thread-2 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:53:02.487380 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:53:02.487815 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f'
[0m12:53:02.488142 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:02.500186 [debug] [Thread-1 (]: Writing runtime sql for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:53:02.500689 [debug] [Thread-4 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:02.504772 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:53:02.505111 [debug] [Thread-2 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:53:02.507793 [debug] [Thread-4 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:53:02.508371 [debug] [Thread-1 (]: Using postgres connection "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:53:02.509986 [debug] [Thread-2 (]: Writing runtime sql for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:53:02.510482 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:02.511131 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        financial_quarter as value_field,
        count(*) as n_records

    from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
    group by financial_quarter

)

select *
from all_values
where value_field not in (
    'Q1','Q2','Q3','Q4'
)



  
  
      
    ) dbt_internal_test
[0m12:53:02.513360 [debug] [Thread-3 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:53:02.513837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:02.514159 [debug] [Thread-2 (]: Using postgres connection "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:53:02.514935 [debug] [Thread-4 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:02.515978 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sharing_type as value_field,
        count(*) as n_records

    from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
    group by sharing_type

)

select *
from all_values
where value_field not in (
    'Sharing','Not Sharing'
)



  
  
      
    ) dbt_internal_test
[0m12:53:02.517460 [debug] [Thread-4 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:53:02.517814 [debug] [Thread-3 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:53:02.518180 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:02.518613 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bottomline
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where bottomline is null



  
  
      
    ) dbt_internal_test
[0m12:53:02.519181 [debug] [Thread-4 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:53:02.519616 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:02.519937 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select opportunity_id
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where opportunity_id is null



  
  
      
    ) dbt_internal_test
[0m12:53:02.520401 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:53:02.590457 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.077 seconds
[0m12:53:02.594258 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: ROLLBACK
[0m12:53:02.594839 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.077 seconds
[0m12:53:02.596157 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: ROLLBACK
[0m12:53:02.597038 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.077 seconds
[0m12:53:02.598107 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: ROLLBACK
[0m12:53:02.598492 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.079 seconds
[0m12:53:02.599466 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: ROLLBACK
[0m12:53:02.599748 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: Close
[0m12:53:02.600082 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: Close
[0m12:53:02.600809 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4  [[32mPASS[0m in 0.13s]
[0m12:53:02.601490 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:53:02.602387 [debug] [Thread-1 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:02.602021 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing  [[32mPASS[0m in 0.12s]
[0m12:53:02.603402 [debug] [Thread-2 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:53:02.602982 [info ] [Thread-1 (]: 5 of 8 START test not_null_mart_crm__pipeline_stage ............................ [RUN]
[0m12:53:02.604161 [debug] [Thread-2 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:02.604617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e, now test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37)
[0m12:53:02.605024 [info ] [Thread-2 (]: 6 of 8 START test not_null_mart_sap__sales_orders_margin ....................... [RUN]
[0m12:53:02.605456 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:02.605875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f, now test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d)
[0m12:53:02.609101 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:53:02.609794 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: Close
[0m12:53:02.610200 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: Close
[0m12:53:02.610551 [debug] [Thread-2 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:02.611110 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:02.611623 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_crm__pipeline_bottomline ............................. [[32mPASS[0m in 0.13s]
[0m12:53:02.615373 [debug] [Thread-2 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:53:02.612289 [info ] [Thread-4 (]: 4 of 8 PASS not_null_mart_crm__pipeline_opportunity_id ......................... [[32mPASS[0m in 0.12s]
[0m12:53:02.618136 [debug] [Thread-1 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:53:02.618683 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:02.619290 [debug] [Thread-4 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:02.620072 [debug] [Thread-1 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:53:02.620399 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:02.620655 [debug] [Thread-2 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:02.621253 [debug] [Thread-4 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:02.621672 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where stage is null



  
  
      
    ) dbt_internal_test
[0m12:53:02.622029 [info ] [Thread-3 (]: 7 of 8 START test not_null_mart_sap__sales_orders_order_id ..................... [RUN]
[0m12:53:02.623546 [debug] [Thread-2 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:53:02.623991 [info ] [Thread-4 (]: 8 of 8 START test not_null_mart_sap__sales_orders_so_number .................... [RUN]
[0m12:53:02.624516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:02.625116 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02, now test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec)
[0m12:53:02.625989 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f, now test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b)
[0m12:53:02.626606 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:02.626948 [debug] [Thread-2 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:53:02.627325 [debug] [Thread-4 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:02.630463 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:53:02.630949 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select margin
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where margin is null



  
  
      
    ) dbt_internal_test
[0m12:53:02.633653 [debug] [Thread-4 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:53:02.634209 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:02.634761 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:02.635367 [debug] [Thread-4 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:02.636838 [debug] [Thread-3 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:53:02.638756 [debug] [Thread-4 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:53:02.639565 [debug] [Thread-4 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:53:02.639830 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select so_number
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where so_number is null



  
  
      
    ) dbt_internal_test
[0m12:53:02.640084 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:53:02.640693 [debug] [Thread-3 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:53:02.641456 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:53:02.641817 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:02.700290 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.076 seconds
[0m12:53:02.701881 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: ROLLBACK
[0m12:53:02.702623 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.068 seconds
[0m12:53:02.703545 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: ROLLBACK
[0m12:53:02.704073 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: Close
[0m12:53:02.704499 [info ] [Thread-1 (]: 5 of 8 PASS not_null_mart_crm__pipeline_stage .................................. [[32mPASS[0m in 0.10s]
[0m12:53:02.704928 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:02.705669 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: Close
[0m12:53:02.706073 [info ] [Thread-2 (]: 6 of 8 PASS not_null_mart_sap__sales_orders_margin ............................. [[32mPASS[0m in 0.10s]
[0m12:53:02.706454 [debug] [Thread-2 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:02.711533 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.071 seconds
[0m12:53:02.712707 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: ROLLBACK
[0m12:53:02.713693 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.072 seconds
[0m12:53:02.714654 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: ROLLBACK
[0m12:53:02.714984 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: Close
[0m12:53:02.715596 [info ] [Thread-4 (]: 8 of 8 PASS not_null_mart_sap__sales_orders_so_number .......................... [[32mPASS[0m in 0.09s]
[0m12:53:02.716012 [debug] [Thread-4 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:02.717403 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: Close
[0m12:53:02.717883 [info ] [Thread-3 (]: 7 of 8 PASS not_null_mart_sap__sales_orders_order_id ........................... [[32mPASS[0m in 0.09s]
[0m12:53:02.718277 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:02.720011 [debug] [MainThread]: On master: COMMIT
[0m12:53:02.720434 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:02.720673 [debug] [MainThread]: On master: COMMIT
[0m12:53:02.720857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:02.789659 [debug] [MainThread]: SQL status: COMMIT in 0.069 seconds
[0m12:53:02.789991 [debug] [MainThread]: On master: Close
[0m12:53:02.790323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:02.790492 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec' was properly closed.
[0m12:53:02.790631 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37' was properly closed.
[0m12:53:02.790759 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d' was properly closed.
[0m12:53:02.790885 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b' was properly closed.
[0m12:53:02.791072 [info ] [MainThread]: 
[0m12:53:02.791354 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m12:53:02.792667 [debug] [MainThread]: Command end result
[0m12:53:02.806103 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:53:02.807381 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:53:02.812473 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:53:02.812783 [info ] [MainThread]: 
[0m12:53:02.813076 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:02.813316 [info ] [MainThread]: 
[0m12:53:02.813700 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m12:53:02.814467 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:53:02.815354 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3870873, "process_in_blocks": "384", "process_kernel_time": 0.148186, "process_mem_max_rss": "134636", "process_out_blocks": "3568", "process_user_time": 1.886911}
[0m12:53:02.815670 [debug] [MainThread]: Command `dbt test` succeeded at 12:53:02.815601 after 1.39 seconds
[0m12:53:02.815906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcec1b84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcefb87e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efced3d19a0>]}
[0m12:53:02.816137 [debug] [MainThread]: Flushing usage events
[0m12:53:03.794379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:27.976418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f046f2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f06a06a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f061b7440>]}


============================== 12:53:27.979085 | 9792376f-fd06-4782-8bb2-3c8670b127ab ==============================
[0m12:53:27.979085 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:53:27.979490 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'False', 'profiles_dir': '/home/suraj/.dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt test --show-all-deprecations --no-partial-parse', 'static_parser': 'True', 'quiet': 'False', 'empty': 'None', 'use_colors': 'True', 'log_path': '/home/suraj/frontier_analytics/logs', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'debug': 'False'}
[0m12:53:28.091517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9792376f-fd06-4782-8bb2-3c8670b127ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f03c85f70>]}
[0m12:53:28.142727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9792376f-fd06-4782-8bb2-3c8670b127ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0688ecc0>]}
[0m12:53:28.143406 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:53:28.180998 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:53:28.181443 [debug] [MainThread]: Partial parsing not enabled
[0m12:53:28.929344 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_sap__sales_orders' in package 'frontier_analytics'
(models/marts/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m12:53:28.929812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9792376f-fd06-4782-8bb2-3c8670b127ab', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f01dc3a70>]}
[0m12:53:28.944782 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_sap__sales_orders' in package 'frontier_analytics'
(models/marts/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m12:53:28.945245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9792376f-fd06-4782-8bb2-3c8670b127ab', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f01d325d0>]}
[0m12:53:29.102148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9792376f-fd06-4782-8bb2-3c8670b127ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0210dca0>]}
[0m12:53:29.159669 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:53:29.161262 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:53:29.179822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9792376f-fd06-4782-8bb2-3c8670b127ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0198ce60>]}
[0m12:53:29.180229 [info ] [MainThread]: Found 14 models, 8 data tests, 16 sources, 466 macros
[0m12:53:29.180505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9792376f-fd06-4782-8bb2-3c8670b127ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0210fe30>]}
[0m12:53:29.182180 [info ] [MainThread]: 
[0m12:53:29.182488 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:53:29.182703 [info ] [MainThread]: 
[0m12:53:29.183050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:53:29.186385 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:53:29.187117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_staging'
[0m12:53:29.187999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_marts'
[0m12:53:29.217132 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:53:29.217547 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:53:29.217878 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:53:29.218168 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:53:29.218572 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:53:29.218894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:29.219166 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:53:29.219480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:29.220018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:29.309210 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.090 seconds
[0m12:53:29.310305 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:53:29.310644 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.091 seconds
[0m12:53:29.311620 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:53:29.312123 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:53:29.312597 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.093 seconds
[0m12:53:29.313329 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:53:29.314366 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:53:29.316050 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:53:29.319801 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:29.320040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:53:29.320225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:29.409778 [debug] [MainThread]: SQL status: SELECT 90 in 0.089 seconds
[0m12:53:29.412873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9792376f-fd06-4782-8bb2-3c8670b127ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0193a6c0>]}
[0m12:53:29.413158 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:29.415167 [debug] [MainThread]: On master: COMMIT
[0m12:53:29.415396 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:29.415550 [debug] [MainThread]: On master: COMMIT
[0m12:53:29.419047 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m12:53:29.419264 [debug] [MainThread]: On master: Close
[0m12:53:29.423886 [debug] [Thread-1 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:53:29.424294 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4  [RUN]
[0m12:53:29.424665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_intermediate, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e)
[0m12:53:29.426490 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:53:29.431577 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:53:29.432037 [debug] [Thread-2 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:53:29.432322 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing  [RUN]
[0m12:53:29.432742 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_marts, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f)
[0m12:53:29.433012 [debug] [Thread-2 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:53:29.435446 [debug] [Thread-2 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:53:29.436080 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:29.436389 [debug] [Thread-2 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:53:29.436743 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_crm__pipeline_bottomline ....................... [RUN]
[0m12:53:29.437133 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:53:29.437422 [debug] [Thread-4 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:29.449632 [debug] [Thread-2 (]: Writing runtime sql for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:53:29.450145 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02)
[0m12:53:29.451516 [debug] [Thread-1 (]: Writing runtime sql for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:53:29.451979 [info ] [Thread-4 (]: 4 of 8 START test not_null_mart_crm__pipeline_opportunity_id ................... [RUN]
[0m12:53:29.452469 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:29.452933 [debug] [Thread-2 (]: Using postgres connection "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:53:29.453531 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f'
[0m12:53:29.454002 [debug] [Thread-1 (]: Using postgres connection "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:53:29.459652 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:53:29.460196 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sharing_type as value_field,
        count(*) as n_records

    from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
    group by sharing_type

)

select *
from all_values
where value_field not in (
    'Sharing','Not Sharing'
)



  
  
      
    ) dbt_internal_test
[0m12:53:29.460652 [debug] [Thread-4 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:29.461028 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        financial_quarter as value_field,
        count(*) as n_records

    from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
    group by financial_quarter

)

select *
from all_values
where value_field not in (
    'Q1','Q2','Q3','Q4'
)



  
  
      
    ) dbt_internal_test
[0m12:53:29.461525 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:29.464161 [debug] [Thread-4 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:53:29.464549 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:29.465033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:29.468056 [debug] [Thread-3 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:53:29.468747 [debug] [Thread-4 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:29.470121 [debug] [Thread-4 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:53:29.470590 [debug] [Thread-4 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:53:29.470873 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select opportunity_id
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where opportunity_id is null



  
  
      
    ) dbt_internal_test
[0m12:53:29.471125 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:53:29.471531 [debug] [Thread-3 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:53:29.471846 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bottomline
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where bottomline is null



  
  
      
    ) dbt_internal_test
[0m12:53:29.472063 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:29.548985 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.084 seconds
[0m12:53:29.551893 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: ROLLBACK
[0m12:53:29.552488 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.081 seconds
[0m12:53:29.553354 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: ROLLBACK
[0m12:53:29.553708 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.082 seconds
[0m12:53:29.554441 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: ROLLBACK
[0m12:53:29.555028 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: Close
[0m12:53:29.555407 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4  [[32mPASS[0m in 0.13s]
[0m12:53:29.555779 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:53:29.556020 [debug] [Thread-1 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:29.556247 [info ] [Thread-1 (]: 5 of 8 START test not_null_mart_crm__pipeline_stage ............................ [RUN]
[0m12:53:29.556544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e, now test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37)
[0m12:53:29.556792 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:29.559848 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:53:29.560386 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: Close
[0m12:53:29.560703 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: Close
[0m12:53:29.561592 [info ] [Thread-4 (]: 4 of 8 PASS not_null_mart_crm__pipeline_opportunity_id ......................... [[32mPASS[0m in 0.11s]
[0m12:53:29.562460 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:29.562196 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_crm__pipeline_bottomline ............................. [[32mPASS[0m in 0.11s]
[0m12:53:29.563088 [debug] [Thread-4 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:29.564541 [debug] [Thread-1 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:53:29.565114 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:29.565459 [debug] [Thread-4 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:29.566241 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:29.566861 [debug] [Thread-1 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:53:29.567217 [info ] [Thread-4 (]: 6 of 8 START test not_null_mart_sap__sales_orders_margin ....................... [RUN]
[0m12:53:29.567946 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where stage is null



  
  
      
    ) dbt_internal_test
[0m12:53:29.567509 [info ] [Thread-3 (]: 7 of 8 START test not_null_mart_sap__sales_orders_order_id ..................... [RUN]
[0m12:53:29.568331 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f, now test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d)
[0m12:53:29.568605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:29.568898 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02, now test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec)
[0m12:53:29.569536 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:29.569169 [debug] [Thread-4 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:29.572103 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:53:29.575213 [debug] [Thread-4 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:53:29.575861 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:29.577488 [debug] [Thread-3 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:53:29.578145 [debug] [Thread-4 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:29.578506 [debug] [Thread-3 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:53:29.580081 [debug] [Thread-4 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:53:29.580556 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:53:29.581044 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:29.581598 [debug] [Thread-4 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:53:29.581833 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select margin
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where margin is null



  
  
      
    ) dbt_internal_test
[0m12:53:29.582028 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:53:29.650702 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.082 seconds
[0m12:53:29.651846 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: ROLLBACK
[0m12:53:29.654071 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: Close
[0m12:53:29.654506 [info ] [Thread-1 (]: 5 of 8 PASS not_null_mart_crm__pipeline_stage .................................. [[32mPASS[0m in 0.10s]
[0m12:53:29.654938 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:29.655190 [debug] [Thread-1 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:29.655418 [info ] [Thread-1 (]: 8 of 8 START test not_null_mart_sap__sales_orders_so_number .................... [RUN]
[0m12:53:29.655717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37, now test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b)
[0m12:53:29.655943 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:29.659031 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:53:29.660023 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:29.661818 [debug] [Thread-1 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:53:29.662328 [debug] [Thread-1 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:53:29.662562 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select so_number
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where so_number is null



  
  
      
    ) dbt_internal_test
[0m12:53:29.662789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:29.670637 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.209 seconds
[0m12:53:29.671636 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: ROLLBACK
[0m12:53:29.676406 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.094 seconds
[0m12:53:29.677537 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: ROLLBACK
[0m12:53:29.677995 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.097 seconds
[0m12:53:29.678505 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: Close
[0m12:53:29.679591 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: ROLLBACK
[0m12:53:29.680248 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing  [[32mPASS[0m in 0.25s]
[0m12:53:29.680917 [debug] [Thread-2 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:53:29.683600 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: Close
[0m12:53:29.684180 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: Close
[0m12:53:29.684642 [info ] [Thread-3 (]: 7 of 8 PASS not_null_mart_sap__sales_orders_order_id ........................... [[32mPASS[0m in 0.12s]
[0m12:53:29.685639 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:29.685080 [info ] [Thread-4 (]: 6 of 8 PASS not_null_mart_sap__sales_orders_margin ............................. [[32mPASS[0m in 0.12s]
[0m12:53:29.686331 [debug] [Thread-4 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:29.740041 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.077 seconds
[0m12:53:29.741329 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: ROLLBACK
[0m12:53:29.743561 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: Close
[0m12:53:29.744134 [info ] [Thread-1 (]: 8 of 8 PASS not_null_mart_sap__sales_orders_so_number .......................... [[32mPASS[0m in 0.09s]
[0m12:53:29.744601 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:29.746502 [debug] [MainThread]: On master: COMMIT
[0m12:53:29.746733 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:29.746884 [debug] [MainThread]: On master: COMMIT
[0m12:53:29.747016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:29.819143 [debug] [MainThread]: SQL status: COMMIT in 0.072 seconds
[0m12:53:29.819513 [debug] [MainThread]: On master: Close
[0m12:53:29.819800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:29.819954 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b' was properly closed.
[0m12:53:29.820079 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec' was properly closed.
[0m12:53:29.820193 [debug] [MainThread]: Connection 'test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f' was properly closed.
[0m12:53:29.820301 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d' was properly closed.
[0m12:53:29.820468 [info ] [MainThread]: 
[0m12:53:29.820737 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m12:53:29.821644 [debug] [MainThread]: Command end result
[0m12:53:29.837425 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:53:29.838828 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:53:29.843969 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:53:29.844304 [info ] [MainThread]: 
[0m12:53:29.844598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:29.844828 [info ] [MainThread]: 
[0m12:53:29.845118 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m12:53:29.845430 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
[0m12:53:29.846532 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9105402, "process_in_blocks": "8", "process_kernel_time": 0.070465, "process_mem_max_rss": "135944", "process_out_blocks": "3552", "process_user_time": 2.375696}
[0m12:53:29.846949 [debug] [MainThread]: Command `dbt test` succeeded at 12:53:29.846837 after 1.91 seconds
[0m12:53:29.847250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0492ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f031c2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f00143fb0>]}
[0m12:53:29.847640 [debug] [MainThread]: Flushing usage events
[0m12:53:30.812204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:56.552786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4aa65a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4ad9b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4a356120>]}


============================== 12:53:56.555529 | 9d64f37b-f2f0-4878-8893-e31f30f9368d ==============================
[0m12:53:56.555529 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:53:56.556001 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --no-partial-parse', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'partial_parse': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '/home/suraj/.dbt', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/suraj/frontier_analytics/logs', 'empty': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'quiet': 'False', 'introspect': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True'}
[0m12:53:56.681681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d64f37b-f2f0-4878-8893-e31f30f9368d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4c8d3710>]}
[0m12:53:56.732285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d64f37b-f2f0-4878-8893-e31f30f9368d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4c99ed20>]}
[0m12:53:56.732993 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:53:56.772127 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:53:56.772525 [debug] [MainThread]: Partial parsing not enabled
[0m12:53:57.669006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d64f37b-f2f0-4878-8893-e31f30f9368d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed47f04830>]}
[0m12:53:57.729302 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:53:57.730624 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:53:57.746931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d64f37b-f2f0-4878-8893-e31f30f9368d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4656c9b0>]}
[0m12:53:57.747372 [info ] [MainThread]: Found 14 models, 8 data tests, 16 sources, 466 macros
[0m12:53:57.747664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d64f37b-f2f0-4878-8893-e31f30f9368d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed465824b0>]}
[0m12:53:57.749629 [info ] [MainThread]: 
[0m12:53:57.750030 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:53:57.750280 [info ] [MainThread]: 
[0m12:53:57.750878 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:53:57.754255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:53:57.760694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_staging'
[0m12:53:57.769869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_marts'
[0m12:53:57.782810 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:53:57.783227 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:53:57.783560 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:53:57.783857 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:53:57.784244 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:53:57.784569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:57.784877 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:53:57.785180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:57.785626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:57.977903 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.193 seconds
[0m12:53:57.978972 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:53:57.979949 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.194 seconds
[0m12:53:57.981243 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:53:57.981601 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.196 seconds
[0m12:53:57.982675 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:53:57.983000 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:53:57.984190 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:53:57.985694 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:53:57.989904 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:57.990138 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:53:57.990362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:58.184778 [debug] [MainThread]: SQL status: SELECT 90 in 0.194 seconds
[0m12:53:58.187745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d64f37b-f2f0-4878-8893-e31f30f9368d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed46447b90>]}
[0m12:53:58.188051 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:58.190805 [debug] [MainThread]: On master: COMMIT
[0m12:53:58.191074 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:58.191246 [debug] [MainThread]: On master: COMMIT
[0m12:53:58.195272 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m12:53:58.195583 [debug] [MainThread]: On master: Close
[0m12:53:58.198341 [debug] [Thread-1 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0
[0m12:53:58.198670 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_mart_sap__sales_orders_financial_quarter ..... [RUN]
[0m12:53:58.199036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0)
[0m12:53:58.199285 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0
[0m12:53:58.204983 [debug] [Thread-2 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a
[0m12:53:58.205299 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_mart_sap__sales_orders_sharing_type .......... [RUN]
[0m12:53:58.205966 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_marts, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a)
[0m12:53:58.206231 [debug] [Thread-2 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a
[0m12:53:58.209540 [debug] [Thread-2 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a"
[0m12:53:58.210434 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:58.211178 [debug] [Thread-4 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:58.211518 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0"
[0m12:53:58.212337 [debug] [Thread-2 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a
[0m12:53:58.211911 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_crm__pipeline_bottomline ....................... [RUN]
[0m12:53:58.212729 [info ] [Thread-4 (]: 4 of 8 START test not_null_mart_crm__pipeline_opportunity_id ................... [RUN]
[0m12:53:58.221237 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0
[0m12:53:58.221891 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_intermediate, now test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02)
[0m12:53:58.228422 [debug] [Thread-2 (]: Writing runtime sql for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a"
[0m12:53:58.229064 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f'
[0m12:53:58.230642 [debug] [Thread-1 (]: Writing runtime sql for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0"
[0m12:53:58.231108 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:58.231578 [debug] [Thread-4 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:58.236652 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:53:58.239007 [debug] [Thread-4 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:53:58.239771 [debug] [Thread-1 (]: Using postgres connection "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0"
[0m12:53:58.240137 [debug] [Thread-2 (]: Using postgres connection "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a"
[0m12:53:58.241516 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:58.242354 [debug] [Thread-4 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:58.242890 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        financial_quarter as value_field,
        count(*) as n_records

    from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
    group by financial_quarter

)

select *
from all_values
where value_field not in (
    
)



  
  
      
    ) dbt_internal_test
[0m12:53:58.243481 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sharing_type as value_field,
        count(*) as n_records

    from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
    group by sharing_type

)

select *
from all_values
where value_field not in (
    
)



  
  
      
    ) dbt_internal_test
[0m12:53:58.246539 [debug] [Thread-3 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:53:58.248301 [debug] [Thread-4 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:53:58.249043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:58.249672 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:58.250827 [debug] [Thread-4 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:53:58.251191 [debug] [Thread-3 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:53:58.252150 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select opportunity_id
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where opportunity_id is null



  
  
      
    ) dbt_internal_test
[0m12:53:58.252595 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bottomline
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where bottomline is null



  
  
      
    ) dbt_internal_test
[0m12:53:58.252960 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:53:58.253309 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:58.327259 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 29: )
         ^

[0m12:53:58.327734 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0: ROLLBACK
[0m12:53:58.330224 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0: Close
[0m12:53:58.334036 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.081 seconds
[0m12:53:58.337059 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: ROLLBACK
[0m12:53:58.337545 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.084 seconds
[0m12:53:58.338711 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: ROLLBACK
[0m12:53:58.339738 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: Close
[0m12:53:58.340439 [info ] [Thread-4 (]: 4 of 8 PASS not_null_mart_crm__pipeline_opportunity_id ......................... [[32mPASS[0m in 0.11s]
[0m12:53:58.341203 [debug] [Thread-4 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:53:58.341810 [debug] [Thread-4 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:58.342174 [info ] [Thread-4 (]: 5 of 8 START test not_null_mart_crm__pipeline_stage ............................ [RUN]
[0m12:53:58.342622 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f, now test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37)
[0m12:53:58.343508 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: Close
[0m12:53:58.343820 [debug] [Thread-4 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:58.347036 [debug] [Thread-4 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:53:58.347500 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_crm__pipeline_bottomline ............................. [[32mPASS[0m in 0.13s]
[0m12:53:58.348398 [debug] [Thread-4 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:58.348901 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:53:58.350650 [debug] [Thread-4 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:53:58.351145 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:58.351821 [info ] [Thread-3 (]: 6 of 8 START test not_null_mart_sap__sales_orders_margin ....................... [RUN]
[0m12:53:58.352352 [debug] [Thread-4 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:53:58.352789 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02, now test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d)
[0m12:53:58.353328 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where stage is null



  
  
      
    ) dbt_internal_test
[0m12:53:58.353653 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:58.354274 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:53:58.358856 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:53:58.360171 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:58.361947 [debug] [Thread-1 (]: Database Error in test accepted_values_mart_sap__sales_orders_financial_quarter (models/marts/schema.yml)
  syntax error at or near ")"
  LINE 29: )
           ^
  compiled code at target/run/frontier_analytics/models/marts/schema.yml/accepted_values_mart_sap__sales_orders_financial_quarter.sql
[0m12:53:58.363831 [debug] [Thread-3 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:53:58.364313 [error] [Thread-1 (]: 1 of 8 ERROR accepted_values_mart_sap__sales_orders_financial_quarter .......... [[31mERROR[0m in 0.17s]
[0m12:53:58.364960 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0
[0m12:53:58.365260 [debug] [Thread-1 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:58.365593 [debug] [Thread-7 (]: Marking all children of 'test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_mart_sap__sales_orders_financial_quarter (models/marts/schema.yml)
  syntax error at or near ")"
  LINE 29: )
           ^
  compiled code at target/run/frontier_analytics/models/marts/schema.yml/accepted_values_mart_sap__sales_orders_financial_quarter.sql.
[0m12:53:58.365978 [info ] [Thread-1 (]: 7 of 8 START test not_null_mart_sap__sales_orders_order_id ..................... [RUN]
[0m12:53:58.366322 [debug] [Thread-3 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:53:58.367252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter.fbcfef48d0, now test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec)
[0m12:53:58.367555 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select margin
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where margin is null



  
  
      
    ) dbt_internal_test
[0m12:53:58.367865 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:58.368112 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:58.370755 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:53:58.371418 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:58.372690 [debug] [Thread-1 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:53:58.373102 [debug] [Thread-1 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:53:58.373337 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:53:58.374476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:58.443659 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 29: )
         ^

[0m12:53:58.444007 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a: ROLLBACK
[0m12:53:58.446297 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.078 seconds
[0m12:53:58.447405 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: ROLLBACK
[0m12:53:58.447873 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a: Close
[0m12:53:58.449338 [debug] [Thread-2 (]: Database Error in test accepted_values_mart_sap__sales_orders_sharing_type (models/marts/schema.yml)
  syntax error at or near ")"
  LINE 29: )
           ^
  compiled code at target/run/frontier_analytics/models/marts/schema.yml/accepted_values_mart_sap__sales_orders_sharing_type.sql
[0m12:53:58.449975 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: Close
[0m12:53:58.449744 [error] [Thread-2 (]: 2 of 8 ERROR accepted_values_mart_sap__sales_orders_sharing_type ............... [[31mERROR[0m in 0.24s]
[0m12:53:58.450572 [debug] [Thread-2 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a
[0m12:53:58.451288 [info ] [Thread-3 (]: 6 of 8 PASS not_null_mart_sap__sales_orders_margin ............................. [[32mPASS[0m in 0.10s]
[0m12:53:58.451731 [debug] [Thread-2 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:58.452061 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.078 seconds
[0m12:53:58.452607 [debug] [Thread-7 (]: Marking all children of 'test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_mart_sap__sales_orders_sharing_type (models/marts/schema.yml)
  syntax error at or near ")"
  LINE 29: )
           ^
  compiled code at target/run/frontier_analytics/models/marts/schema.yml/accepted_values_mart_sap__sales_orders_sharing_type.sql.
[0m12:53:58.453083 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:53:58.454357 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: ROLLBACK
[0m12:53:58.453392 [info ] [Thread-2 (]: 8 of 8 START test not_null_mart_sap__sales_orders_so_number .................... [RUN]
[0m12:53:58.455505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type.ed98a3d52a, now test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b)
[0m12:53:58.455736 [debug] [Thread-2 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:58.459164 [debug] [Thread-2 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:53:58.459840 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: Close
[0m12:53:58.461012 [debug] [Thread-2 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:58.460718 [info ] [Thread-1 (]: 7 of 8 PASS not_null_mart_sap__sales_orders_order_id ........................... [[32mPASS[0m in 0.09s]
[0m12:53:58.462788 [debug] [Thread-2 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:53:58.463240 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:53:58.464007 [debug] [Thread-2 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:53:58.464260 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select so_number
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where so_number is null



  
  
      
    ) dbt_internal_test
[0m12:53:58.464465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:58.537139 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.183 seconds
[0m12:53:58.538392 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: ROLLBACK
[0m12:53:58.538835 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.074 seconds
[0m12:53:58.539736 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: ROLLBACK
[0m12:53:58.540552 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: Close
[0m12:53:58.541072 [info ] [Thread-4 (]: 5 of 8 PASS not_null_mart_crm__pipeline_stage .................................. [[32mPASS[0m in 0.20s]
[0m12:53:58.541526 [debug] [Thread-4 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:53:58.542737 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: Close
[0m12:53:58.543369 [info ] [Thread-2 (]: 8 of 8 PASS not_null_mart_sap__sales_orders_so_number .......................... [[32mPASS[0m in 0.09s]
[0m12:53:58.544341 [debug] [Thread-2 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:53:58.546692 [debug] [MainThread]: On master: COMMIT
[0m12:53:58.547170 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:58.547461 [debug] [MainThread]: On master: COMMIT
[0m12:53:58.547870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:58.615717 [debug] [MainThread]: SQL status: COMMIT in 0.068 seconds
[0m12:53:58.616048 [debug] [MainThread]: On master: Close
[0m12:53:58.616330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:58.616485 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d' was properly closed.
[0m12:53:58.616605 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec' was properly closed.
[0m12:53:58.616714 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b' was properly closed.
[0m12:53:58.616820 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37' was properly closed.
[0m12:53:58.616983 [info ] [MainThread]: 
[0m12:53:58.617240 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m12:53:58.618219 [debug] [MainThread]: Command end result
[0m12:53:58.633778 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:53:58.635244 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:53:58.639114 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:53:58.639328 [info ] [MainThread]: 
[0m12:53:58.639588 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:53:58.639808 [info ] [MainThread]: 
[0m12:53:58.640083 [error] [MainThread]: [31mFailure in test accepted_values_mart_sap__sales_orders_financial_quarter (models/marts/schema.yml)[0m
[0m12:53:58.640467 [error] [MainThread]:   Database Error in test accepted_values_mart_sap__sales_orders_financial_quarter (models/marts/schema.yml)
  syntax error at or near ")"
  LINE 29: )
           ^
  compiled code at target/run/frontier_analytics/models/marts/schema.yml/accepted_values_mart_sap__sales_orders_financial_quarter.sql
[0m12:53:58.640688 [info ] [MainThread]: 
[0m12:53:58.640941 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/marts/schema.yml/accepted_values_mart_sap__sales_orders_financial_quarter.sql
[0m12:53:58.641181 [info ] [MainThread]: 
[0m12:53:58.641448 [error] [MainThread]: [31mFailure in test accepted_values_mart_sap__sales_orders_sharing_type (models/marts/schema.yml)[0m
[0m12:53:58.641683 [error] [MainThread]:   Database Error in test accepted_values_mart_sap__sales_orders_sharing_type (models/marts/schema.yml)
  syntax error at or near ")"
  LINE 29: )
           ^
  compiled code at target/run/frontier_analytics/models/marts/schema.yml/accepted_values_mart_sap__sales_orders_sharing_type.sql
[0m12:53:58.641936 [info ] [MainThread]: 
[0m12:53:58.642216 [info ] [MainThread]:   compiled code at target/compiled/frontier_analytics/models/marts/schema.yml/accepted_values_mart_sap__sales_orders_sharing_type.sql
[0m12:53:58.642508 [info ] [MainThread]: 
[0m12:53:58.642742 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=8
[0m12:53:58.643708 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.139328, "process_in_blocks": "416", "process_kernel_time": 0.219305, "process_mem_max_rss": "134884", "process_out_blocks": "3568", "process_user_time": 2.262836}
[0m12:53:58.644063 [debug] [MainThread]: Command `dbt test` failed at 12:53:58.643991 after 2.14 seconds
[0m12:53:58.644373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4a04a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed47b08800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4a6d88f0>]}
[0m12:53:58.644646 [debug] [MainThread]: Flushing usage events
[0m12:53:59.592331 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:58.686780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c3e10920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c3c0a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c3e13d70>]}


============================== 12:56:58.690790 | 0ac002c5-0af0-400b-8337-435fd3b73d31 ==============================
[0m12:56:58.690790 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:56:58.691499 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'log_path': '/home/suraj/frontier_analytics/logs', 'write_json': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'empty': 'None', 'profiles_dir': '/home/suraj/.dbt', 'partial_parse': 'False', 'printer_width': '80', 'debug': 'False', 'static_parser': 'True', 'no_print': 'None', 'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test --no-partial-parse'}
[0m12:56:58.814388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ac002c5-0af0-400b-8337-435fd3b73d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c606bbf0>]}
[0m12:56:58.866008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ac002c5-0af0-400b-8337-435fd3b73d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c34cf1d0>]}
[0m12:56:58.866622 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:56:58.908498 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:56:58.908956 [debug] [MainThread]: Partial parsing not enabled
[0m12:56:59.636820 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_sap__sales_orders' in package 'frontier_analytics'
(models/marts/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m12:56:59.637425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0ac002c5-0af0-400b-8337-435fd3b73d31', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c52b82f0>]}
[0m12:56:59.803025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ac002c5-0af0-400b-8337-435fd3b73d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c15f8080>]}
[0m12:56:59.862203 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:56:59.863522 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:56:59.879991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ac002c5-0af0-400b-8337-435fd3b73d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c1137d40>]}
[0m12:56:59.880364 [info ] [MainThread]: Found 14 models, 8 data tests, 16 sources, 466 macros
[0m12:56:59.880598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac002c5-0af0-400b-8337-435fd3b73d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c11c4080>]}
[0m12:56:59.882203 [info ] [MainThread]: 
[0m12:56:59.882553 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:59.882774 [info ] [MainThread]: 
[0m12:56:59.883149 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:59.886383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:56:59.892794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_staging'
[0m12:56:59.903968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_marts'
[0m12:56:59.918288 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:56:59.918667 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:56:59.919041 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:56:59.919318 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:56:59.919642 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:56:59.919924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:59.920301 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:56:59.920572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:59.921045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:00.026196 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.105 seconds
[0m12:57:00.027795 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:57:00.040211 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.120 seconds
[0m12:57:00.040656 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:57:00.041910 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:57:00.044752 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:57:00.114944 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.194 seconds
[0m12:57:00.115863 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:57:00.118025 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:57:00.122606 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:00.122948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:57:00.123170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:00.322181 [debug] [MainThread]: SQL status: SELECT 90 in 0.199 seconds
[0m12:57:00.326177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac002c5-0af0-400b-8337-435fd3b73d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c1137b00>]}
[0m12:57:00.326537 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:00.334690 [debug] [MainThread]: On master: COMMIT
[0m12:57:00.334932 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:00.335084 [debug] [MainThread]: On master: COMMIT
[0m12:57:00.339520 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m12:57:00.339820 [debug] [MainThread]: On master: Close
[0m12:57:00.343843 [debug] [Thread-1 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:57:00.344211 [debug] [Thread-2 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:57:00.344593 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4  [RUN]
[0m12:57:00.345271 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:57:00.345925 [debug] [Thread-4 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:57:00.346318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_intermediate, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e)
[0m12:57:00.345004 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing  [RUN]
[0m12:57:00.346896 [info ] [Thread-3 (]: 3 of 8 START test not_null_mart_crm__pipeline_bottomline ....................... [RUN]
[0m12:57:00.347267 [info ] [Thread-4 (]: 4 of 8 START test not_null_mart_crm__pipeline_opportunity_id ................... [RUN]
[0m12:57:00.347745 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:57:00.348090 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f)
[0m12:57:00.348498 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_marts, now test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02)
[0m12:57:00.348892 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f'
[0m12:57:00.355068 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:57:00.355565 [debug] [Thread-2 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:57:00.356044 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:57:00.356445 [debug] [Thread-4 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:57:00.359362 [debug] [Thread-2 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:57:00.364503 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:57:00.366985 [debug] [Thread-4 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:57:00.367375 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:57:00.368807 [debug] [Thread-2 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:57:00.380559 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:57:00.383108 [debug] [Thread-2 (]: Writing runtime sql for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:57:00.383642 [debug] [Thread-1 (]: Writing runtime sql for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:57:00.385017 [debug] [Thread-3 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:57:00.385318 [debug] [Thread-4 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:57:00.386061 [debug] [Thread-1 (]: Using postgres connection "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:57:00.386768 [debug] [Thread-2 (]: Using postgres connection "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:57:00.387258 [debug] [Thread-3 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:57:00.388960 [debug] [Thread-4 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:57:00.389644 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        financial_quarter as value_field,
        count(*) as n_records

    from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
    group by financial_quarter

)

select *
from all_values
where value_field not in (
    'Q1','Q2','Q3','Q4'
)



  
  
      
    ) dbt_internal_test
[0m12:57:00.390212 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sharing_type as value_field,
        count(*) as n_records

    from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
    group by sharing_type

)

select *
from all_values
where value_field not in (
    'Sharing','Not Sharing'
)



  
  
      
    ) dbt_internal_test
[0m12:57:00.390776 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select bottomline
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where bottomline is null



  
  
      
    ) dbt_internal_test
[0m12:57:00.391400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:00.391823 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:00.392193 [debug] [Thread-4 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:57:00.392551 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:00.393473 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select opportunity_id
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where opportunity_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:00.394105 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:57:00.480606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.089 seconds
[0m12:57:00.483524 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: ROLLBACK
[0m12:57:00.484056 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.091 seconds
[0m12:57:00.485137 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: ROLLBACK
[0m12:57:00.485541 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.091 seconds
[0m12:57:00.486149 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.094 seconds
[0m12:57:00.486478 [debug] [Thread-1 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e: Close
[0m12:57:00.487395 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: ROLLBACK
[0m12:57:00.487749 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02: Close
[0m12:57:00.488629 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: ROLLBACK
[0m12:57:00.489609 [info ] [Thread-3 (]: 3 of 8 PASS not_null_mart_crm__pipeline_bottomline ............................. [[32mPASS[0m in 0.14s]
[0m12:57:00.490516 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:57:00.490019 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4  [[32mPASS[0m in 0.14s]
[0m12:57:00.491043 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:57:00.491828 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:57:00.492252 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f: Close
[0m12:57:00.492658 [info ] [Thread-3 (]: 5 of 8 START test not_null_mart_crm__pipeline_stage ............................ [RUN]
[0m12:57:00.493242 [debug] [Thread-2 (]: On test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f: Close
[0m12:57:00.493651 [debug] [Thread-1 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:57:00.494519 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02, now test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37)
[0m12:57:00.494225 [info ] [Thread-4 (]: 4 of 8 PASS not_null_mart_crm__pipeline_opportunity_id ......................... [[32mPASS[0m in 0.15s]
[0m12:57:00.495169 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing  [[32mPASS[0m in 0.15s]
[0m12:57:00.495941 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:57:00.495607 [info ] [Thread-1 (]: 6 of 8 START test not_null_mart_sap__sales_orders_margin ....................... [RUN]
[0m12:57:00.496398 [debug] [Thread-4 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:57:00.496791 [debug] [Thread-2 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:57:00.499799 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:57:00.500191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e, now test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d)
[0m12:57:00.500571 [debug] [Thread-4 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:57:00.500900 [debug] [Thread-2 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:57:00.501314 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:57:00.501861 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:57:00.501637 [info ] [Thread-4 (]: 7 of 8 START test not_null_mart_sap__sales_orders_order_id ..................... [RUN]
[0m12:57:00.505462 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:57:00.502172 [info ] [Thread-2 (]: 8 of 8 START test not_null_mart_sap__sales_orders_so_number .................... [RUN]
[0m12:57:00.507852 [debug] [Thread-3 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:57:00.508299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f, now test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec)
[0m12:57:00.508781 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f, now test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b)
[0m12:57:00.509367 [debug] [Thread-4 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:57:00.509779 [debug] [Thread-3 (]: Using postgres connection "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:57:00.510037 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:57:00.510338 [debug] [Thread-2 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:57:00.512948 [debug] [Thread-4 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:57:00.513302 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage
from "FBS_DB"."dbt_dev_marts"."mart_crm__pipeline"
where stage is null



  
  
      
    ) dbt_internal_test
[0m12:57:00.514629 [debug] [Thread-1 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:57:00.517033 [debug] [Thread-2 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:57:00.517510 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:00.517941 [debug] [Thread-4 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:57:00.518441 [debug] [Thread-1 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:57:00.518951 [debug] [Thread-2 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:57:00.521821 [debug] [Thread-4 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:57:00.522487 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select margin
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where margin is null



  
  
      
    ) dbt_internal_test
[0m12:57:00.524328 [debug] [Thread-2 (]: Writing runtime sql for node "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:57:00.524818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:00.525914 [debug] [Thread-2 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:57:00.525435 [debug] [Thread-4 (]: Using postgres connection "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:57:00.526558 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select so_number
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where so_number is null



  
  
      
    ) dbt_internal_test
[0m12:57:00.526966 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "node_id": "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "FBS_DB"."dbt_dev_marts"."mart_sap__sales_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:00.527326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:00.527614 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:00.598025 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.080 seconds
[0m12:57:00.599116 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: ROLLBACK
[0m12:57:00.601187 [debug] [Thread-3 (]: On test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37: Close
[0m12:57:00.601625 [info ] [Thread-3 (]: 5 of 8 PASS not_null_mart_crm__pipeline_stage .................................. [[32mPASS[0m in 0.11s]
[0m12:57:00.602013 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:57:00.603068 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.078 seconds
[0m12:57:00.604216 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: ROLLBACK
[0m12:57:00.606397 [debug] [Thread-1 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d: Close
[0m12:57:00.606941 [info ] [Thread-1 (]: 6 of 8 PASS not_null_mart_sap__sales_orders_margin ............................. [[32mPASS[0m in 0.11s]
[0m12:57:00.607397 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.080 seconds
[0m12:57:00.607974 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:57:00.608292 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.081 seconds
[0m12:57:00.609703 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: ROLLBACK
[0m12:57:00.611114 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: ROLLBACK
[0m12:57:00.613296 [debug] [Thread-2 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b: Close
[0m12:57:00.613837 [info ] [Thread-2 (]: 8 of 8 PASS not_null_mart_sap__sales_orders_so_number .......................... [[32mPASS[0m in 0.11s]
[0m12:57:00.614244 [debug] [Thread-2 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:57:00.614771 [debug] [Thread-4 (]: On test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec: Close
[0m12:57:00.615231 [info ] [Thread-4 (]: 7 of 8 PASS not_null_mart_sap__sales_orders_order_id ........................... [[32mPASS[0m in 0.11s]
[0m12:57:00.615614 [debug] [Thread-4 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:57:00.617256 [debug] [MainThread]: On master: COMMIT
[0m12:57:00.617507 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:00.617681 [debug] [MainThread]: On master: COMMIT
[0m12:57:00.617850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:00.684017 [debug] [MainThread]: SQL status: COMMIT in 0.066 seconds
[0m12:57:00.684403 [debug] [MainThread]: On master: Close
[0m12:57:00.684723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:00.684936 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d' was properly closed.
[0m12:57:00.685085 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b' was properly closed.
[0m12:57:00.685215 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37' was properly closed.
[0m12:57:00.685345 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec' was properly closed.
[0m12:57:00.685510 [info ] [MainThread]: 
[0m12:57:00.685816 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m12:57:00.686711 [debug] [MainThread]: Command end result
[0m12:57:00.701392 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:57:00.702814 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:57:00.708248 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:57:00.708558 [info ] [MainThread]: 
[0m12:57:00.708793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:00.709031 [info ] [MainThread]: 
[0m12:57:00.709280 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m12:57:00.709678 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:57:00.710459 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0688338, "process_in_blocks": "0", "process_kernel_time": 0.127953, "process_mem_max_rss": "135660", "process_out_blocks": "3560", "process_user_time": 2.332698}
[0m12:57:00.710786 [debug] [MainThread]: Command `dbt test` succeeded at 12:57:00.710718 after 2.07 seconds
[0m12:57:00.711017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c3c0a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c11c40b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c4512810>]}
[0m12:57:00.711242 [debug] [MainThread]: Flushing usage events
[0m12:57:01.720988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:24.890004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a9f654f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ac3febd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a9c8fe00>]}


============================== 12:57:24.893556 | 5b79fc17-aa81-4754-881c-532873777587 ==============================
[0m12:57:24.893556 [info ] [MainThread]: Running with dbt=1.11.5
[0m12:57:24.894069 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_path': '/home/suraj/frontier_analytics/logs', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt docs generate', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'profiles_dir': '/home/suraj/.dbt', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error': 'None', 'quiet': 'False'}
[0m12:57:25.004317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b79fc17-aa81-4754-881c-532873777587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a982ca40>]}
[0m12:57:25.052192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b79fc17-aa81-4754-881c-532873777587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ab7a9e20>]}
[0m12:57:25.052823 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:57:25.091906 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m12:57:25.169658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:25.169981 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:57:25.170405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:25.201497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b79fc17-aa81-4754-881c-532873777587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a83d1c10>]}
[0m12:57:25.216804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b79fc17-aa81-4754-881c-532873777587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a772e570>]}
[0m12:57:25.217335 [info ] [MainThread]: Found 14 models, 8 data tests, 16 sources, 466 macros
[0m12:57:25.217758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b79fc17-aa81-4754-881c-532873777587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a7f83140>]}
[0m12:57:25.219700 [info ] [MainThread]: 
[0m12:57:25.220145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:57:25.220645 [info ] [MainThread]: 
[0m12:57:25.221106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:25.226188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_intermediate'
[0m12:57:25.234860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_marts'
[0m12:57:25.244704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_FBS_DB_dbt_dev_staging'
[0m12:57:25.260827 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_marts"
[0m12:57:25.261255 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_intermediate"
[0m12:57:25.261603 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_marts"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_marts'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_marts'
  
[0m12:57:25.261897 [debug] [ThreadPool]: Using postgres connection "list_FBS_DB_dbt_dev_staging"
[0m12:57:25.262246 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_intermediate"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_intermediate'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_intermediate'
  
[0m12:57:25.262570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:25.262838 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "list_FBS_DB_dbt_dev_staging"} */
select
      'FBS_DB' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev_staging'
    union all
    select
      'FBS_DB' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_dev_staging'
  
[0m12:57:25.263081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:25.263460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:25.357589 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.094 seconds
[0m12:57:25.358693 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: ROLLBACK
[0m12:57:25.360416 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.097 seconds
[0m12:57:25.361206 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: ROLLBACK
[0m12:57:25.364633 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_intermediate: Close
[0m12:57:25.365195 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_staging: Close
[0m12:57:25.440123 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.177 seconds
[0m12:57:25.441223 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: ROLLBACK
[0m12:57:25.443761 [debug] [ThreadPool]: On list_FBS_DB_dbt_dev_marts: Close
[0m12:57:25.447962 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:25.448208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:57:25.448397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:25.528516 [debug] [MainThread]: SQL status: SELECT 90 in 0.080 seconds
[0m12:57:25.531619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b79fc17-aa81-4754-881c-532873777587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a8bdbce0>]}
[0m12:57:25.531900 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:25.534697 [debug] [MainThread]: On master: Close
[0m12:57:25.539475 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_crm__companies
[0m12:57:25.539932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_marts, now model.frontier_analytics.stg_crm__companies)
[0m12:57:25.540234 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_crm__companies
[0m12:57:25.544531 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__companies"
[0m12:57:25.545041 [debug] [Thread-2 (]: Began running node model.frontier_analytics.stg_crm__custom_captions
[0m12:57:25.547799 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_staging, now model.frontier_analytics.stg_crm__custom_captions)
[0m12:57:25.548136 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.stg_crm__custom_captions
[0m12:57:25.550087 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__custom_captions"
[0m12:57:25.550793 [debug] [Thread-3 (]: Began running node model.frontier_analytics.stg_crm__opportunities
[0m12:57:25.551476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_FBS_DB_dbt_dev_intermediate, now model.frontier_analytics.stg_crm__opportunities)
[0m12:57:25.551862 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_crm__companies
[0m12:57:25.552174 [debug] [Thread-4 (]: Began running node model.frontier_analytics.stg_crm__users
[0m12:57:25.552657 [debug] [Thread-3 (]: Began compiling node model.frontier_analytics.stg_crm__opportunities
[0m12:57:25.552962 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.stg_crm__custom_captions
[0m12:57:25.553606 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_crm__companies
[0m12:57:25.554096 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.frontier_analytics.stg_crm__users'
[0m12:57:25.557425 [debug] [Thread-3 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__opportunities"
[0m12:57:25.558433 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.stg_crm__custom_captions
[0m12:57:25.559056 [debug] [Thread-1 (]: Began running node model.frontier_analytics.stg_sap__margin_sharing
[0m12:57:25.559596 [debug] [Thread-4 (]: Began compiling node model.frontier_analytics.stg_crm__users
[0m12:57:25.560187 [debug] [Thread-2 (]: Began running node model.frontier_analytics.stg_sap__order_lines
[0m12:57:25.560877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__companies, now model.frontier_analytics.stg_sap__margin_sharing)
[0m12:57:25.561282 [debug] [Thread-3 (]: Began executing node model.frontier_analytics.stg_crm__opportunities
[0m12:57:25.563183 [debug] [Thread-4 (]: Writing injected SQL for node "model.frontier_analytics.stg_crm__users"
[0m12:57:25.563670 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__custom_captions, now model.frontier_analytics.stg_sap__order_lines)
[0m12:57:25.564017 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.stg_sap__margin_sharing
[0m12:57:25.564545 [debug] [Thread-3 (]: Finished running node model.frontier_analytics.stg_crm__opportunities
[0m12:57:25.564997 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.stg_sap__order_lines
[0m12:57:25.566776 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__margin_sharing"
[0m12:57:25.567077 [debug] [Thread-4 (]: Began executing node model.frontier_analytics.stg_crm__users
[0m12:57:25.567476 [debug] [Thread-3 (]: Began running node model.frontier_analytics.stg_sap__orders
[0m12:57:25.568978 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__order_lines"
[0m12:57:25.569646 [debug] [Thread-4 (]: Finished running node model.frontier_analytics.stg_crm__users
[0m12:57:25.570127 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.stg_sap__margin_sharing
[0m12:57:25.570554 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__opportunities, now model.frontier_analytics.stg_sap__orders)
[0m12:57:25.571270 [debug] [Thread-4 (]: Began running node model.frontier_analytics.stg_sap__profit_centres
[0m12:57:25.571853 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.stg_sap__order_lines
[0m12:57:25.572457 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.stg_sap__margin_sharing
[0m12:57:25.572800 [debug] [Thread-3 (]: Began compiling node model.frontier_analytics.stg_sap__orders
[0m12:57:25.573131 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_crm__users, now model.frontier_analytics.stg_sap__profit_centres)
[0m12:57:25.573733 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.stg_sap__order_lines
[0m12:57:25.574066 [debug] [Thread-1 (]: Began running node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:57:25.576139 [debug] [Thread-3 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__orders"
[0m12:57:25.576598 [debug] [Thread-4 (]: Began compiling node model.frontier_analytics.stg_sap__profit_centres
[0m12:57:25.577232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_sap__margin_sharing, now model.frontier_analytics.int_crm__opportunities_expanded)
[0m12:57:25.579220 [debug] [Thread-4 (]: Writing injected SQL for node "model.frontier_analytics.stg_sap__profit_centres"
[0m12:57:25.579637 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:57:25.582263 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.int_crm__opportunities_expanded"
[0m12:57:25.582571 [debug] [Thread-4 (]: Began executing node model.frontier_analytics.stg_sap__profit_centres
[0m12:57:25.583414 [debug] [Thread-4 (]: Finished running node model.frontier_analytics.stg_sap__profit_centres
[0m12:57:25.583705 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:57:25.584093 [debug] [Thread-3 (]: Began executing node model.frontier_analytics.stg_sap__orders
[0m12:57:25.584647 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.int_crm__opportunities_expanded
[0m12:57:25.585131 [debug] [Thread-3 (]: Finished running node model.frontier_analytics.stg_sap__orders
[0m12:57:25.585652 [debug] [Thread-2 (]: Began running node model.frontier_analytics.mart_crm__pipeline
[0m12:57:25.586295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_sap__order_lines, now model.frontier_analytics.mart_crm__pipeline)
[0m12:57:25.586659 [debug] [Thread-1 (]: Began running node model.frontier_analytics.int_sap__orders_not_sharing
[0m12:57:25.587089 [debug] [Thread-4 (]: Began running node model.frontier_analytics.int_sap__orders_sharing
[0m12:57:25.587505 [debug] [Thread-2 (]: Began compiling node model.frontier_analytics.mart_crm__pipeline
[0m12:57:25.587835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.int_crm__opportunities_expanded, now model.frontier_analytics.int_sap__orders_not_sharing)
[0m12:57:25.588148 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_sap__profit_centres, now model.frontier_analytics.int_sap__orders_sharing)
[0m12:57:25.590691 [debug] [Thread-2 (]: Writing injected SQL for node "model.frontier_analytics.mart_crm__pipeline"
[0m12:57:25.591157 [debug] [Thread-1 (]: Began compiling node model.frontier_analytics.int_sap__orders_not_sharing
[0m12:57:25.591610 [debug] [Thread-4 (]: Began compiling node model.frontier_analytics.int_sap__orders_sharing
[0m12:57:25.594041 [debug] [Thread-1 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_not_sharing"
[0m12:57:25.596371 [debug] [Thread-4 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_sharing"
[0m12:57:25.596685 [debug] [Thread-2 (]: Began executing node model.frontier_analytics.mart_crm__pipeline
[0m12:57:25.597478 [debug] [Thread-1 (]: Began executing node model.frontier_analytics.int_sap__orders_not_sharing
[0m12:57:25.597731 [debug] [Thread-4 (]: Began executing node model.frontier_analytics.int_sap__orders_sharing
[0m12:57:25.598457 [debug] [Thread-2 (]: Finished running node model.frontier_analytics.mart_crm__pipeline
[0m12:57:25.599021 [debug] [Thread-1 (]: Finished running node model.frontier_analytics.int_sap__orders_not_sharing
[0m12:57:25.599507 [debug] [Thread-4 (]: Finished running node model.frontier_analytics.int_sap__orders_sharing
[0m12:57:25.600431 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:57:25.600738 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.stg_sap__orders, now test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02)
[0m12:57:25.600989 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:57:25.601258 [debug] [Thread-2 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:57:25.609866 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02"
[0m12:57:25.610417 [debug] [Thread-1 (]: Began running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:57:25.610825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.mart_crm__pipeline, now test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f)
[0m12:57:25.611184 [debug] [Thread-4 (]: Began running node model.frontier_analytics.int_sap__orders_combined
[0m12:57:25.611714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.int_sap__orders_not_sharing, now test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37)
[0m12:57:25.612145 [debug] [Thread-2 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:57:25.612409 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:57:25.612791 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.int_sap__orders_sharing, now model.frontier_analytics.int_sap__orders_combined)
[0m12:57:25.613108 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:57:25.616814 [debug] [Thread-2 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f"
[0m12:57:25.617344 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02
[0m12:57:25.617732 [debug] [Thread-4 (]: Began compiling node model.frontier_analytics.int_sap__orders_combined
[0m12:57:25.619818 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37"
[0m12:57:25.623386 [debug] [Thread-4 (]: Writing injected SQL for node "model.frontier_analytics.int_sap__orders_combined"
[0m12:57:25.624148 [debug] [Thread-2 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:57:25.624767 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:57:25.625652 [debug] [Thread-2 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f
[0m12:57:25.626429 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37
[0m12:57:25.626911 [debug] [Thread-4 (]: Began executing node model.frontier_analytics.int_sap__orders_combined
[0m12:57:25.627809 [debug] [Thread-4 (]: Finished running node model.frontier_analytics.int_sap__orders_combined
[0m12:57:25.628797 [debug] [Thread-3 (]: Began running node model.frontier_analytics.mart_sap__sales_orders
[0m12:57:25.629084 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_bottomline.bb0ad7aa02, now model.frontier_analytics.mart_sap__sales_orders)
[0m12:57:25.629313 [debug] [Thread-3 (]: Began compiling node model.frontier_analytics.mart_sap__sales_orders
[0m12:57:25.631436 [debug] [Thread-3 (]: Writing injected SQL for node "model.frontier_analytics.mart_sap__sales_orders"
[0m12:57:25.631824 [debug] [Thread-3 (]: Began executing node model.frontier_analytics.mart_sap__sales_orders
[0m12:57:25.632258 [debug] [Thread-3 (]: Finished running node model.frontier_analytics.mart_sap__sales_orders
[0m12:57:25.633187 [debug] [Thread-1 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:57:25.633477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_stage.8125fe3e37, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e)
[0m12:57:25.633720 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:57:25.639519 [debug] [Thread-4 (]: Began running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:57:25.640858 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e"
[0m12:57:25.641283 [debug] [Thread-2 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:57:25.641701 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.int_sap__orders_combined, now test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f)
[0m12:57:25.642358 [debug] [Thread-3 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:57:25.642999 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:57:25.643404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.not_null_mart_crm__pipeline_opportunity_id.32fb96ac7f, now test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d)
[0m12:57:25.643775 [debug] [Thread-4 (]: Began compiling node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:57:25.644153 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.frontier_analytics.mart_sap__sales_orders, now test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec)
[0m12:57:25.644693 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e
[0m12:57:25.645114 [debug] [Thread-2 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:57:25.648234 [debug] [Thread-4 (]: Writing injected SQL for node "test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f"
[0m12:57:25.648677 [debug] [Thread-3 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:57:25.649061 [debug] [Thread-1 (]: Began running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:57:25.651201 [debug] [Thread-2 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d"
[0m12:57:25.653791 [debug] [Thread-3 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec"
[0m12:57:25.654311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.frontier_analytics.accepted_values_mart_sap__sales_orders_financial_quarter__Q1__Q2__Q3__Q4.d9e86aa47e, now test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b)
[0m12:57:25.654655 [debug] [Thread-4 (]: Began executing node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:57:25.655203 [debug] [Thread-2 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:57:25.655685 [debug] [Thread-1 (]: Began compiling node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:57:25.656261 [debug] [Thread-4 (]: Finished running node test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f
[0m12:57:25.656673 [debug] [Thread-3 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:57:25.657240 [debug] [Thread-2 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d
[0m12:57:25.660078 [debug] [Thread-1 (]: Writing injected SQL for node "test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b"
[0m12:57:25.661118 [debug] [Thread-3 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec
[0m12:57:25.662258 [debug] [Thread-1 (]: Began executing node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:57:25.662672 [debug] [Thread-1 (]: Finished running node test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b
[0m12:57:25.664040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:25.664338 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_order_id.b4293b35ec' was properly closed.
[0m12:57:25.664578 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_so_number.b4d781a87b' was properly closed.
[0m12:57:25.664804 [debug] [MainThread]: Connection 'test.frontier_analytics.not_null_mart_sap__sales_orders_margin.28f326ce2d' was properly closed.
[0m12:57:25.665139 [debug] [MainThread]: Connection 'test.frontier_analytics.accepted_values_mart_sap__sales_orders_sharing_type__Sharing__Not_Sharing.e2881c2f1f' was properly closed.
[0m12:57:25.666812 [debug] [MainThread]: Command end result
[0m12:57:25.725457 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:57:25.726832 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:57:25.731497 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/suraj/frontier_analytics/target/run_results.json
[0m12:57:25.735766 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:57:25.736015 [info ] [MainThread]: Building catalog
[0m12:57:25.746416 [debug] [ThreadPool]: Acquiring new postgres connection 'FBS_DB.information_schema'
[0m12:57:25.751439 [debug] [ThreadPool]: Using postgres connection "FBS_DB.information_schema"
[0m12:57:25.751824 [debug] [ThreadPool]: On FBS_DB.information_schema: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "frontier_analytics", "target_name": "dev", "connection_name": "FBS_DB.information_schema"} */

    
    

    select
        'FBS_DB' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('CRM') and
           upper(tbl.relname) = upper('Company')) or (upper(sch.nspname) = upper('dbt_dev_intermediate') and
           upper(tbl.relname) = upper('int_crm__opportunities_expanded')) or (upper(sch.nspname) = upper('dbt_dev_staging') and
           upper(tbl.relname) = upper('stg_crm__opportunities')) or (upper(sch.nspname) = upper('Excel_Data') and
           upper(tbl.relname) = upper('SBU_Name_Master')) or (upper(sch.nspname) = upper('dbt_dev_staging') and
           upper(tbl.relname) = upper('stg_sap__orders')) or (upper(sch.nspname) = upper('SAP') and
           upper(tbl.relname) = upper('RDR1')) or (upper(sch.nspname) = upper('Excel_Data') and
           upper(tbl.relname) = upper('KAM_Target')) or (upper(sch.nspname) = upper('Excel_Data') and
           upper(tbl.relname) = upper('CRM_Account_Type_Mapping')) or (upper(sch.nspname) = upper('dbt_dev_marts') and
           upper(tbl.relname) = upper('mart_crm__pipeline')) or (upper(sch.nspname) = upper('SAP') and
           upper(tbl.relname) = upper('OITM')) or (upper(sch.nspname) = upper('dbt_dev_staging') and
           upper(tbl.relname) = upper('stg_crm__custom_captions')) or (upper(sch.nspname) = upper('SAP') and
           upper(tbl.relname) = upper('OPRC')) or (upper(sch.nspname) = upper('Excel_Data') and
           upper(tbl.relname) = upper('SAP_Account_Type_Mapping')) or (upper(sch.nspname) = upper('CRM') and
           upper(tbl.relname) = upper('Lead')) or (upper(sch.nspname) = upper('dbt_dev_staging') and
           upper(tbl.relname) = upper('stg_sap__order_lines')) or (upper(sch.nspname) = upper('dbt_dev_staging') and
           upper(tbl.relname) = upper('stg_sap__margin_sharing')) or (upper(sch.nspname) = upper('Excel_Data') and
           upper(tbl.relname) = upper('SAP_Block_Master_Table')) or (upper(sch.nspname) = upper('CRM') and
           upper(tbl.relname) = upper('Users')) or (upper(sch.nspname) = upper('dbt_dev_staging') and
           upper(tbl.relname) = upper('stg_crm__users')) or (upper(sch.nspname) = upper('Excel_Data') and
           upper(tbl.relname) = upper('SBU_Target')) or (upper(sch.nspname) = upper('CRM') and
           upper(tbl.relname) = upper('Custom_Captions')) or (upper(sch.nspname) = upper('dbt_dev_marts') and
           upper(tbl.relname) = upper('mart_sap__sales_orders')) or (upper(sch.nspname) = upper('SAP') and
           upper(tbl.relname) = upper('@F_MARGINSHARING')) or (upper(sch.nspname) = upper('dbt_dev_intermediate') and
           upper(tbl.relname) = upper('int_sap__orders_not_sharing')) or (upper(sch.nspname) = upper('dbt_dev_staging') and
           upper(tbl.relname) = upper('stg_sap__profit_centres')) or (upper(sch.nspname) = upper('dbt_dev_intermediate') and
           upper(tbl.relname) = upper('int_sap__orders_sharing')) or (upper(sch.nspname) = upper('CRM') and
           upper(tbl.relname) = upper('Opportunity')) or (upper(sch.nspname) = upper('SAP') and
           upper(tbl.relname) = upper('ORDR')) or (upper(sch.nspname) = upper('dbt_dev_intermediate') and
           upper(tbl.relname) = upper('int_sap__orders_combined')) or (upper(sch.nspname) = upper('dbt_dev_staging') and
           upper(tbl.relname) = upper('stg_crm__companies')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:57:25.752125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:25.877183 [debug] [ThreadPool]: SQL status: SELECT 2009 in 0.125 seconds
[0m12:57:25.954353 [debug] [ThreadPool]: On FBS_DB.information_schema: ROLLBACK
[0m12:57:25.957212 [debug] [ThreadPool]: On FBS_DB.information_schema: Close
[0m12:57:26.016566 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/suraj/frontier_analytics/target/catalog.json
[0m12:57:26.031934 [debug] [MainThread]: Wrote artifact WritableManifest to /home/suraj/frontier_analytics/target/manifest.json
[0m12:57:26.033203 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/suraj/frontier_analytics/target/semantic_manifest.json
[0m12:57:26.033472 [info ] [MainThread]: Catalog written to /home/suraj/frontier_analytics/target/catalog.json
[0m12:57:26.034797 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.1886916, "process_in_blocks": "3664", "process_kernel_time": 0.162443, "process_mem_max_rss": "125452", "process_out_blocks": "6488", "process_user_time": 1.614286}
[0m12:57:26.035176 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:57:26.035102 after 1.19 seconds
[0m12:57:26.035378 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:57:26.035539 [debug] [MainThread]: Connection 'FBS_DB.information_schema' was properly closed.
[0m12:57:26.035808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a551e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a8b7fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a9e2fbc0>]}
[0m12:57:26.036045 [debug] [MainThread]: Flushing usage events
[0m12:57:27.001198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:55.504973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448e465f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448eb90560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448eb92630>]}


============================== 13:02:55.509677 | 0175a5d9-c43c-4b49-b15c-715080f57029 ==============================
[0m13:02:55.509677 [info ] [MainThread]: Running with dbt=1.11.5
[0m13:02:55.510101 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt docs serve --port 8080', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'log_format': 'default', 'warn_error': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'profiles_dir': '/home/suraj/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_path': '/home/suraj/frontier_analytics/logs'}
[0m13:02:55.675603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0175a5d9-c43c-4b49-b15c-715080f57029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448cfb3560>]}
[0m13:02:55.730167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0175a5d9-c43c-4b49-b15c-715080f57029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448e5196a0>]}
[0m13:05:56.964231 [error] [MainThread]: Encountered an error:

[0m13:05:56.969833 [error] [MainThread]: Traceback (most recent call last):
  File "/home/suraj/.dbt-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/suraj/.dbt-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/suraj/.dbt-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/suraj/.dbt-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/suraj/.dbt-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/suraj/.dbt-env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/suraj/.dbt-env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
  File "/usr/lib/python3.12/socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib/python3.12/socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib/python3.12/socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib/python3.12/http/server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/lib/python3.12/socketserver.py", line 761, in __init__
    self.handle()
  File "/usr/lib/python3.12/http/server.py", line 436, in handle
    self.handle_one_request()
  File "/usr/lib/python3.12/http/server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 707, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:05:56.973367 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 181.51395, "process_in_blocks": "87304", "process_kernel_time": 0.304552, "process_mem_max_rss": "109172", "process_out_blocks": "3368", "process_user_time": 1.257505}
[0m13:05:56.973977 [debug] [MainThread]: Command `dbt docs serve` failed at 13:05:56.973844 after 181.51 seconds
[0m13:05:56.974362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448e233ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448cf7d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448dbf8500>]}
[0m13:05:56.974764 [debug] [MainThread]: Flushing usage events
[0m13:05:57.972067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:06.365715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb542b40680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb544d82930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5431e18e0>]}


============================== 13:10:06.368123 | d37ba9e4-3892-4437-bd4c-ff5e01b3b756 ==============================
[0m13:10:06.368123 [info ] [MainThread]: Running with dbt=1.11.5
[0m13:10:06.368547 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'profiles_dir': '/home/suraj/.dbt', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'empty': 'None', 'log_format': 'default', 'debug': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8080', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/home/suraj/frontier_analytics/logs', 'cache_selected_only': 'False', 'quiet': 'False'}
[0m13:10:06.481385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd37ba9e4-3892-4437-bd4c-ff5e01b3b756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54212b740>]}
[0m13:10:06.533236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd37ba9e4-3892-4437-bd4c-ff5e01b3b756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb542a47500>]}
